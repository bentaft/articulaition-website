<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Personal Communication Analysis Results - Articulaition</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- External Libraries -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Custom Styles -->
    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/variables.css" />
    <link rel="stylesheet" href="css/base.css" />

    <style>
      /* ==========================================================================
         SOPHISTICATED PERSONAL COMMUNICATION DESIGN SYSTEM
         ========================================================================== */
      :root {
        /* Personal Communication Color Palette */
        --voice-primary: #6366f1;
        --voice-secondary: #8b5cf6;
        --voice-accent: #06b6d4;
        --voice-warm: #f59e0b;
        --voice-success: #10b981;
        --voice-neural: #64748b;
        --voice-dark: #2d3748;
        --voice-light: #f7fafc;
        --voice-bg-primary: #fafbfc;
        --voice-bg-secondary: #f4f6f8;
        --voice-glass: rgba(255, 255, 255, 0.85);
        --voice-glass-border: rgba(255, 255, 255, 0.3);
        --voice-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.08);
        --voice-shadow-lg: 0 35px 60px -12px rgba(0, 0, 0, 0.12);
        --voice-text-primary: #1a202c;
        --voice-text-secondary: #4a5568;
        --voice-text-muted: #718096;
        
        /* Personal Communication Accent Colors */
        --personal-primary: #16a34a;
        --personal-secondary: #22c55e;
        --personal-success: #10b981;
        --personal-warning: #f59e0b;
        --personal-light: rgba(22, 163, 74, 0.05);
        
        /* Typography */
        --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        
        /* Spacing */
        --space-1: 0.25rem;
        --space-2: 0.5rem;
        --space-3: 0.75rem;
        --space-4: 1rem;
        --space-5: 1.25rem;
        --space-6: 1.5rem;
        --space-8: 2rem;
        
        /* Radius */
        --radius: 0.75rem;
        --radius-sm: 0.5rem;
        --radius-lg: 1rem;
        
        /* Glass Morphism Shadows */
        --shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      }

      /* ==========================================================================
         BASE STYLES WITH SOPHISTICATED BACKGROUND
         ========================================================================== */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      body {
        font-family: var(--font-sans);
        background: linear-gradient(135deg, #fafbfc 0%, #f4f6f8 25%, #edf2f7 50%, #e2e8f0 75%, #cbd5e0 100%);
        color: var(--voice-text-primary);
        line-height: 1.6;
        -webkit-font-smoothing: antialiased;
        min-height: 100vh;
        overflow-x: hidden;
        position: relative;
      }

      /* Background Effects */
      body::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: 
          radial-gradient(circle at 20% 20%, rgba(99, 102, 241, 0.03) 0%, transparent 50%),
          radial-gradient(circle at 80% 20%, rgba(139, 92, 246, 0.025) 0%, transparent 50%),
          radial-gradient(circle at 20% 80%, rgba(6, 182, 212, 0.02) 0%, transparent 50%),
          radial-gradient(circle at 80% 80%, rgba(245, 158, 11, 0.015) 0%, transparent 50%);
        pointer-events: none;
        z-index: -1;
      }

      /* Animation Classes */
      .fade-in {
        animation: fadeIn 1s ease-out forwards;
        opacity: 0;
      }

      .slide-up {
        animation: slideUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        opacity: 0;
        transform: translateY(30px);
      }

      .scale-in {
        animation: scaleIn 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        opacity: 0;
        transform: scale(0.9);
      }

      @keyframes fadeIn {
        to { opacity: 1; }
      }
      @keyframes slideUp {
        to { opacity: 1; transform: translateY(0); }
      }
      @keyframes scaleIn {
        to { opacity: 1; transform: scale(1); }
      }

      .delay-100 { animation-delay: 0.1s; }
      .delay-200 { animation-delay: 0.2s; }
      .delay-300 { animation-delay: 0.3s; }
      .delay-400 { animation-delay: 0.4s; }

      /* ==========================================================================
         TOP NAVIGATION WITH GLASS MORPHISM
         ========================================================================== */
      .top-nav {
        padding: 1.5rem 2.5rem;
        background: var(--voice-glass);
        backdrop-filter: blur(25px);
        border-bottom: 1px solid rgba(0, 0, 0, 0.06);
        display: flex;
        align-items: center;
        justify-content: space-between;
        position: sticky;
        top: 0;
        z-index: 100;
        box-shadow: var(--voice-shadow);
      }

      .logo-section {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .logo-section img {
        height: 36px;
        filter: none;
        transition: transform 0.3s ease;
      }

      .logo-section:hover img {
        transform: scale(1.05);
      }

      /* Navigation Branding with Shiny Effect */
      .nav-orange {
          background: linear-gradient(
              145deg,
              #ff934d 0%,
              #ffb366 30%,
              #ff7f50 60%,
              #ff934d 100%
          );
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
          filter: drop-shadow(0 2px 4px rgba(255, 147, 77, 0.3));
      }

      .nav-blue {
          background: linear-gradient(
              145deg,
              #4a90e2 0%,
              #6bb6ff 30%,
              #4f94e8 60%,
              #4a90e2 100%
          );
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
          filter: drop-shadow(0 2px 4px rgba(74, 144, 226, 0.3));
      }

      .nav-links {
        display: flex;
        gap: 2rem;
      }

      .nav-link {
        color: var(--voice-text-secondary);
        text-decoration: none;
        font-weight: 500;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.3s ease;
        position: relative;
      }

      .nav-link.active {
        color: var(--voice-primary);
        background: transparent;
        border: none;
        border-bottom: 2px solid #4a90e2;
        border-radius: 0;
        padding-bottom: 0.4rem;
      }

      .nav-link:hover:not(.active) {
        color: var(--voice-text-primary);
        background: rgba(0, 0, 0, 0.05);
      }

      /* Glass Effect */
      .glass-intense {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.3);
      }

      .analysis-info {
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        gap: 0.25rem;
      }

      .analysis-badge {
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        color: white;
        padding: 0.25rem 0.75rem;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .timestamp {
        font-size: 0.75rem;
        color: var(--gray-500);
      }

      .user-menu-btn {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        padding: 0.5rem 1rem;
        border-radius: 12px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(0, 0, 0, 0.05);
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .user-menu-btn:hover {
        background: rgba(255, 255, 255, 0.15);
        transform: translateY(-1px);
      }

      .user-avatar {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        font-size: 0.875rem;
      }

      .flex {
        display: flex;
      }

      .items-center {
        align-items: center;
      }

      .gap-4 {
        gap: 1rem;
      }

      .relative {
        position: relative;
      }

      /* ==========================================================================
         PAGE HEADER
         ========================================================================== */
      .page-header {
        background: white;
        border-bottom: 1px solid var(--gray-200);
        padding: var(--space-4) var(--space-8);
      }
      
      .header-content h1 {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--gray-900);
        margin-bottom: var(--space-2);
      }
      
      .header-meta {
        display: flex;
        align-items: center;
        gap: var(--space-4);
        font-size: 0.875rem;
        color: var(--gray-600);
      }
      
      .analysis-badge {
        background: var(--primary);
        color: white;
        padding: var(--space-1) var(--space-3);
        border-radius: var(--radius-sm);
        font-weight: 600;
      }
      
      .timestamp {
        color: var(--gray-500);
      }

      /* ==========================================================================
         MAIN LAYOUT
         ========================================================================== */
      .main-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: var(--space-8);
      }
      
      /* Score Section at Top with Glass Morphism */
      .score-section {
        background: var(--voice-glass);
        backdrop-filter: blur(25px);
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 24px;
        box-shadow: var(--voice-shadow-lg);
        padding: var(--space-6) var(--space-8);
        margin-bottom: var(--space-6);
        text-align: center;
        position: relative;
        overflow: hidden;
      }

      .score-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, rgba(99, 102, 241, 0.02) 0%, transparent 100%);
        pointer-events: none;
      }
      
      .score-header {
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--gray-700);
        margin-bottom: var(--space-4);
      }
      
      .score-display {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: var(--space-6);
      }
      
      .score-circle {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        background: linear-gradient(135deg, var(--personal-primary) 0%, var(--personal-secondary) 100%);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2.25rem;
        font-weight: 800;
        box-shadow: 0 25px 50px -12px rgba(22, 163, 74, 0.4), 0 15px 25px -8px rgba(22, 163, 74, 0.25);
        flex-shrink: 0;
        transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        border: 4px solid rgba(255, 255, 255, 0.3);
        position: relative;
        z-index: 2;
      }

      .score-circle::before {
        content: '';
        position: absolute;
        top: -4px;
        left: -4px;
        right: -4px;
        bottom: -4px;
        border-radius: 50%;
        background: linear-gradient(135deg, rgba(22, 163, 74, 0.2) 0%, rgba(34, 197, 94, 0.1) 100%);
        z-index: -1;
        transition: all 0.4s ease;
      }
      
      .score-circle:hover {
        transform: translateY(-4px) scale(1.05);
        box-shadow: 0 35px 70px -12px rgba(22, 163, 74, 0.5), 0 20px 35px -8px rgba(22, 163, 74, 0.35);
      }

      .score-circle:hover::before {
        transform: scale(1.1);
        opacity: 0.8;
      }
      
      .score-details {
        text-align: left;
      }
      
      .score-label {
        font-size: 1rem;
        color: var(--gray-700);
        margin-bottom: var(--space-2);
        font-weight: 600;
      }
      
      .score-value {
        font-size: 2.5rem;
        font-weight: 800;
        color: #000000;
        margin-bottom: var(--space-3);
        line-height: 1;
      }
      
      .score-description {
        font-size: 1rem;
        color: var(--gray-600);
        font-weight: 500;
        padding: var(--space-2) var(--space-4);
        background: linear-gradient(135deg, #f0fdf4, #dcfce7);
        border-radius: 8px;
        border: 1px solid #bbf7d0;
      }
      
      /* Simplified 2-Panel Layout */
      .analysis-panels {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--space-6);
        height: calc(100vh - 320px);
      }
      
      .transcript-panel {
        grid-column: 1;
      }
      
      .unified-analysis-panel {
        grid-column: 2;
      }
      
      /* ==========================================================================
         LEFT PANEL: TRANSCRIPT WITH GLASS MORPHISM
         ========================================================================== */
      .transcript-panel {
        background: var(--voice-glass);
        backdrop-filter: blur(25px);
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 24px;
        box-shadow: var(--voice-shadow-lg);
        display: flex;
        flex-direction: column;
        overflow: hidden;
        transition: all 0.3s ease;
        position: relative;
      }

      .transcript-panel::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, rgba(99, 102, 241, 0.01) 0%, transparent 100%);
        pointer-events: none;
      }

      .transcript-panel:hover {
        transform: translateY(-2px);
        box-shadow: var(--voice-shadow-lg), 0 8px 25px rgba(0, 0, 0, 0.08);
      }
      
      .panel-top-bar {
        padding: var(--space-5) var(--space-6);
        border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: rgba(255, 255, 255, 0.4);
        backdrop-filter: blur(15px);
        position: relative;
        z-index: 2;
      }
      
      .panel-top-bar h2 {
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--voice-text-primary);
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      
      .copy-btn {
        display: flex;
        align-items: center;
        gap: var(--space-2);
        padding: var(--space-2) var(--space-3);
        background: white;
        border: 1px solid var(--gray-300);
        border-radius: var(--radius-sm);
        color: var(--gray-600);
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
      }
      
      .copy-btn:hover {
        background: var(--gray-50);
        border-color: var(--primary);
        color: var(--primary);
      }
      
      .transcript-content {
        flex: 1;
        padding: var(--space-6);
        overflow-y: auto;
        line-height: 1.8;
      }

      /* ==========================================================================
         UNIFIED RIGHT PANEL: INSIGHTS & ANALYTICS
         ========================================================================== */
      .unified-analysis-panel {
        background: var(--voice-glass);
        backdrop-filter: blur(25px);
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 24px;
        box-shadow: var(--voice-shadow-lg);
        display: flex;
        flex-direction: column;
        overflow: hidden;
        transition: all 0.3s ease;
        position: relative;
      }

      .unified-analysis-panel::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, rgba(99, 102, 241, 0.01) 0%, transparent 100%);
        pointer-events: none;
      }

      .unified-analysis-panel:hover {
        transform: translateY(-2px);
        box-shadow: var(--voice-shadow-lg), 0 8px 25px rgba(0, 0, 0, 0.08);
      }
      
      /* Tab Navigation for Unified Panel with Glass Morphism */
      .unified-tab-header {
        display: flex;
        border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        background: rgba(255, 255, 255, 0.4);
        backdrop-filter: blur(15px);
        position: relative;
        z-index: 2;
      }
      
      .unified-tab-btn {
        flex: 1;
        padding: var(--space-4) var(--space-5);
        background: none;
        border: none;
        font-size: 0.875rem;
        font-weight: 600;
        color: var(--voice-text-secondary);
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        position: relative;
        border-radius: 12px 12px 0 0;
      }
      
      .unified-tab-btn:hover:not(.active) {
        background: rgba(99, 102, 241, 0.05);
        color: var(--voice-text-primary);
        transform: translateY(-1px);
      }
      
      .unified-tab-btn.active {
        background: rgba(99, 102, 241, 0.1);
        color: var(--voice-primary);
        border-bottom: 3px solid var(--voice-primary);
        transform: translateY(-1px);
      }
      
      .unified-tab-btn.active::before {
        content: '';
        position: absolute;
        bottom: -1px;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(135deg, var(--voice-primary), var(--voice-secondary));
        border-radius: 2px 2px 0 0;
      }
      
      /* Tab Content Area */
      .unified-tab-content {
        flex: 1;
        overflow-y: auto;
        padding: var(--space-6);
      }
      
      .unified-tab-pane {
        display: none;
      }
      
      .unified-tab-pane.active {
        display: block;
      }
      
      .analysis-panel {
        background: white;
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow);
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
      
      /* Tab Header */
      .tab-header {
        padding: var(--space-5) var(--space-6);
        border-bottom: 1px solid var(--gray-200);
        display: flex;
        align-items: center;
        justify-content: space-between;
      }
      
      .tab-nav {
        display: flex;
        gap: var(--space-3);
      }
      
      .tab-btn {
        display: flex;
        align-items: center;
        gap: var(--space-2);
        padding: var(--space-2) var(--space-3);
        background: transparent;
        border: none;
        color: var(--gray-600);
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
        position: relative;
      }
      
      .tab-btn.active {
        color: var(--primary);
      }
      
      .tab-btn.active::after {
        content: '';
        position: absolute;
        bottom: -21px;
        left: 0;
        right: 0;
        height: 2px;
        background: var(--primary);
      }
      
      .tab-badge {
        background: var(--primary);
        color: white;
        padding: 0 var(--space-2);
        border-radius: 10px;
        font-size: 0.75rem;
        font-weight: 600;
        min-width: 20px;
        text-align: center;
      }
      
      .copy-feedback-btn {
        display: flex;
        align-items: center;
        gap: var(--space-2);
        padding: var(--space-2) var(--space-3);
        background: white;
        border: 1px solid var(--gray-300);
        border-radius: var(--radius-sm);
        color: var(--gray-600);
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
      }
      
      .copy-feedback-btn:hover {
        background: var(--gray-50);
        border-color: var(--primary);
        color: var(--primary);
      }
      
      /* Tab Content */
      .tab-content {
        flex: 1;
        overflow-y: auto;
      }
      
      .tab-pane {
        display: none;
        height: 100%;
      }
      
      .tab-pane.active {
        display: block;
      }

      /* ==========================================================================
         INSIGHTS TAB CONTENT
         ========================================================================== */
      .detailed-analysis-section {
        padding: var(--space-6);
        border-bottom: 1px solid var(--gray-200);
      }
      
      /* Analysis Cards (like in screenshot) */
      .analysis-card {
        background: var(--gray-50);
        border: 1px solid var(--gray-200);
        border-radius: var(--radius);
        padding: var(--space-5);
        margin-bottom: var(--space-4);
      }
      
      .analysis-card.strength {
        border-left: 4px solid var(--success);
      }
      
      .analysis-card.growth {
        border-left: 4px solid var(--warning);
      }
      
      .analysis-card.recommendation {
        border-left: 4px solid var(--primary);
      }
      
      .analysis-card.assessment {
        border-left: 4px solid var(--gray-600);
        background: var(--gray-50);
      }
      
      .card-header {
        display: flex;
        align-items: center;
        gap: var(--space-2);
        margin-bottom: var(--space-3);
      }
      
      .card-icon {
        color: var(--success);
      }
      
      .growth .card-icon {
        color: var(--warning);
      }
      
      .card-title {
        font-weight: 600;
        color: var(--gray-900);
        font-size: 1rem;
      }
      
      .card-content {
        color: var(--gray-700);
        line-height: 1.6;
        font-size: 0.9375rem;
      }
      
      .card-footer {
        margin-top: var(--space-3);
        font-weight: 600;
        color: var(--gray-900);
        font-size: 0.875rem;
      }

      /* ==========================================================================
         TOGGLE SECTION
         ========================================================================== */
      .analysis-toggle-section {
        padding: var(--space-6);
      }
      
      .toggle-header {
        margin-bottom: var(--space-4);
      }
      
      .toggle-switch {
        display: inline-flex;
        background: var(--gray-100);
        border-radius: var(--radius-sm);
        padding: var(--space-1);
      }
      
      .toggle-btn {
        padding: var(--space-2) var(--space-4);
        background: transparent;
        border: none;
        color: var(--gray-600);
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        border-radius: var(--radius-sm);
        transition: all 0.2s;
      }
      
      .toggle-btn.active {
        background: white;
        color: var(--gray-900);
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }
      
      .toggle-content {
        margin-top: var(--space-4);
      }
      
      .analysis-pane {
        display: none;
      }
      
      .analysis-pane.active {
        display: block;
      }

      /* ==========================================================================
         ANALYTICS TAB
         ========================================================================== */
      .analytics-content {
        padding: var(--space-6);
      }
      
      .score-overview {
        text-align: center;
        margin-bottom: var(--space-8);
      }
      
      .score-overview h3 {
        font-size: 1rem;
        font-weight: 600;
        color: var(--gray-600);
        margin-bottom: var(--space-2);
      }
      
      .big-score {
        font-size: 3rem;
        font-weight: 800;
        color: var(--primary);
        line-height: 1;
      }
      
      .score-suffix {
        font-size: 1.5rem;
        color: var(--gray-400);
      }
      
      .score-breakdown {
        display: grid;
        gap: var(--space-4);
      }

      /* ==========================================================================
         ACTION BAR
         ========================================================================== */
      .action-bar {
        padding: var(--space-6) var(--space-8);
        display: flex;
        justify-content: center;
        gap: var(--space-4);
      }
      
      .btn-primary,
      .btn-secondary {
        display: flex;
        align-items: center;
        gap: var(--space-2);
        padding: var(--space-3) var(--space-5);
        border-radius: var(--radius-sm);
        font-weight: 600;
        font-size: 0.875rem;
        cursor: pointer;
        transition: all 0.2s;
      }
      
      .btn-primary {
        background: var(--primary);
        color: white;
        border: none;
      }
      
      .btn-primary:hover {
        background: var(--primary-dark);
      }
      
      .btn-secondary {
        background: white;
        color: var(--gray-700);
        border: 1px solid var(--gray-300);
      }
      
      .btn-secondary:hover {
        background: var(--gray-50);
        border-color: var(--primary);
        color: var(--primary);
      }
      
      /* ==========================================================================
         LOADING & UTILITIES
         ========================================================================== */
      .loading-state {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: var(--space-8);
        color: var(--gray-500);
      }
      
      .spinner {
        width: 24px;
        height: 24px;
        border: 2px solid var(--gray-200);
        border-top: 2px solid var(--primary);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: var(--space-3);
      }
      
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      
      /* ==========================================================================
         RESPONSIVE
         ========================================================================== */
      @media (max-width: 1024px) {
        .analysis-panels {
          grid-template-columns: 1fr;
          height: auto;
        }
        
        .transcript-panel,
        .analysis-panel {
          height: 500px;
        }
      }
      
      /* ==========================================================================
         COMPONENT OVERRIDES
         ========================================================================== */
      
      /* Data Confidence Indicator */
      .confidence-indicator {
        display: flex;
        align-items: center;
        gap: var(--space-2);
        padding: var(--space-3) var(--space-4);
        background: var(--bg-subtle);
        border: 1px solid var(--border-subtle);
        border-radius: var(--radius-lg);
        font-size: 0.75rem;
        color: var(--text-muted);
        margin-bottom: var(--space-4);
      }
      
      .confidence-badge {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: var(--green-success);
      }
      
      .confidence-badge.medium {
        background: var(--amber-warning);
      }
      
      .confidence-badge.low {
        background: var(--red-error);
      }
      
      /* Professional Metric Cards with Trust Indicators */
      .metric-card-enhanced {
        position: relative;
        background: var(--bg-canvas);
        border: 1px solid var(--border-subtle);
        border-radius: var(--radius-lg);
        padding: var(--space-5);
        box-shadow: var(--shadow-minimal);
        transition: all var(--duration-normal) var(--easing-standard);
        overflow: hidden;
      }
      
      .metric-card-enhanced::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 2px;
        background: var(--blue-primary);
        transform: scaleX(0);
        transform-origin: left;
        transition: transform var(--duration-slow) var(--easing-emphasis);
      }
      
      .metric-card-enhanced:hover::before {
        transform: scaleX(1);
      }
      
      .metric-card-enhanced:hover {
        border-color: var(--blue-primary);
        box-shadow: var(--shadow-medium);
        transform: translateY(-2px);
      }
      
      /* Data Quality Indicators */
      .data-quality {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: var(--space-3);
        padding-top: var(--space-3);
        border-top: 1px solid var(--border-subtle);
      }
      
      .quality-label {
        font-size: 0.625rem;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.075em;
        font-weight: 600;
      }
      
      .quality-dots {
        display: flex;
        gap: var(--space-1);
      }
      
      .quality-dot {
        width: 4px;
        height: 4px;
        border-radius: 50%;
        background: var(--border-default);
      }
      
      .quality-dot.active {
        background: var(--green-success);
      }
      
      /* ==========================================================================
         PROFESSIONAL DATA VISUALIZATION PATTERNS
         ========================================================================== */
      
      /* Score Breakdown Component */
      .score-breakdown {
        background: var(--bg-canvas);
        border: 1px solid var(--border-subtle);
        border-radius: var(--radius-lg);
        padding: var(--space-6);
        margin: var(--space-6) 0;
        box-shadow: var(--shadow-subtle);
      }
      
      .breakdown-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--space-5);
        padding-bottom: var(--space-3);
        border-bottom: 1px solid var(--border-subtle);
      }
      
      .breakdown-title {
        font-size: 1rem;
        font-weight: 600;
        color: var(--text-primary);
        font-family: var(--font-system);
      }
      
      .breakdown-score {
        font-size: 1.25rem;
        font-weight: 700;
        color: var(--blue-primary);
        font-family: var(--font-mono);
      }
      
      .score-components {
        display: grid;
        gap: var(--space-4);
      }
      
      .score-component {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: var(--space-3) 0;
      }
      
      .component-info {
        display: flex;
        align-items: center;
        gap: var(--space-3);
        flex: 1;
      }
      
      .component-indicator {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: var(--data-primary);
        flex-shrink: 0;
      }
      
      .component-indicator.secondary {
        background: var(--data-secondary);
      }
      
      .component-indicator.tertiary {
        background: var(--data-tertiary);
      }
      
      .component-indicator.quaternary {
        background: var(--data-quaternary);
      }
      
      .component-label {
        font-size: 0.875rem;
        color: var(--text-secondary);
        font-weight: 500;
      }
      
      .component-score {
        font-size: 0.875rem;
        font-weight: 600;
        color: var(--text-primary);
        font-family: var(--font-mono);
        min-width: 40px;
        text-align: right;
      }
      
      .component-bar {
        width: 80px;
        height: 4px;
        background: var(--bg-subtle);
        border-radius: var(--radius-sm);
        margin-left: var(--space-3);
        overflow: hidden;
      }
      
      .component-fill {
        height: 100%;
        background: var(--data-primary);
        border-radius: var(--radius-sm);
        transition: width 0.8s var(--easing-emphasis);
      }
      
      .component-fill.secondary {
        background: var(--data-secondary);
      }
      
      .component-fill.tertiary {
        background: var(--data-tertiary);
      }
      
      .component-fill.quaternary {
        background: var(--data-quaternary);
      }
      
      /* Professional Analysis Categories */
      .category-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: var(--space-5);
        margin: var(--space-6) 0;
      }
      
      .category-card {
        background: var(--bg-canvas);
        border: 1px solid var(--border-subtle);
        border-radius: var(--radius-lg);
        padding: var(--space-5);
        box-shadow: var(--shadow-minimal);
        transition: all var(--duration-normal) var(--easing-standard);
        position: relative;
        overflow: hidden;
      }
      
      .category-card:hover {
        border-color: var(--blue-primary);
        box-shadow: var(--shadow-medium);
        transform: translateY(-1px);
      }
      
      .category-header {
        display: flex;
        align-items: center;
        gap: var(--space-3);
        margin-bottom: var(--space-4);
      }
      
      .category-icon {
        width: 32px;
        height: 32px;
        border-radius: var(--radius-md);
        background: var(--blue-primary);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--text-inverse);
        font-size: 14px;
        flex-shrink: 0;
      }
      
      .category-title {
        font-size: 1rem;
        font-weight: 600;
        color: var(--text-primary);
        margin: 0;
        font-family: var(--font-system);
      }
      
      .category-score {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--blue-primary);
        text-align: center;
        margin: var(--space-4) 0;
        font-family: var(--font-mono);
      }
      
      .category-insights {
        list-style: none;
        padding: 0;
        margin: 0;
      }
      
      .category-insights li {
        padding: var(--space-2) 0;
        font-size: 0.875rem;
        color: var(--text-secondary);
        line-height: 1.5;
        position: relative;
        padding-left: var(--space-4);
      }
      
      .category-insights li::before {
        content: 'â€¢';
        position: absolute;
        left: 0;
        color: var(--blue-primary);
        font-weight: bold;
      }

      /* ==========================================================================
         ENTERPRISE ANALYSIS SECTIONS - TRUST & RELIABILITY
         ========================================================================== */
      .analysis-section {
        background: var(--bg-canvas);
        border-radius: var(--radius-lg);
        padding: var(--space-8);
        box-shadow: var(--shadow-subtle);
        border: 1px solid var(--border-subtle);
        margin-bottom: var(--space-8);
        transition: all var(--duration-normal) var(--easing-standard);
        position: relative;
        overflow: hidden;
      }

      .analysis-section:hover {
        box-shadow: var(--shadow-medium);
        transform: translateY(-1px);
        border-color: var(--border-default);
      }

      .analysis-section::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(
          90deg,
          var(--blue-primary),
          var(--blue-secondary),
          var(--blue-accent)
        );
      }

      .section-header {
        display: flex;
        align-items: center;
        gap: var(--space-4);
        margin-bottom: var(--space-6);
        padding-bottom: var(--space-4);
        border-bottom: 1px solid var(--border-subtle);
      }

      .section-icon {
        width: 40px;
        height: 40px;
        border-radius: var(--radius-md);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--text-inverse);
        font-size: 18px;
        flex-shrink: 0;
        box-shadow: var(--shadow-minimal);
      }

      .section-icon.transcript {
        background: var(--blue-primary);
      }

      .section-icon.quantitative {
        background: var(--green-success);
      }

      .section-icon.qualitative {
        background: var(--data-quaternary);
      }

      .section-icon.situation {
        background: var(--amber-warning);
      }

      .section-icon.situational {
        background: var(--blue-accent);
      }

      .section-icon.next-steps {
        background: var(--green-success);
      }

      .section-icon.detailed-analysis {
        background: var(--blue-primary);
      }

      /* Enterprise Context Grid Styles */
      .context-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--space-4);
      }

      .context-item {
        background: var(--bg-canvas);
        border: 1px solid var(--border-subtle);
        border-radius: var(--radius-lg);
        padding: var(--space-4);
        text-align: center;
        box-shadow: var(--shadow-minimal);
        transition: all var(--duration-normal) var(--easing-standard);
      }

      .context-item:hover {
        border-color: var(--border-default);
        box-shadow: var(--shadow-subtle);
      }

      .context-label {
        font-size: 0.75rem;
        color: var(--text-muted);
        margin-bottom: var(--space-2);
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        font-family: var(--font-system);
      }

      .context-value {
        font-size: 0.875rem;
        color: var(--text-primary);
        font-weight: 600;
        font-family: var(--font-system);
        letter-spacing: -0.01em;
      }

      /* Simplified Next Steps - using standard placeholder styling */

      .section-title {
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--text-primary);
        margin: 0;
        letter-spacing: -0.015em;
        font-family: var(--font-system);
      }

      .section-subtitle {
        font-size: 0.875rem;
        color: var(--text-secondary);
        margin: var(--space-1) 0 0 0;
        font-weight: 500;
        line-height: 1.4;
      }

      /* ==========================================================================
         QUANTITATIVE ANALYSIS COMPONENTS
         ========================================================================== */

      .transcript-content {
        background: var(--bg-subtle);
        border: 1px solid var(--border-subtle);
        border-radius: var(--radius-lg);
        padding: var(--space-6);
        font-style: italic;
        line-height: 1.7;
        color: var(--text-secondary);
        position: relative;
        font-family: var(--font-system);
      }

      .transcript-content::before {
        content: '"';
        position: absolute;
        top: -8px;
        left: var(--space-3);
        font-size: 2.5rem;
        color: var(--blue-primary);
        opacity: 0.2;
        font-family: var(--font-system);
      }

      .metrics-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: var(--space-4);
        margin-bottom: var(--space-8);
      }

      .metric-card {
        background: var(--bg-canvas);
        border-radius: var(--radius-lg);
        padding: var(--space-5);
        text-align: center;
        border: 1px solid var(--border-subtle);
        box-shadow: var(--shadow-minimal);
        transition: all var(--duration-normal) var(--easing-standard);
      }

      .metric-card:hover {
        box-shadow: var(--shadow-subtle);
        border-color: var(--border-default);
        transform: translateY(-1px);
      }

      .metric-value {
        font-size: 1.75rem;
        font-weight: 700;
        color: var(--blue-primary);
        margin-bottom: var(--space-2);
        font-family: var(--font-mono);
        letter-spacing: -0.02em;
      }

      .metric-label {
        font-size: 0.75rem;
        color: var(--text-muted);
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        font-family: var(--font-system);
      }

      .progress-bar {
        width: 100%;
        height: 6px;
        background: var(--bg-subtle);
        border-radius: var(--radius-sm);
        overflow: hidden;
        margin: var(--space-4) 0;
        border: 1px solid var(--border-subtle);
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(
          90deg,
          var(--blue-primary),
          var(--green-success)
        );
        border-radius: var(--radius-sm);
        transition: width 0.6s var(--easing-emphasis);
      }

      .analysis-content {
        line-height: 1.6;
        color: var(--text-secondary);
        font-family: var(--font-system);
      }

      .analysis-content h3 {
        color: var(--text-primary);
        font-weight: 600;
        margin: var(--space-6) 0 var(--space-4) 0;
        display: flex;
        align-items: center;
        gap: var(--space-2);
        font-size: 1rem;
        letter-spacing: -0.01em;
      }

      .analysis-content ul {
        margin: var(--space-4) 0;
        padding-left: var(--space-6);
      }

      .analysis-content li {
        margin-bottom: var(--space-2);
        line-height: 1.5;
      }

      .strengths-list li {
        color: var(--green-success);
      }

      .improvements-list li {
        color: var(--amber-warning);
      }

      .placeholder-content {
        text-align: center;
        padding: var(--space-12) var(--space-8);
        color: var(--text-muted);
        background: var(--bg-overlay);
        border: 2px dashed var(--border-default);
        border-radius: var(--radius-lg);
        font-family: var(--font-system);
      }

      .placeholder-icon {
        width: 64px;
        height: 64px;
        margin: 0 auto 1rem;
        opacity: 0.5;
      }

      .situation-details {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: var(--space-4);
      }

      .situation-item {
        background: var(--bg-canvas);
        border-radius: var(--radius-lg);
        padding: var(--space-4);
        border: 1px solid var(--border-subtle);
        box-shadow: var(--shadow-minimal);
        transition: all var(--duration-normal) var(--easing-standard);
      }
      
      .situation-item:hover {
        border-color: var(--border-default);
        box-shadow: var(--shadow-subtle);
      }

      .situation-label {
        font-size: 0.675rem;
        text-transform: uppercase;
        letter-spacing: 0.075em;
        color: var(--text-muted);
        margin-bottom: var(--space-2);
        font-weight: 600;
        font-family: var(--font-system);
      }

      .situation-value {
        font-weight: 600;
        color: var(--text-primary);
        font-family: var(--font-system);
        letter-spacing: -0.01em;
        font-size: 0.875rem;
      }

      .source-details {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1.5rem;
      }

      .source-item {
        background: var(--voice-light);
        border-radius: 8px;
        padding: 1rem;
      }

      .source-label {
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        color: var(--voice-text-muted);
        margin-bottom: 0.5rem;
      }

      .source-value {
        font-weight: 600;
        color: var(--voice-text-primary);
      }

      /* Situational Analysis Styles */
      .situational-analysis {
        display: flex;
        flex-direction: column;
        gap: 2rem;
      }

      .scenario-prompt {
        background: linear-gradient(135deg, #f8fafc, #e2e8f0);
        border-radius: 16px;
        padding: 2rem;
        border-left: 4px solid var(--voice-accent);
        position: relative;
      }

      .prompt-header {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: 1rem;
      }

      .prompt-header i {
        width: 20px;
        height: 20px;
        color: var(--voice-accent);
      }

      .prompt-header h4 {
        font-size: 1.125rem;
        font-weight: 700;
        color: var(--voice-text-primary);
        margin: 0;
      }

      .prompt-text {
        font-size: 1rem;
        line-height: 1.6;
        color: var(--voice-text-secondary);
        font-style: italic;
        background: white;
        padding: 1.5rem;
        border-radius: 12px;
        border: 1px solid var(--voice-border);
      }

      .points-analysis {
        margin-top: 1rem;
      }

      .points-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
      }

      .points-hit,
      .points-missed {
        background: var(--voice-light);
        border-radius: 16px;
        padding: 1.5rem;
        border: 1px solid var(--voice-border);
      }

      .points-hit {
        border-left: 4px solid var(--voice-success);
      }

      .points-missed {
        border-left: 4px solid var(--voice-warning);
      }

      .points-header {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: 1rem;
      }

      .points-header i {
        width: 20px;
        height: 20px;
      }

      .points-hit .points-header i {
        color: var(--voice-success);
      }

      .points-missed .points-header i {
        color: var(--voice-warning);
      }

      .points-header h4 {
        font-size: 1rem;
        font-weight: 700;
        color: var(--voice-text-primary);
        margin: 0;
      }

      .points-list {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
      }

      .point-item {
        display: flex;
        align-items: flex-start;
        gap: 0.75rem;
        padding: 0.75rem;
        background: white;
        border-radius: 8px;
        border: 1px solid var(--voice-border);
      }

      .point-icon {
        width: 16px;
        height: 16px;
        margin-top: 2px;
        flex-shrink: 0;
      }

      .point-text {
        font-size: 0.875rem;
        line-height: 1.5;
        color: var(--voice-text-secondary);
      }

      .loading-points {
        text-align: center;
        color: var(--voice-text-muted);
        font-style: italic;
        padding: 1rem;
      }

      /* Next Steps Styles */
      .next-steps-container {
        display: flex;
        flex-direction: column;
        gap: 2rem;
      }

      .primary-action {
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        border-radius: 16px;
        padding: 2rem;
        text-align: center;
        position: relative;
        overflow: hidden;
      }

      .primary-action::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
          45deg,
          transparent 30%,
          rgba(255, 255, 255, 0.1) 50%,
          transparent 70%
        );
      }

      .action-header {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.75rem;
        margin-bottom: 1rem;
      }

      .action-header i {
        width: 24px;
        height: 24px;
      }

      .action-header h4 {
        font-size: 1.25rem;
        font-weight: 700;
        margin: 0;
      }

      .action-text {
        font-size: 1.125rem;
        line-height: 1.6;
        font-weight: 500;
        position: relative;
        z-index: 1;
      }

      .action-items {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .action-item {
        display: flex;
        align-items: flex-start;
        gap: 1rem;
        padding: 1.5rem;
        background: var(--voice-light);
        border-radius: 12px;
        border: 1px solid var(--voice-border);
        transition: all 0.3s ease;
      }

      .action-item:hover {
        background: white;
        border-color: var(--voice-success);
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.15);
      }

      .action-number {
        width: 32px;
        height: 32px;
        background: linear-gradient(
          135deg,
          var(--voice-success),
          var(--voice-accent)
        );
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 0.875rem;
        flex-shrink: 0;
        margin-top: 2px;
      }

      .action-content {
        font-size: 1rem;
        line-height: 1.6;
        color: var(--voice-text-secondary);
        font-weight: 500;
      }

      @media (max-width: 768px) {
        .points-grid {
          grid-template-columns: 1fr;
        }

        .action-item {
          flex-direction: column;
          text-align: center;
        }

        .action-number {
          margin: 0 auto 0.5rem;
        }
      }

      .action-buttons {
        display: flex;
        gap: 1rem;
        justify-content: center;
        margin-top: 3rem;
        flex-wrap: wrap;
      }

      .btn {
        padding: 0.875rem 1.75rem;
        border-radius: 12px;
        font-weight: 600;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.75rem;
        transition: all 0.3s ease;
        border: none;
        cursor: pointer;
        font-size: 0.875rem;
      }

      .btn-primary {
        background: linear-gradient(
          135deg,
          var(--voice-primary),
          var(--voice-secondary)
        );
        color: white;
        box-shadow: var(--voice-shadow);
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: var(--voice-shadow-lg);
      }

      .btn-secondary {
        background: var(--voice-white);
        color: var(--voice-text-primary);
        border: 1px solid var(--voice-border);
      }

      .btn-secondary:hover {
        background: var(--voice-light);
        transform: translateY(-1px);
      }

      .loading-state {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 1rem;
        padding: 2rem;
        color: var(--voice-text-secondary);
      }

      .spinner {
        width: 24px;
        height: 24px;
        border: 2px solid var(--voice-border);
        border-top: 2px solid var(--voice-primary);
        border-radius: 50%;
      }

      @media (max-width: 768px) {
        .results-container {
          padding: 1rem;
        }

        .results-title {
          font-size: 2rem;
        }

        .score-display {
          flex-direction: column;
          gap: 1rem;
        }

        .score-details {
          text-align: center;
        }

        .action-buttons {
          flex-direction: column;
          align-items: center;
        }

        .metrics-grid {
          grid-template-columns: 1fr;
        }
      }

      /* Situation Analysis Styles */
      .situation-analysis-content {
        display: flex;
        flex-direction: column;
        gap: 2rem;
      }

      .analysis-category {
        background: var(--voice-white);
        border: 1px solid var(--voice-border);
        border-radius: 16px;
        padding: 1.5rem;
        transition: all 0.3s ease;
      }

      .analysis-category:hover {
        border-color: var(--voice-primary-light);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      }

      .category-title {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        font-size: 1.125rem;
        font-weight: 700;
        color: var(--voice-text-primary);
        margin-bottom: 1rem;
      }

      .category-content {
        color: var(--voice-text-secondary);
      }

      .criteria-list,
      .strengths-list,
      .improvements-list {
        list-style: none;
        padding: 0;
        margin: 0;
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
      }

      .criteria-list li,
      .strengths-list li,
      .improvements-list li {
        padding: 0.75rem;
        background: var(--voice-light);
        border-radius: 8px;
        line-height: 1.5;
        font-size: 0.9rem;
      }

      .criteria-list li strong,
      .improvements-list li strong {
        color: var(--voice-text-primary);
        font-weight: 600;
      }

      .strengths-list li {
        background: rgba(16, 185, 129, 0.08);
        border-left: 3px solid var(--voice-success);
      }

      .improvements-list li {
        background: rgba(59, 130, 246, 0.08);
        border-left: 3px solid #3b82f6;
      }

      .details-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
      }

      .detail-item {
        display: flex;
        flex-direction: column;
        gap: 0.25rem;
        padding: 1rem;
        background: var(--voice-light);
        border-radius: 8px;
        text-align: center;
      }

      .detail-label {
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        color: var(--voice-text-muted);
      }

      .detail-value {
        font-size: 0.875rem;
        font-weight: 500;
        color: var(--voice-text-primary);
      }

      @media (max-width: 768px) {
        .details-grid {
          grid-template-columns: 1fr;
        }

        .analysis-category {
          padding: 1rem;
        }

        .criteria-list li,
        .strengths-list li,
        .improvements-list li {
          padding: 0.5rem;
          font-size: 0.85rem;
        }
      }

      /* Premium Analysis Card Styles */
      .premium-analysis-card {
        background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
        border-radius: 20px;
        padding: 0;
        box-shadow: 
          0 20px 40px rgba(0, 0, 0, 0.1),
          0 8px 16px rgba(0, 0, 0, 0.05),
          inset 0 1px 0 rgba(255, 255, 255, 0.8);
        border: 1px solid rgba(255, 255, 255, 0.2);
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
      }

      .premium-analysis-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, #667eea 0%, #764ba2 50%, #667eea 100%);
        background-size: 200% 100%;
        animation: shimmer 3s linear infinite;
      }

      .quantitative-card::before {
        background: linear-gradient(90deg, #4facfe 0%, #00f2fe 50%, #4facfe 100%);
        background-size: 200% 100%;
      }

      .qualitative-card::before {
        background: linear-gradient(90deg, #a8edea 0%, #fed6e3 50%, #a8edea 100%);
        background-size: 200% 100%;
      }

      .detailed-card::before {
        background: linear-gradient(90deg, #667eea 0%, #764ba2 50%, #667eea 100%);
        background-size: 200% 100%;
      }

      @keyframes shimmer {
        0% { background-position: -200% 0; }
        100% { background-position: 200% 0; }
      }

      .card-header {
        display: flex;
        align-items: center;
        gap: 1.5rem;
        padding: 2rem 2rem 1rem 2rem;
        background: rgba(255, 255, 255, 0.5);
        backdrop-filter: blur(10px);
      }

      .header-icon {
        width: 56px;
        height: 56px;
        border-radius: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        flex-shrink: 0;
      }

      .quantitative-icon {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        box-shadow: 0 8px 16px rgba(79, 172, 254, 0.3);
      }

      .qualitative-icon {
        background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
        box-shadow: 0 8px 16px rgba(168, 237, 234, 0.3);
      }

      .detailed-icon {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        box-shadow: 0 8px 16px rgba(102, 126, 234, 0.3);
      }

      .header-icon i {
        width: 24px;
        height: 24px;
        color: white;
        filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
      }

      .header-content {
        flex: 1;
      }

      .card-title {
        font-size: 1.25rem;
        font-weight: 700;
        color: #1a202c;
        margin: 0 0 0.5rem 0;
        line-height: 1.3;
      }

      .card-subtitle {
        font-size: 0.9rem;
        color: #64748b;
        margin: 0;
        font-weight: 500;
      }

      .card-body {
        padding: 1rem 2rem 2rem 2rem;
      }

      /* Content Formatting Styles */
      .metrics-content, .qualitative-content {
        font-size: 15px;
        line-height: 1.7;
        color: #374151;
      }

      .bullet-point {
        display: flex;
        align-items: flex-start;
        gap: 0.75rem;
        margin: 0.75rem 0;
        padding: 0.75rem;
        background: rgba(99, 102, 241, 0.05);
        border-radius: 8px;
        border-left: 3px solid #6366f1;
      }

      .bullet {
        color: #6366f1;
        font-weight: bold;
        font-size: 1.1em;
        flex-shrink: 0;
        margin-top: 2px;
      }

      .highlight {
        color: #6366f1;
        font-weight: 600;
        background: rgba(99, 102, 241, 0.1);
        padding: 2px 6px;
        border-radius: 4px;
      }

      .section-header {
        font-size: 1.1rem;
        font-weight: 700;
        color: #1e293b;
        margin: 1.5rem 0 1rem 0;
        padding-bottom: 0.5rem;
        border-bottom: 2px solid #e2e8f0;
      }

      .metric-item {
        display: flex;
        margin: 0.5rem 0;
        padding: 0.75rem;
        background: #f8fafc;
        border-radius: 8px;
        border-left: 3px solid #10b981;
      }

      .metric-label {
        font-weight: 600;
        color: #374151;
        min-width: 140px;
      }

      .metric-value {
        color: #6b7280;
        flex: 1;
      }

      /* Detailed Analysis Styles */
      .overall-assessment {
        background: linear-gradient(135deg, #fef3e2 0%, #fef9e7 100%);
        border: 1px solid #fed7aa;
        border-radius: 12px;
        padding: 1.5rem;
        margin-bottom: 2rem;
      }

      .assessment-title {
        font-size: 1.1rem;
        font-weight: 700;
        color: #d97706;
        margin: 0 0 1rem 0;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .assessment-content {
        color: #92400e;
        line-height: 1.6;
      }

      .analysis-point {
        margin: 1rem 0;
        padding: 1rem;
        background: #f1f5f9;
        border-radius: 8px;
        border-left: 4px solid #64748b;
      }

      .analysis-point.critical {
        background: linear-gradient(135deg, #fef2f2 0%, #fef7f7 100%);
        border-left-color: #ef4444;
        border: 1px solid #fecaca;
      }

      .point-header {
        font-weight: 700;
        color: #dc2626;
        margin-bottom: 0.5rem;
      }

      .point-content {
        color: #7f1d1d;
        line-height: 1.6;
      }

      .bullet-icon {
        color: #64748b;
        font-weight: bold;
        margin-right: 0.75rem;
      }

      .emphasis {
        color: #1e293b;
        font-weight: 700;
        background: rgba(59, 130, 246, 0.1);
        padding: 2px 6px;
        border-radius: 4px;
      }

      /* Clean Actionable Feedback Styles */
      .actionable-feedback {
        background: #f0fdf4;
        border: 1px solid #bbf7d0;
        border-radius: 12px;
        padding: 2rem;
        margin-top: 2rem;
      }

      .feedback-title {
        font-size: 1.25rem;
        font-weight: 700;
        color: #059669;
        margin: 0 0 1.5rem 0;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .feedback-content {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .feedback-item {
        display: flex;
        gap: 1rem;
        padding: 1.5rem;
        background: #ffffff;
        border-radius: 8px;
        border-left: 4px solid #10b981;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.06);
        transition: box-shadow 0.2s ease, transform 0.2s ease;
      }

      .feedback-item:hover {
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        transform: translateY(-1px);
      }

      .feedback-number {
        width: 32px;
        height: 32px;
        background: #10b981;
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 0.875rem;
        flex-shrink: 0;
        margin-top: 2px;
      }

      .feedback-body {
        flex: 1;
      }

      .feedback-item-title {
        font-size: 1rem;
        font-weight: 600;
        color: #065f46;
        margin: 0 0 0.5rem 0;
      }

      .feedback-description {
        color: #374151;
        line-height: 1.6;
        font-size: 0.9rem;
      }

      /* Overall Score for Feedback Section */
      .feedback-overall-score {
        margin-top: 2rem;
        padding: 1.5rem;
        background: #fef2f2;
        border: 1px solid #fecaca;
        border-radius: 8px;
        text-align: center;
      }

      .feedback-score-text {
        font-size: 1.1rem;
        font-weight: 700;
        color: #dc2626;
        margin: 0;
      }

      /* Action Keyword Highlighting */
      .action-keyword {
        color: #3b82f6;
        font-weight: 600;
      }


      .quantitative-metrics-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: var(--spacing-lg);
        margin-top: var(--spacing-lg);
      }

      .metric-card {
        background: var(--bg-primary);
        border-radius: var(--radius-md);
        padding: var(--spacing-lg);
        border: 1px solid var(--border);
        box-shadow: var(--shadow-sm);
        transition: var(--transition);
      }

      .metric-card:hover {
        box-shadow: var(--shadow-md);
        transform: translateY(-1px);
      }

      .metric-card-header {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: var(--spacing-md);
      }

      .metric-icon {
        width: 36px;
        height: 36px;
        background: var(--primary);
        border-radius: var(--radius-sm);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 16px;
        flex-shrink: 0;
      }

      .metric-title {
        font-weight: 600;
        color: var(--text-primary);
        font-size: 1rem;
        margin: 0;
      }

      .metric-value {
        font-size: 2rem;
        font-weight: 700;
        color: var(--primary);
        margin: var(--spacing-sm) 0;
        display: flex;
        align-items: baseline;
        gap: 0.25rem;
      }

      .metric-unit {
        font-size: 0.875rem;
        color: var(--text-secondary);
        font-weight: 500;
      }

      .metric-description-text {
        color: var(--text-secondary);
        font-size: 0.875rem;
        line-height: 1.5;
        margin-top: var(--spacing-sm);
      }

      .metric-status {
        display: inline-flex;
        align-items: center;
        gap: 0.25rem;
        padding: 0.25rem 0.75rem;
        border-radius: 16px;
        font-size: 0.75rem;
        font-weight: 600;
        margin-top: 0.75rem;
      }

      .metric-status.excellent {
        background: #dcfce7;
        color: #166534;
      }

      .metric-status.good {
        background: #fef3c7;
        color: #92400e;
      }

      .metric-status.needs-improvement {
        background: #fef2f2;
        color: #991b1b;
      }

      /* ==========================================================================
         NEXT STEPS SECTION
         ========================================================================== */
      
      .next-steps-section {
        margin-top: var(--space-8);
        margin-bottom: var(--space-6);
      }

      /* ==========================================================================
         EXPAND PLANS BUTTON
         ========================================================================== */
      
      .expand-plans-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.75rem;
        padding: 1rem 2rem;
        background: linear-gradient(135deg, #4f46e5 0%, #6366f1 100%);
        color: white;
        border: none;
        border-radius: 12px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(79, 70, 229, 0.25);
        margin: 0 auto;
        position: relative;
        overflow: hidden;
      }
      
      .expand-plans-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(79, 70, 229, 0.35);
        background: linear-gradient(135deg, #4338ca 0%, #4f46e5 100%);
      }
      
      .expand-plans-btn:active {
        transform: translateY(0);
      }
      
      .expand-plans-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        transition: left 0.5s ease;
      }
      
      .expand-plans-btn:hover::before {
        left: 100%;
      }
      
      #expandPlansIcon {
        width: 20px;
        height: 20px;
        transition: transform 0.3s ease;
      }
      
      .expand-plans-btn:hover #expandPlansIcon {
        transform: translateY(2px);
      }
      
      /* Improvement Hub Button */
      .improvement-hub-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.75rem;
        padding: 1rem 2rem;
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        color: white;
        border: none;
        border-radius: 12px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.25);
        margin: 0;
        position: relative;
        overflow: hidden;
      }
      
      .improvement-hub-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(16, 185, 129, 0.35);
        background: linear-gradient(135deg, #059669 0%, #047857 100%);
      }
      
      .improvement-hub-btn:active {
        transform: translateY(0);
      }
      
      .improvement-hub-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        transition: left 0.5s ease;
      }
      
      .improvement-hub-btn:hover::before {
        left: 100%;
      }
      
      .improvement-hub-btn i {
        width: 20px;
        height: 20px;
        transition: transform 0.3s ease;
      }
      
      .improvement-hub-btn:hover i {
        transform: translateX(3px);
      }

      /* ==========================================================================
         CARD GRID PLANS
         ========================================================================== */
      
      .card-stack {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 1.5rem;
        width: 100%;
        max-width: 1400px;
        margin: 0 auto;
      }
      
      .plan-card-stack {
        transition: all 0.3s ease;
        cursor: pointer;
        user-select: none;
        width: 100%;
        height: 500px;
        position: relative;
      }
      
      .plan-card-stack:hover {
        transform: translateY(-4px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.12);
      }
      
      .glass-card {
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 20px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
        overflow: hidden;
        height: 100%;
      }
      
      .card-content {
        height: 100%;
        padding: 2.5rem;
        display: flex;
        flex-direction: column;
      }
      
      .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
      }
      
      .plan-icon-stack {
        width: 40px;
        height: 40px;
        background: #f3f4f6;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #6b7280;
      }
      
      .plan-icon-stack.popular-icon {
        background: #ecfdf5;
        color: #10b981;
      }
      
      .plan-icon-stack.enterprise-icon {
        background: #f3f4f6;
        color: #6b7280;
      }
      
      .plan-icon-stack.onetime-icon {
        background: #fef3c7;
        color: #f59e0b;
      }
      
      .card-number {
        font-size: 0.875rem;
        font-weight: 500;
        color: #9ca3af;
      }
      
      .plan-title-stack {
        font-size: 1.75rem;
        font-weight: 600;
        color: #111827;
        margin: 0 0 0.75rem 0;
        line-height: 1.3;
      }
      
      .plan-subtitle-stack {
        font-size: 1rem;
        font-weight: 500;
        color: #6b7280;
        margin-bottom: 1.5rem;
      }
      
      .plan-price-stack {
        font-size: 1.875rem;
        font-weight: 700;
        color: #111827;
        margin-bottom: 1.5rem;
        line-height: 1;
      }
      
      .plan-price-stack span {
        font-size: 1rem;
        font-weight: 400;
        color: #6b7280;
      }
      
      .plan-description-stack {
        color: #4b5563;
        line-height: 1.6;
        margin-bottom: 1.5rem;
        font-size: 1rem;
      }
      
      .plan-subdescription {
        color: #6b7280;
        line-height: 1.5;
        margin-bottom: 1.5rem;
        font-size: 0.9rem;
      }
      
      .plan-features-list {
        margin: 1.5rem 0;
        flex: 1;
      }
      
      .plan-feature {
        padding: 0.75rem 0;
        color: #4b5563;
        font-size: 0.95rem;
        position: relative;
        padding-left: 1.5rem;
        line-height: 1.5;
        border-bottom: 1px solid #f3f4f6;
      }
      
      .plan-feature:last-child {
        border-bottom: none;
      }
      
      .plan-feature::before {
        content: "â€¢";
        position: absolute;
        left: 0;
        top: 0.75rem;
        color: #9ca3af;
        font-weight: normal;
        font-size: 1.2rem;
      }
      
      .plan-cta-stack {
        margin-top: auto;
        width: 100%;
        padding: 1rem 1.5rem;
        border: none;
        border-radius: 10px;
        font-size: 0.95rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
        color: white;
      }
      
      .essential-btn {
        background: #3b82f6;
      }
      
      .essential-btn:hover {
        background: #2563eb;
      }
      
      .popular-btn {
        background: #10b981;
      }
      
      .popular-btn:hover {
        background: #059669;
      }
      
      .enterprise-btn {
        background: #111827;
      }
      
      .enterprise-btn:hover {
        background: #374151;
      }
      
      .onetime-btn {
        background: #f59e0b;
      }
      
      .onetime-btn:hover {
        background: #d97706;
      }
      
      .plan-cta-stack:hover {
        transform: translateY(-1px);
      }
      
      .popular-badge {
        position: absolute;
        top: 20px;
        right: 20px;
        background: #10b981;
        color: white;
        padding: 0.375rem 0.75rem;
        border-radius: 16px;
        font-size: 0.75rem;
        font-weight: 500;
        z-index: 10;
      }
      
      /* Responsive Design */
      @media (max-width: 1200px) {
        .card-stack {
          grid-template-columns: repeat(2, 1fr);
          gap: 1.25rem;
        }
      }
      
      @media (max-width: 768px) {
        .card-stack {
          grid-template-columns: 1fr;
          gap: 1rem;
        }
        
        .plan-card-stack {
          height: auto;
          min-height: 450px;
        }
        
        .card-content {
          padding: 2rem;
        }
      }
      

      .plan-badge {
        position: absolute;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: #f59e0b;
        color: white;
        padding: 0.25rem 1rem;
        border-radius: 16px;
        font-size: 0.75rem;
        font-weight: 600;
        z-index: 10;
      }

      /* Essential Plan Styling */
      .essential-card .plan-card-header {
        background: linear-gradient(135deg, #4f46e5, #6366f1);
      }

      .essential-cta {
        background: #4f46e5;
        color: white;
      }

      .essential-cta:hover {
        background: #4338ca;
        transform: translateY(-2px);
      }

      /* Max Growth Plan Styling */
      .max-growth-card .plan-card-header {
        background: linear-gradient(135deg, #8b5cf6, #a78bfa);
      }

      .max-growth-price {
        color: white;
      }

      .max-growth-cta {
        background: #8b5cf6;
        color: white;
      }

      .max-growth-cta:hover {
        background: #7c3aed;
        transform: translateY(-2px);
      }

      /* Enterprise Plan Styling */
      .enterprise-card .plan-card-header {
        background: linear-gradient(135deg, #0ea5e9, #06b6d4);
      }

      .enterprise-cta {
        background: #0ea5e9;
        color: white;
      }

      .enterprise-cta:hover {
        background: #0284c7;
        transform: translateY(-2px);
      }

      /* One-Time Plan Styling */
      .onetime-card .plan-card-header {
        background: linear-gradient(135deg, #f59e0b, #fbbf24);
      }

      .onetime-cta {
        background: #f59e0b;
        color: white;
      }

      .onetime-cta:hover {
        background: #d97706;
        transform: translateY(-2px);
      }

      /* Slider Navigation */
      .slider-nav {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 2rem;
        margin-top: 2rem;
      }

      .slider-arrow {
        width: 48px;
        height: 48px;
        border: none;
        border-radius: 50%;
        background: white;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
        color: var(--gray-600);
      }

      .slider-arrow:hover {
        background: var(--primary);
        color: white;
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(79, 70, 229, 0.3);
      }

      .slider-dots {
        display: flex;
        gap: 0.75rem;
      }

      .dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: var(--gray-300);
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .dot.active {
        background: var(--primary);
        transform: scale(1.2);
      }

      .dot:hover {
        background: var(--primary-light);
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .plans-slider-container {
          max-width: 100%;
          padding: 1rem;
        }

        .plan-card {
          margin-right: 1rem;
        }

        .plan-card-header {
          padding: 1.5rem;
        }

        .plan-card-body {
          padding: 1.5rem;
        }

        .plan-price {
          font-size: 2rem;
        }
      }

      /* ==========================================================================
         QUALITATIVE ANALYSIS COMPONENTS
         ========================================================================== */

      /* Clean Qualitative Analysis Styles */
      .qualitative-categories {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
        margin-top: 1.5rem;
      }

      .category-card {
        background: #ffffff;
        border-radius: 8px;
        padding: 1.5rem;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
        transition: box-shadow 0.2s ease, transform 0.2s ease;
      }

      .category-card:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        transform: translateY(-1px);
      }

      .category-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 1rem;
      }

      .category-title-group {
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .category-icon {
        width: 36px;
        height: 36px;
        background: #8b5cf6;
        border-radius: 6px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 16px;
        flex-shrink: 0;
      }

      .category-title {
        font-weight: 600;
        color: #1f2937;
        font-size: 1.1rem;
        margin: 0;
      }

      .category-rating {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        background: #f9fafb;
        padding: 0.5rem 1rem;
        border-radius: 16px;
        border: 1px solid #e5e7eb;
      }

      .rating-label {
        font-size: 0.75rem;
        color: #6b7280;
        font-weight: 500;
      }

      .rating-value {
        font-weight: 600;
        color: #3b82f6;
        font-size: 0.875rem;
      }

      .category-content {
        color: #374151;
        line-height: 1.6;
        font-size: 0.9rem;
      }

      .insight-list {
        margin-top: 1rem;
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
      }

      .insight-item {
        display: flex;
        align-items: flex-start;
        gap: 0.75rem;
        padding: 0.75rem;
        background: linear-gradient(135deg, #f8fafc, #f1f5f9);
        border-radius: 8px;
        border-left: 3px solid #64748b;
      }

      .insight-item.strength {
        border-left-color: #10b981;
        background: linear-gradient(135deg, #ecfdf5, #d1fae5);
      }

      .insight-item.improvement {
        border-left-color: #f59e0b;
        background: linear-gradient(135deg, #fffbeb, #fef3c7);
      }

      .insight-item.critical {
        border-left-color: #ef4444;
        background: linear-gradient(135deg, #fef2f2, #fecaca);
      }

      .insight-icon {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 10px;
        flex-shrink: 0;
        margin-top: 2px;
      }

      .insight-item.strength .insight-icon {
        background: #10b981;
      }

      .insight-item.improvement .insight-icon {
        background: #f59e0b;
      }

      .insight-item.critical .insight-icon {
        background: #ef4444;
      }

      .insight-text {
        color: #374151;
        font-size: 0.9rem;
        line-height: 1.5;
      }

      /* Clean Score Display */
      .overall-score-card {
        background: #1f2937;
        color: white;
        border-radius: 12px;
        padding: 2rem;
        text-align: center;
        margin: 2rem 0;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      .score-value {
        font-size: 3rem;
        font-weight: 800;
        color: #ffffff;
        margin: 0;
      }

      .score-label {
        font-size: 1rem;
        color: #d1d5db;
        margin-top: 0.5rem;
        font-weight: 500;
      }

      .score-interpretation {
        margin-top: 1.5rem;
        padding: 1.5rem;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 8px;
      }

      .score-interpretation-text {
        color: #e5e7eb;
        font-size: 0.9rem;
        line-height: 1.5;
      }

      .metric-score {
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        padding: 0.25rem 0.75rem;
        border-radius: 20px;
        font-weight: 600;
        font-size: 0.85rem;
        box-shadow: 0 2px 4px rgba(16, 185, 129, 0.3);
      }

      .metric-with-ideal {
        margin: 1rem 0;
        padding: 1.25rem;
        background: linear-gradient(135deg, #ecfdf5 0%, #f0fdf4 100%);
        border: 1px solid #bbf7d0;
        border-radius: 12px;
        border-left: 4px solid #10b981;
      }

      .metric-title {
        font-weight: 700;
        color: #065f46;
        margin-bottom: 0.5rem;
        font-size: 1rem;
      }

      .metric-details {
        color: #047857;
        line-height: 1.6;
        font-size: 0.9rem;
      }

      .analysis-bullet {
        display: flex;
        margin: 0.75rem 0;
        padding: 1rem;
        background: rgba(99, 102, 241, 0.04);
        border-radius: 8px;
        border-left: 3px solid #6366f1;
        transition: all 0.2s ease;
      }

      .analysis-bullet:hover {
        background: rgba(99, 102, 241, 0.08);
        transform: translateX(2px);
      }

      .bullet-title {
        font-weight: 600;
        color: #374151;
        min-width: 140px;
        font-size: 0.9rem;
      }

      .bullet-description {
        color: #6b7280;
        flex: 1;
        margin-left: 1rem;
        line-height: 1.5;
        font-size: 0.9rem;
      }

      .simple-bullet {
        display: flex;
        align-items: flex-start;
        margin: 0.5rem 0;
        padding: 0.75rem;
        background: #f8fafc;
        border-radius: 6px;
        color: #475569;
        font-size: 0.9rem;
        line-height: 1.5;
      }

      .bullet-icon {
        color: #6366f1;
        font-weight: bold;
        margin-right: 0.75rem;
        flex-shrink: 0;
        margin-top: 2px;
      }

      .emphasis-text {
        color: #1e40af;
        font-weight: 700;
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(99, 102, 241, 0.1));
        padding: 3px 8px;
        border-radius: 6px;
        font-size: 0.95em;
      }

      .professional-header {
        font-size: 1.15rem;
        font-weight: 700;
        color: #1e293b;
        margin: 2rem 0 1.25rem 0;
        padding: 0.75rem 0;
        border-bottom: 3px solid #e2e8f0;
        background: linear-gradient(135deg, #f8fafc, #f1f5f9);
        padding-left: 1rem;
        border-radius: 8px 8px 0 0;
        border-left: 4px solid #3b82f6;
      }

      .analysis-section {
        font-size: 15px;
        line-height: 1.7;
        color: #374151;
      }

      .analysis-point {
        margin: 1rem 0;
        padding: 1rem;
        background: #f1f5f9;
        border-radius: 8px;
        border-left: 4px solid #64748b;
        line-height: 1.6;
      }

      .analysis-point.critical {
        background: linear-gradient(135deg, #fef2f2 0%, #fef7f7 100%);
        border-left-color: #ef4444;
        border: 1px solid #fecaca;
        box-shadow: 0 2px 8px rgba(239, 68, 68, 0.1);
      }

      /* Professional Metric Card Styles for Cohesive Feedback System */
      .professional-metric-card {
        background: white;
        border-radius: 16px;
        border: 1px solid #e5e7eb;
        margin-bottom: 1.5rem;
        padding: 0;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        transition: all 0.3s ease;
        overflow: hidden;
      }

      .professional-metric-card:hover {
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        transform: translateY(-2px);
      }

      .professional-metric-card.excellent {
        border-left: 6px solid #10b981;
        background: linear-gradient(135deg, #ffffff 0%, #f0fdf4 100%);
      }

      .professional-metric-card.good {
        border-left: 6px solid #3b82f6;
        background: linear-gradient(135deg, #ffffff 0%, #eff6ff 100%);
      }

      .professional-metric-card.average {
        border-left: 6px solid #f59e0b;
        background: linear-gradient(135deg, #ffffff 0%, #fffbeb 100%);
      }

      .professional-metric-card.needs-improvement, 
      .professional-metric-card.poor {
        border-left: 6px solid #ef4444;
        background: linear-gradient(135deg, #ffffff 0%, #fef2f2 100%);
      }

      .metric-header {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1.5rem 1.5rem 1rem 1.5rem;
        border-bottom: 1px solid rgba(0, 0, 0, 0.05);
      }

      .metric-icon-container {
        width: 48px;
        height: 48px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
        box-shadow: 0 4px 12px rgba(99, 102, 241, 0.25);
        flex-shrink: 0;
      }

      .metric-icon {
        width: 24px;
        height: 24px;
        color: white;
        filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
      }

      .metric-title-section {
        flex: 1;
        min-width: 0;
      }

      .metric-title {
        font-size: 1.25rem;
        font-weight: 700;
        color: #1f2937;
        margin: 0 0 0.5rem 0;
        line-height: 1.3;
      }

      .metric-value-display {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        flex-wrap: wrap;
      }

      .metric-number {
        font-size: 1.5rem;
        font-weight: 800;
        color: #374151;
      }

      .metric-unit {
        font-size: 1rem;
        font-weight: 600;
        color: #6b7280;
      }

      .metric-rating {
        padding: 0.25rem 0.75rem;
        border-radius: 20px;
        font-weight: 600;
        font-size: 0.875rem;
        text-transform: uppercase;
        letter-spacing: 0.025em;
      }

      .metric-rating.excellent {
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
      }

      .metric-rating.good {
        background: linear-gradient(135deg, #3b82f6, #2563eb);
        color: white;
        box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
      }

      .metric-rating.average {
        background: linear-gradient(135deg, #f59e0b, #d97706);
        color: white;
        box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);
      }

      .metric-rating.needs-improvement,
      .metric-rating.poor {
        background: linear-gradient(135deg, #ef4444, #dc2626);
        color: white;
        box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);
      }

      .metric-content {
        padding: 1.5rem;
      }

      .assessment-section {
        margin-bottom: 1.5rem;
      }

      .assessment-text {
        font-size: 1rem;
        line-height: 1.7;
        color: #374151;
        background: rgba(99, 102, 241, 0.05);
        padding: 1rem;
        border-radius: 12px;
        border-left: 4px solid #6366f1;
      }

      .recommendations-section {
        margin-bottom: 1.5rem;
      }

      .section-label {
        font-size: 1rem;
        font-weight: 700;
        color: #1f2937;
        margin: 0 0 0.75rem 0;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .section-label:before {
        content: 'ðŸŽ¯';
        font-size: 1.25rem;
      }

      .recommendations-list {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }

      .recommendation-item {
        display: flex;
        align-items: flex-start;
        gap: 0.75rem;
        padding: 0.75rem;
        background: rgba(16, 185, 129, 0.05);
        border-radius: 8px;
        border-left: 3px solid #10b981;
        transition: all 0.2s ease;
      }

      .recommendation-item:hover {
        background: rgba(16, 185, 129, 0.1);
        transform: translateX(4px);
      }

      .rec-bullet {
        color: #10b981;
        font-weight: 700;
        font-size: 1.1em;
        flex-shrink: 0;
        margin-top: 2px;
      }

      .rec-text {
        color: #374151;
        line-height: 1.5;
        font-size: 0.95rem;
      }

      .impact-section {
        background: linear-gradient(135deg, #fef3e2 0%, #fef9e7 100%);
        border: 1px solid #fed7aa;
        border-radius: 12px;
        padding: 1rem;
        position: relative;
      }

      .impact-label {
        font-size: 0.875rem;
        font-weight: 700;
        color: #d97706;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-bottom: 0.5rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .impact-label:before {
        content: 'ðŸ’';
        font-size: 1rem;
      }

      .impact-text {
        color: #92400e;
        line-height: 1.6;
        font-size: 0.95rem;
        font-weight: 500;
      }

      .quantitative-grid {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
      }

      .point-header {
        font-weight: 700;
        color: #dc2626;
        margin-bottom: 0.5rem;
        font-size: 1rem;
      }

      .point-content {
        color: #7f1d1d;
        line-height: 1.6;
        font-size: 0.95rem;
      }

      .emphasis {
        color: #1e293b;
        font-weight: 700;
        background: rgba(59, 130, 246, 0.12);
        padding: 2px 6px;
        border-radius: 4px;
      }

      /* Additional Professional Styling Classes */
      .analysis-bullet.strength {
        background: linear-gradient(135deg, #ecfdf5 0%, #f0fdf4 100%);
        border-left-color: #10b981;
        border: 1px solid #bbf7d0;
      }

      .analysis-bullet.improvement {
        background: linear-gradient(135deg, #eff6ff 0%, #f0f9ff 100%);
        border-left-color: #3b82f6;
        border: 1px solid #bfdbfe;
      }

      .analysis-point.category {
        background: linear-gradient(135deg, #fef3e2 0%, #fef9e7 100%);
        border-left-color: #f59e0b;
        border: 1px solid #fed7aa;
      }

      .numbered-item {
        display: flex;
        align-items: flex-start;
        margin: 0.75rem 0;
        padding: 1rem;
        background: rgba(99, 102, 241, 0.04);
        border-radius: 8px;
        border-left: 3px solid #6366f1;
      }

      .number-badge {
        background: linear-gradient(135deg, #6366f1, #4f46e5);
        color: white;
        width: 28px;
        height: 28px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 0.8rem;
        margin-right: 1rem;
        flex-shrink: 0;
        box-shadow: 0 2px 6px rgba(99, 102, 241, 0.3);
      }

      .metric-highlight {
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        padding: 2px 8px;
        border-radius: 12px;
        font-weight: 700;
        font-size: 0.9em;
        box-shadow: 0 2px 4px rgba(16, 185, 129, 0.3);
      }

      .score-highlight {
        background: linear-gradient(135deg, #3b82f6, #1d4ed8);
        color: white;
        padding: 2px 8px;
        border-radius: 12px;
        font-weight: 700;
        font-size: 0.9em;
        box-shadow: 0 2px 4px rgba(59, 130, 246, 0.3);
      }

      .action-keyword {
        background: linear-gradient(135deg, #f59e0b, #d97706);
        color: white;
        padding: 1px 6px;
        border-radius: 8px;
        font-weight: 600;
        font-size: 0.9em;
        box-shadow: 0 1px 3px rgba(245, 158, 11, 0.4);
      }

      /* Advanced Visual Hierarchy Enhancements */
      .premium-analysis-card:hover {
        transform: translateY(-2px);
        box-shadow: 
          0 25px 50px rgba(0, 0, 0, 0.15),
          0 12px 24px rgba(0, 0, 0, 0.08),
          inset 0 1px 0 rgba(255, 255, 255, 0.9);
      }

      .card-header {
        position: relative;
        overflow: hidden;
      }

      .card-header::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%);
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .premium-analysis-card:hover .card-header::after {
        opacity: 1;
      }

      /* Enhanced Typography Scale */
      .card-title {
        font-size: 1.25rem;
        font-weight: 700;
        color: #1a202c;
        margin: 0 0 0.5rem 0;
        line-height: 1.3;
        letter-spacing: -0.01em;
      }

      .card-subtitle {
        font-size: 0.9rem;
        color: #64748b;
        margin: 0;
        font-weight: 500;
        letter-spacing: 0.01em;
      }

      /* Professional Data Visualization */
      .metric-card {
        background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
        border-radius: 16px;
        padding: 1.75rem;
        text-align: center;
        border: 1px solid #e2e8f0;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.04);
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      .metric-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(90deg, #6366f1, #8b5cf6, #06b6d4);
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .metric-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 12px 24px rgba(0, 0, 0, 0.08);
        border-color: #6366f1;
      }

      .metric-card:hover::before {
        opacity: 1;
      }

      .metric-value {
        font-size: 2.25rem;
        font-weight: 700;
        background: linear-gradient(135deg, #6366f1, #8b5cf6);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 0.75rem;
        line-height: 1.1;
      }

      .metric-label {
        font-size: 0.875rem;
        color: #64748b;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      /* Enhanced Progress Bars */
      .progress-bar {
        width: 100%;
        height: 10px;
        background: #e2e8f0;
        border-radius: 5px;
        overflow: hidden;
        margin: 1rem 0;
        box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #6366f1, #8b5cf6, #06b6d4);
        border-radius: 5px;
        transition: width 1s ease-out;
        position: relative;
      }

      .progress-fill::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.3) 50%, transparent 70%);
      }

      /* Executive Summary Styling */
      .overall-assessment {
        background: linear-gradient(135deg, #fef3e2 0%, #fef9e7 100%);
        border: 1px solid #fed7aa;
        border-radius: 16px;
        padding: 2rem;
        margin-bottom: 2rem;
        position: relative;
        overflow: hidden;
      }

      .overall-assessment::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, #f59e0b, #d97706, #f59e0b);
        background-size: 200% 100%;
        animation: shimmer 3s linear infinite;
      }

      .assessment-title {
        font-size: 1.2rem;
        font-weight: 700;
        color: #d97706;
        margin: 0 0 1.25rem 0;
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .assessment-title::before {
        content: 'ðŸ“Š';
        font-size: 1.1em;
      }

      .assessment-content {
        color: #92400e;
        line-height: 1.7;
        font-size: 1rem;
      }

      /* Enhanced Feedback Styling */
      .feedback-item {
        display: flex;
        gap: 1.25rem;
        padding: 1.75rem;
        background: white;
        border-radius: 16px;
        border-left: 4px solid #10b981;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        transition: all 0.3s ease;
        margin: 1.5rem 0;
      }

      .feedback-item:hover {
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
        transform: translateY(-2px);
      }

      .feedback-number {
        width: 40px;
        height: 40px;
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        flex-shrink: 0;
        margin-top: 2px;
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        font-size: 1.1rem;
      }

      .feedback-body {
        flex: 1;
      }

      .feedback-title {
        font-size: 1.1rem;
        font-weight: 700;
        color: #065f46;
        margin: 0 0 0.75rem 0;
        line-height: 1.3;
      }

      .feedback-description {
        color: #047857;
        line-height: 1.7;
        font-size: 1rem;
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .premium-analysis-card {
          border-radius: 16px;
        }

        .card-header {
          padding: 1.5rem 1.5rem 1rem 1.5rem;
          gap: 1rem;
        }

        .card-body {
          padding: 1rem 1.5rem 1.5rem 1.5rem;
        }

        .header-icon {
          width: 48px;
          height: 48px;
        }

        .card-title {
          font-size: 1.1rem;
        }

        .feedback-item {
          flex-direction: column;
          text-align: center;
          gap: 1rem;
        }

        .feedback-number {
          margin: 0 auto;
        }

        .professional-metric {
          flex-direction: column;
          text-align: center;
          gap: 0.75rem;
        }

        .metric-header {
          min-width: auto;
        }

        .bullet-title {
          min-width: auto;
        }

        .analysis-bullet {
          flex-direction: column;
          gap: 0.5rem;
        }
      }
      
      /* ==========================================================================
         TRANSCRIPT SPECIFIC STYLING
         ========================================================================== */
       .transcript-timestamp {
        font-size: 0.75rem;
        color: var(--gray-500);
        margin-bottom: var(--space-3);
      }
      
      .transcript-text {
        line-height: 1.8;
        font-size: 0.9375rem;
        color: var(--gray-700);
      }
      
      /* Metric and Category Styles */
      .metrics-list {
        display: grid;
        gap: var(--space-3);
      }
      
      .metric-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: var(--space-3);
        background: var(--gray-50);
        border-radius: var(--radius-sm);
      }
      
      .metric-label {
        font-size: 0.875rem;
        color: var(--gray-600);
      }
      
      .metric-value {
        font-weight: 600;
        color: var(--primary);
      }
      
      .categories-list {
        display: grid;
        gap: var(--space-4);
      }
      
      .category-item {
        padding: var(--space-4);
        background: var(--gray-50);
        border-radius: var(--radius);
        border-left: 3px solid var(--primary);
      }
      
      .category-name {
        font-weight: 600;
        color: var(--gray-900);
        margin-bottom: var(--space-2);
      }
      
      .category-description {
        font-size: 0.875rem;
        color: var(--gray-700);
        line-height: 1.5;
        margin-bottom: var(--space-2);
      }
      
      .category-rating {
        font-size: 0.75rem;
        font-weight: 600;
        color: var(--primary);
      }
      
      .transcript-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-bottom: var(--space-md);
        border-bottom: 1px solid var(--gray-200);
        margin-bottom: var(--space-lg);
      }
      
      .transcript-status {
        display: flex;
        align-items: center;
        gap: var(--space-xs);
      }
      
      .status-indicator {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: var(--success-green);
      }
      
      .status-indicator.processed {
        background: var(--warning-amber);
      }
      
      .status-text {
        font-size: 0.875rem;
        font-weight: 600;
        color: var(--gray-700);
      }
      
      .transcript-meta {
        display: flex;
        gap: var(--space-md);
        font-size: 0.75rem;
        color: var(--gray-500);
      }
      
      .transcript-text {
        color: var(--gray-800);
        line-height: 1.8;
        font-size: 1rem;
        margin-bottom: var(--space-lg);
      }
      
      .transcript-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-top: var(--space-md);
        border-top: 1px solid var(--gray-200);
      }
      
      .processing-info {
        display: flex;
        align-items: center;
        gap: var(--space-xs);
        font-size: 0.75rem;
        color: var(--gray-500);
      }
      
      .transcript-actions {
        display: flex;
        gap: var(--space-sm);
      }
      
      .transcript-action {
        display: flex;
        align-items: center;
        gap: var(--space-xs);
        padding: var(--space-xs) var(--space-sm);
        border: 1px solid var(--gray-300);
        background: white;
        border-radius: var(--radius-md);
        font-size: 0.75rem;
        color: var(--gray-600);
        cursor: pointer;
        transition: var(--transition-fast);
      }
      
      .transcript-action:hover {
        background: var(--gray-50);
        color: var(--primary-blue);
        border-color: var(--primary-blue);
      }
      
      /* ==========================================================================
         METRIC CARDS FOR NEW LAYOUT
         ========================================================================== */
      .metric-card-new {
        background: var(--gray-50);
        border-radius: var(--radius-lg);
        padding: var(--space-md);
        border: 1px solid var(--gray-200);
        transition: var(--transition-fast);
      }
      
      .metric-card-new:hover {
        background: white;
        box-shadow: var(--shadow-sm);
      }
      
      .metric-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: var(--space-sm);
      }
      
      .metric-name {
        font-size: 0.875rem;
        color: var(--gray-600);
        font-weight: 500;
      }
      
      .metric-value-new {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--primary-blue);
        font-family: var(--font-mono);
      }
      
      .metric-trend {
        font-size: 0.75rem;
        color: var(--success-green);
        display: flex;
        align-items: center;
        gap: 2px;
      }
      
      .metric-trend.down {
        color: var(--error-red);
      }
      
      /* ==========================================================================
         INSIGHT CARDS FOR QUALITATIVE SECTION
         ========================================================================== */
      .insight-card {
        background: white;
        border-radius: var(--radius-lg);
        padding: var(--space-lg);
        border: 1px solid var(--gray-200);
        box-shadow: var(--shadow-sm);
        transition: var(--transition-normal);
      }
      
      .insight-card:hover {
        box-shadow: var(--shadow-md);
        transform: translateY(-2px);
      }
      
      .insight-header {
        display: flex;
        align-items: center;
        gap: var(--space-sm);
        margin-bottom: var(--space-md);
      }
      
      .insight-icon {
        width: 32px;
        height: 32px;
        border-radius: var(--radius-md);
        background: var(--primary-blue);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
      }
      
      .insight-title {
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--gray-900);
      }
      
      .insight-content {
        color: var(--gray-700);
        line-height: 1.6;
        margin-bottom: var(--space-md);
      }
      
      .insight-rating {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: var(--space-sm);
        background: var(--gray-50);
        border-radius: var(--radius-md);
        border: 1px solid var(--gray-200);
      }
      
      .rating-label {
        font-size: 0.75rem;
        color: var(--gray-500);
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }
      
      .rating-score {
        font-weight: 700;
        color: var(--primary-blue);
      }

      /* ==========================================================================
         MODERN VISUAL REDESIGN FOR ALL SECTIONS
         ========================================================================== */
      
      /* Insights Section - Premium Card Design */
      .insights-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
        gap: var(--space-6);
        padding: var(--space-4);
      }
      
      .insight-card-modern {
        background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
        border-radius: 16px;
        padding: var(--space-6);
        border: 1px solid var(--gray-200);
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }
      
      .insight-card-modern::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--primary), var(--primary-light));
      }
      
      .insight-card-modern:hover {
        transform: translateY(-4px);
        box-shadow: 0 10px 25px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      }
      
      .insight-card-modern.strength::before {
        background: linear-gradient(90deg, #10b981, #34d399);
      }
      
      .insight-card-modern.growth::before {
        background: linear-gradient(90deg, #f59e0b, #fbbf24);
      }
      
      .insight-card-modern.recommendation::before {
        background: linear-gradient(90deg, #8b5cf6, #a78bfa);
      }
      
      .insight-card-modern.assessment::before {
        background: linear-gradient(90deg, #3b82f6, #60a5fa);
      }
      
      .insight-card-modern.performance::before {
        background: linear-gradient(90deg, #6366f1, #8b5cf6);
      }
      
      .insight-card-modern.data::before {
        background: linear-gradient(90deg, #06b6d4, #0891b2);
      }
      
      .insight-card-modern.application::before {
        background: linear-gradient(90deg, #f59e0b, #eab308);
      }
      
      .insight-card-modern.next-steps::before {
        background: linear-gradient(90deg, #10b981, #059669);
      }
      
      .insight-header-modern {
        display: flex;
        align-items: center;
        gap: var(--space-4);
        margin-bottom: var(--space-4);
      }
      
      .insight-icon-modern {
        width: 48px;
        height: 48px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 20px;
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        box-shadow: 0 4px 8px rgba(79, 70, 229, 0.3);
      }
      
      .insight-icon-modern.strength {
        background: linear-gradient(135deg, #10b981, #34d399);
        box-shadow: 0 4px 8px rgba(16, 185, 129, 0.3);
      }
      
      .insight-icon-modern.growth {
        background: linear-gradient(135deg, #f59e0b, #fbbf24);
        box-shadow: 0 4px 8px rgba(245, 158, 11, 0.3);
      }
      
      .insight-icon-modern.recommendation {
        background: linear-gradient(135deg, #8b5cf6, #a78bfa);
        box-shadow: 0 4px 8px rgba(139, 92, 246, 0.3);
      }
      
      .insight-icon-modern.performance {
        background: linear-gradient(135deg, #6366f1, #8b5cf6);
        box-shadow: 0 4px 8px rgba(99, 102, 241, 0.3);
      }
      
      .insight-icon-modern.excellent {
        background: linear-gradient(135deg, #10b981, #34d399);
        box-shadow: 0 4px 8px rgba(16, 185, 129, 0.3);
      }
      
      .insight-icon-modern.good {
        background: linear-gradient(135deg, #3b82f6, #60a5fa);
        box-shadow: 0 4px 8px rgba(59, 130, 246, 0.3);
      }
      
      .insight-icon-modern.average {
        background: linear-gradient(135deg, #f59e0b, #fbbf24);
        box-shadow: 0 4px 8px rgba(245, 158, 11, 0.3);
      }
      
      .insight-icon-modern.needs-improvement {
        background: linear-gradient(135deg, #ef4444, #f87171);
        box-shadow: 0 4px 8px rgba(239, 68, 68, 0.3);
      }
      
      .insight-icon-modern.data {
        background: linear-gradient(135deg, #06b6d4, #0891b2);
        box-shadow: 0 4px 8px rgba(6, 182, 212, 0.3);
      }
      
      .insight-icon-modern.assessment {
        background: linear-gradient(135deg, #3b82f6, #60a5fa);
        box-shadow: 0 4px 8px rgba(59, 130, 246, 0.3);
      }
      
      .insight-icon-modern.application {
        background: linear-gradient(135deg, #f59e0b, #eab308);
        box-shadow: 0 4px 8px rgba(245, 158, 11, 0.3);
      }
      
      .insight-icon-modern.next-steps {
        background: linear-gradient(135deg, #10b981, #059669);
        box-shadow: 0 4px 8px rgba(16, 185, 129, 0.3);
      }
      
      .insight-title-modern {
        font-size: 1.125rem;
        font-weight: 700;
        color: var(--gray-900);
        margin: 0;
      }
      
      .insight-content-modern {
        color: var(--gray-700);
        line-height: 1.6;
        font-size: 0.9375rem;
      }
      
      /* Quantitative Section - Data Dashboard Style */
      .quantitative-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: var(--space-5);
        padding: var(--space-4);
      }
      
      .metric-card-dashboard {
        background: white;
        border-radius: 16px;
        padding: var(--space-6);
        border: 1px solid var(--gray-200);
        box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        transition: all 0.3s ease;
        position: relative;
      }
      
      .metric-card-dashboard:hover {
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        transform: translateY(-2px);
      }
      
      .metric-header-dashboard {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: var(--space-4);
      }
      
      .metric-title-dashboard {
        font-size: 0.875rem;
        font-weight: 600;
        color: var(--gray-600);
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }
      
      .metric-icon-dashboard {
        width: 32px;
        height: 32px;
        border-radius: 8px;
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 16px;
      }
      
      .metric-value-dashboard {
        font-size: 2rem;
        font-weight: 800;
        color: var(--gray-900);
        margin-bottom: var(--space-2);
        font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      }
      
      .metric-description-dashboard {
        font-size: 0.875rem;
        color: var(--gray-600);
        line-height: 1.4;
      }
      
      .metric-progress {
        width: 100%;
        height: 6px;
        background: var(--gray-200);
        border-radius: 3px;
        margin-top: var(--space-3);
        overflow: hidden;
      }
      
      .metric-progress-bar {
        height: 100%;
        background: linear-gradient(90deg, var(--primary), var(--primary-light));
        border-radius: 3px;
        transition: width 0.8s ease;
      }
      
      .metric-progress-bar.excellent {
        background: linear-gradient(90deg, var(--personal-primary), var(--personal-secondary));
      }
      
      .metric-progress-bar.good {
        background: linear-gradient(90deg, #3b82f6, #60a5fa);
      }
      
      .metric-progress-bar.needs-improvement {
        background: linear-gradient(90deg, #f59e0b, #fbbf24);
      }
      
      /* Qualitative Section - Assessment Cards */
      .qualitative-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: var(--space-5);
        padding: var(--space-4);
      }
      
      .assessment-card-modern {
        background: white;
        border-radius: 16px;
        padding: var(--space-6);
        border: 1px solid var(--gray-200);
        box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        transition: all 0.3s ease;
        position: relative;
      }
      
      .assessment-card-modern:hover {
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        transform: translateY(-2px);
      }
      
      .assessment-header-modern {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: var(--space-4);
      }
      
      .assessment-title-modern {
        font-size: 1rem;
        font-weight: 700;
        color: var(--gray-900);
        display: flex;
        align-items: center;
        gap: var(--space-3);
      }
      
      .assessment-icon-modern {
        width: 24px;
        height: 24px;
        border-radius: 6px;
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 12px;
      }
      
      .assessment-rating-modern {
        padding: var(--space-2) var(--space-3);
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }
      
      .assessment-rating-modern.excellent {
        background: #ecfdf5;
        color: #065f46;
        border: 1px solid #a7f3d0;
      }
      
      .assessment-rating-modern.good {
        background: #eff6ff;
        color: #1e40af;
        border: 1px solid #93c5fd;
      }
      
      .assessment-rating-modern.average {
        background: #fefce8;
        color: #a16207;
        border: 1px solid #fde047;
      }
      
      .assessment-rating-modern.poor {
        background: #fef2f2;
        color: #dc2626;
        border: 1px solid #fca5a5;
      }
      
      .assessment-content-modern {
        color: var(--gray-700);
        line-height: 1.6;
        font-size: 0.9375rem;
      }
      
      /* Slider Navigation */
      .slider-nav {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 1rem;
        margin-top: 2rem;
      }
      
      .slider-arrow {
        width: 44px;
        height: 44px;
        border-radius: 50%;
        background: white;
        border: 2px solid var(--gray-200);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
        color: var(--gray-600);
      }
      
      .slider-arrow:hover {
        background: var(--gray-50);
        border-color: var(--gray-300);
        transform: scale(1.1);
      }
      
      .slider-arrow i {
        width: 20px;
        height: 20px;
      }
      
      .slider-dots {
        display: flex;
        gap: 0.5rem;
      }
      
      .dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: var(--gray-300);
        cursor: pointer;
        transition: all 0.3s ease;
      }
      
      .dot.active {
        width: 24px;
        border-radius: 4px;
        background: var(--primary);
      }

      /* ==========================================================================
         PERSONAL COMMUNICATION METRICS STYLING
         ========================================================================== */
      .metric-details {
        margin: 0.5rem 0;
        font-size: 0.875rem;
        color: var(--gray-600);
      }

      .metric-details .metric-value {
        margin-bottom: 0.25rem;
      }

      .metric-optimal {
        color: var(--gray-500);
        font-size: 0.75rem;
      }

      .metric-bar {
        height: 8px;
        background: var(--gray-200);
        border-radius: 4px;
        overflow: hidden;
        margin-top: 0.5rem;
      }

      .metric-fill {
        height: 100%;
        border-radius: 4px;
        transition: width 0.3s ease;
      }

      .category-factors {
        margin: 0.75rem 0;
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
      }

      .factor-tag {
        background: var(--gray-100);
        color: var(--gray-700);
        padding: 0.25rem 0.5rem;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 500;
      }

      .category-bar {
        height: 6px;
        background: var(--gray-200);
        border-radius: 3px;
        overflow: hidden;
        margin-top: 0.5rem;
      }

      .category-fill {
        height: 100%;
        border-radius: 3px;
        transition: width 0.3s ease;
      }

      .metric-header .metric-score {
        font-weight: 600;
        font-size: 0.875rem;
      }

      .category-header .category-score {
        font-weight: 600;
        font-size: 1rem;
      }
    </style>
  </head>
  <body>
    <!-- Top Navigation -->
    <nav class="top-nav fade-in delay-100">
      <div class="logo-section">
        <a href="index.html" class="flex items-center gap-3 group">
          <img src="images/tree-logo.svg" alt="Tree Logo" class="h-9 w-auto group-hover:scale-105 transition-transform">
          <span class="font-semibold text-lg tracking-tight nav-brand-text">
              <span class="nav-orange">articul</span><span class="nav-blue">ai</span><span class="nav-orange">tion</span><span class="nav-orange">.com</span>
          </span>
        </a>
        <div class="nav-links">
          <a href="dashboard.html" class="nav-link">Home</a>
          <a href="professional-communication.html" class="nav-link">Professional Communication</a>
          <a href="personal-communication.html" class="nav-link active">Personal Communication</a>
          <a href="improvement-hub.html" class="nav-link">Improvement Hub</a>
          <a href="pricing.html" class="nav-link">Pricing</a>
        </div>
      </div>

      <div class="flex items-center gap-4">
        <!-- Analysis Results Info -->
        <div class="analysis-info">
          <span class="analysis-badge" id="analysisTypeBadge">Personal Communication</span>
        </div>
        
        <!-- User Dropdown -->
        <div class="relative">
          <button
            class="flex items-center gap-3 px-4 py-2 rounded-xl bg-white bg-opacity-10 hover:bg-opacity-15 transition-all"
            id="userMenuBtn"
          >
            <div
              id="userAvatar"
              style="
                width: 32px;
                height: 32px;
                background: linear-gradient(135deg, #16a34a, #22c55e);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                color: white;
                font-weight: 700;
                font-size: 14px;
              "
            >
              U
            </div>
            <div style="display: flex; flex-direction: column; flex: 1; margin-left: 8px;">
              <span
                id="userName"
                style="
                  color: var(--voice-text-primary);
                  font-weight: 500;
                  font-size: 14px;
                  line-height: 1.2;
                "
                >Account</span
              >
              <span
                id="userPlan"
                style="
                  background: linear-gradient(135deg, #10b981, #06b6d4);
                  color: white;
                  padding: 2px 8px;
                  border-radius: 12px;
                  font-size: 10px;
                  font-weight: 600;
                  width: fit-content;
                  margin-top: 2px;
                "
                >Free Plan</span
              >
            </div>
            <i
              data-lucide="chevron-down"
              style="
                width: 16px;
                height: 16px;
                color: var(--voice-text-secondary);
              "
            ></i>
          </button>
          <div
            class="absolute right-0 top-full mt-2 w-48 glass-intense rounded-xl shadow-2xl border border-black border-opacity-10 hidden"
            id="userDropdown"
          >
            <a
              href="#"
              class="flex items-center gap-3 px-4 py-3 hover:bg-black hover:bg-opacity-10 rounded-t-xl"
              style="color: var(--voice-text-primary); font-weight: 400"
            >
              <i data-lucide="user" style="width: 16px; height: 16px"></i>
              <span style="font-size: 14px">Profile Settings</span>
            </a>
            <a
              href="#"
              class="flex items-center gap-3 px-4 py-3 hover:bg-black hover:bg-opacity-10"
              style="color: var(--voice-text-primary); font-weight: 400"
            >
              <i
                data-lucide="credit-card"
                style="width: 16px; height: 16px"
              ></i>
              <span style="font-size: 14px">Billing & Plans</span>
            </a>
            <a
              href="#"
              class="flex items-center gap-3 px-4 py-3 hover:bg-black hover:bg-opacity-10"
              style="color: var(--voice-text-primary); font-weight: 400"
            >
              <i data-lucide="settings" style="width: 16px; height: 16px"></i>
              <span style="font-size: 14px">Preferences</span>
            </a>
            <hr style="border-color: rgba(0, 0, 0, 0.1); margin: 8px 0" />
            <button
              class="flex items-center gap-3 px-4 py-3 hover:bg-red-500 hover:bg-opacity-20 w-full text-left text-red-400 rounded-b-xl"
              id="logoutBtn"
              style="font-weight: 400"
            >
              <i
                data-lucide="log-out"
                style="width: 16px; height: 16px"
              ></i>
              <span style="font-size: 14px">Sign Out</span>
            </button>
          </div>
        </div>
      </div>
    </nav>

    <!-- Page Header -->
    <header class="page-header slide-up delay-200">
      <div class="header-content">
        <h1 id="resultsTitle">Personal Communication Analysis Results</h1>
      </div>
    </header>

    <main class="main-container">
      <!-- Score Section at Top -->
      <div class="score-section scale-in delay-300">
        <div class="score-header">Overall Personal Communication Score</div>
        <div class="score-display">
          <div class="score-circle" id="scoreCircle">--</div>
          <div class="score-details">
            <div class="score-label">Personal Communication Effectiveness</div>
            <div class="score-value" id="scoreText">Analyzing...</div>
          </div>
        </div>
      </div>
      
      <!-- Three Panel Layout -->
      <div class="analysis-panels">
        
        <!-- Left Panel: Transcript -->
        <div class="transcript-panel slide-up delay-400">
          <div class="panel-top-bar">
            <h2>
              <i data-lucide="file-text"></i>
              Transcript
            </h2>
            <button class="copy-btn" onclick="copyTranscript()">
              <i data-lucide="copy"></i>
              Copy transcript
            </button>
          </div>
          
          <div class="transcript-content" id="transcriptContent">
            <div class="loading-state">
              <div class="spinner"></div>
              <p>Transcribing your audio...</p>
            </div>
          </div>
        </div>
        
        <!-- Right Panel: Unified Analysis with 3 Tabs -->
        <div class="unified-analysis-panel slide-up delay-500">
          <!-- Tab Navigation -->
          <div class="unified-tab-header">
            <button class="unified-tab-btn active" data-tab="insights">
              <i data-lucide="lightbulb"></i>
              Insights
            </button>
            <button class="unified-tab-btn" data-tab="quantitative">
              <i data-lucide="bar-chart-2"></i>
              Quantitative
            </button>
            <button class="unified-tab-btn" data-tab="qualitative">
              <i data-lucide="pie-chart"></i>
              Qualitative
            </button>
          </div>
          
          <!-- Tab Content -->
          <div class="unified-tab-content">
            <!-- Insights Tab -->
            <div class="unified-tab-pane active" id="insights-pane">
              <div class="panel-actions" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-4);">
                <h3 style="margin: 0; font-size: 1.125rem; font-weight: 600; color: var(--gray-900);">Communication Insights</h3>
                <button class="copy-btn" onclick="copyAnalysis()">
                  <i data-lucide="copy"></i>
                  Copy Feedback
                </button>
              </div>
              <div id="detailedAnalysisContent">
                <div class="loading-state">
                  <div class="spinner"></div>
                  <p>Generating insights...</p>
                </div>
              </div>
            </div>
            
            <!-- Quantitative Tab -->
            <div class="unified-tab-pane" id="quantitative-pane">
              <div class="panel-actions" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-4);">
                <h3 style="margin: 0; font-size: 1.125rem; font-weight: 600; color: var(--gray-900);">Quantitative Analysis</h3>
                <button class="copy-btn" onclick="copyQuantitative()">
                  <i data-lucide="copy"></i>
                  Copy Data
                </button>
              </div>
              <div id="quantitativeContent">
                <div class="loading-state">
                  <div class="spinner"></div>
                  <p>Analyzing metrics...</p>
                </div>
              </div>
            </div>
            
            <!-- Qualitative Tab -->
            <div class="unified-tab-pane" id="qualitative-pane">
              <div class="panel-actions" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-4);">
                <h3 style="margin: 0; font-size: 1.125rem; font-weight: 600; color: var(--gray-900);">Qualitative Analysis</h3>
                <button class="copy-btn" onclick="copyQualitative()">
                  <i data-lucide="copy"></i>
                  Copy Data
                </button>
              </div>
              <div id="qualitativeContent">
                <div class="loading-state">
                  <div class="spinner"></div>
                  <p>Analyzing patterns...</p>
                </div>
              </div>
            </div>
          </div>
        </div>
        
      </div>

      <!-- Enhanced Next Steps Section -->
      <div class="next-steps-section">
        <div class="insight-card-modern next-steps" style="background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.9)); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.3); box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);">
          <div class="insight-header-modern">
            <div class="insight-icon-modern" style="background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); animation: pulse 2s infinite;">
              <i data-lucide="target"></i>
            </div>
            <h3 class="insight-title-modern" style="font-size: 1.5rem; color: var(--text-primary); font-weight: 700;">Your Next Steps</h3>
          </div>
          <div class="insight-content-modern">
            <!-- Hero Message -->
            <div style="margin-bottom: 3rem; text-align: center; padding: 2.5rem 2rem; background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.9)); border-radius: 20px; border: 1px solid rgba(255, 255, 255, 0.5); backdrop-filter: blur(10px); box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);">
              <div style="max-width: 600px; margin: 0 auto;">
                <h4 style="font-size: 2.25rem; font-weight: 800; background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin: 0 0 1rem 0; line-height: 1.2;">
                  Transform Your Communication
                </h4>
                <p style="color: var(--text-secondary); line-height: 1.8; margin: 0; font-size: 1.125rem; font-weight: 400;">
                  You've unlocked professional insights that transform how you communicate. Choose your growth path and turn these discoveries into <strong style="color: var(--primary-color);">exponential progress</strong>.
                </p>
              </div>
            </div>
            
            
            <!-- Premium Pricing Section -->
            <div style="background: linear-gradient(135deg, rgba(248, 250, 252, 0.95), rgba(241, 245, 249, 0.98)); padding: 2rem; border-radius: 20px; border: 1px solid rgba(255, 255, 255, 0.8); box-shadow: 0 20px 40px rgba(0, 0, 0, 0.06); backdrop-filter: blur(10px); margin-bottom: 2rem; position: relative; overflow: hidden;">
              
              <!-- Collapsible Header -->
              <div style="position: relative; z-index: 1; cursor: pointer;" onclick="togglePricingSection()">
                <div style="display: flex; align-items: center; justify-content: space-between;">
                  <div style="display: flex; align-items: center; gap: 1rem;">
                    <div style="display: inline-flex; align-items: center; gap: 0.5rem; background: rgba(255, 255, 255, 0.8); padding: 0.5rem 1rem; border-radius: 50px; border: 1px solid rgba(0, 0, 0, 0.1);">
                      <i data-lucide="rocket" style="width: 16px; height: 16px; color: var(--primary-color);"></i>
                      <span style="font-size: 0.875rem; font-weight: 600; color: var(--primary-color);">Choose Your Growth Path</span>
                    </div>
                    <div>
                      <h4 style="font-size: 1.5rem; font-weight: 800; color: var(--text-primary); margin: 0; line-height: 1.2;">Plans Built for Every Stage</h4>
                      <p style="font-size: 0.875rem; color: var(--text-secondary); margin: 0.25rem 0 0 0; font-weight: 400;" id="pricingSubtitle">View Our Improvement Plans</p>
                    </div>
                  </div>
                  <button style="background: rgba(255, 255, 255, 0.8); border: 1px solid rgba(0, 0, 0, 0.1); border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s ease;" id="pricingToggleBtn" onmouseover="this.style.background='rgba(255, 255, 255, 1)'; this.style.boxShadow='0 2px 8px rgba(0, 0, 0, 0.1)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.8)'; this.style.boxShadow='none'">
                    <i data-lucide="chevron-down" style="width: 20px; height: 20px; transition: transform 0.3s ease;" id="pricingToggleIcon"></i>
                  </button>
                </div>
              </div>
              
              <!-- Collapsible Content -->
              <div id="pricingContent" style="display: none; opacity: 0; transition: all 0.4s ease; margin-top: 2rem;">
                <p style="font-size: 1rem; color: var(--text-secondary); margin: 0.5rem auto 2rem; font-weight: 400; text-align: center; max-width: 500px;">From first insights to complete masteryâ€”grow at your pace with tools designed for real results.</p>
              
              <!-- Premium Pricing Grid -->
              <div style="position: relative; z-index: 1; display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2rem; max-width: 1400px; margin: 0 auto;">
                
                <!-- Essential Plan -->
                <div style="background: white; border: 2px solid rgba(0, 0, 0, 0.06); border-radius: 24px; padding: 2.5rem 2rem; text-align: left; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); position: relative; overflow: hidden; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.04);" onmouseover="this.style.transform='translateY(-12px)'; this.style.boxShadow='0 25px 50px rgba(99, 102, 241, 0.15)'; this.style.borderColor='rgba(99, 102, 241, 0.2)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 20px rgba(0, 0, 0, 0.04)'; this.style.borderColor='rgba(0, 0, 0, 0.06)'">
                  <div style="margin-bottom: 2rem;">
                    <div style="display: inline-flex; align-items: center; gap: 0.5rem; background: rgba(99, 102, 241, 0.1); padding: 0.375rem 0.75rem; border-radius: 50px; margin-bottom: 1.5rem;">
                      <i data-lucide="play" style="width: 14px; height: 14px; color: var(--primary-color);"></i>
                      <span style="font-size: 0.75rem; font-weight: 600; color: var(--primary-color); text-transform: uppercase; letter-spacing: 0.5px;">Essential</span>
                    </div>
                    <h5 style="font-size: 1.5rem; font-weight: 800; color: var(--text-primary); margin: 0 0 0.5rem 0;">Start Your Growth</h5>
                    <p style="color: var(--text-secondary); font-size: 1rem; margin: 0 0 1.5rem 0; line-height: 1.6;">Perfect for building steady confidence in how you express yourself.</p>
                    <div style="margin-bottom: 2rem;">
                      <span style="font-size: 3rem; font-weight: 900; color: var(--text-primary); line-height: 1;">$9.99</span>
                      <span style="font-size: 1rem; font-weight: 500; color: var(--text-secondary);">/month</span>
                    </div>
                  </div>
                  
                  <div style="margin-bottom: 2rem;">
                    <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 1rem; font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.5px;">What's included:</div>
                    <ul style="list-style: none; padding: 0; margin: 0; space-y: 0.75rem;">
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: rgba(16, 185, 129, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="check" style="width: 12px; height: 12px; color: var(--success-color);"></i>
                        </div>
                        <span>10 detailed audio analyses per month</span>
                      </li>
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: rgba(16, 185, 129, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="check" style="width: 12px; height: 12px; color: var(--success-color);"></i>
                        </div>
                        <span>Monthly improvement catalog with drills</span>
                      </li>
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: rgba(16, 185, 129, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="check" style="width: 12px; height: 12px; color: var(--success-color);"></i>
                        </div>
                        <span>Email support</span>
                      </li>
                    </ul>
                  </div>
                  
                  <button onclick="window.location.href='pricing.html'" style="width: 100%; background: var(--primary-color); color: white; border: none; padding: 1rem 1.5rem; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; font-size: 1rem; box-shadow: 0 4px 12px rgba(99, 102, 241, 0.25);" onmouseover="this.style.background='#5145db'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 25px rgba(99, 102, 241, 0.35)'" onmouseout="this.style.background='var(--primary-color)'; this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(99, 102, 241, 0.25)'">Get Started</button>
                </div>
                
                <!-- Max Growth Plan -->
                <div style="background: linear-gradient(135deg, white, #fafbff); border: 3px solid var(--primary-color); border-radius: 24px; padding: 2.5rem 2rem; text-align: left; position: relative; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); overflow: hidden; transform: scale(1.05); box-shadow: 0 20px 40px rgba(99, 102, 241, 0.15);" onmouseover="this.style.transform='translateY(-12px) scale(1.08)'; this.style.boxShadow='0 30px 60px rgba(99, 102, 241, 0.25)'" onmouseout="this.style.transform='translateY(0) scale(1.05)'; this.style.boxShadow='0 20px 40px rgba(99, 102, 241, 0.15)'">
                  <!-- Popular Badge -->
                  <div style="position: absolute; top: -1px; left: 50%; transform: translateX(-50%); background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); color: white; padding: 0.25rem 0.75rem; border-radius: 15px; font-size: 0.625rem; font-weight: 600; box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3); text-transform: uppercase; letter-spacing: 0.5px;">
                    <i data-lucide="star" style="width: 10px; height: 10px; margin-right: 0.2rem;"></i>Popular
                  </div>
                  
                  <div style="margin-bottom: 2rem; margin-top: 1rem;">
                    <div style="display: inline-flex; align-items: center; gap: 0.5rem; background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.05)); padding: 0.375rem 0.75rem; border-radius: 50px; margin-bottom: 1.5rem;">
                      <i data-lucide="zap" style="width: 14px; height: 14px; color: var(--primary-color);"></i>
                      <span style="font-size: 0.75rem; font-weight: 600; color: var(--primary-color); text-transform: uppercase; letter-spacing: 0.5px;">Max Growth</span>
                    </div>
                    <h5 style="font-size: 1.5rem; font-weight: 800; color: var(--text-primary); margin: 0 0 0.5rem 0;">Complete Transformation</h5>
                    <p style="color: var(--text-secondary); font-size: 1rem; margin: 0 0 1.5rem 0; line-height: 1.6;">For serious communicators ready to unlock their full potential with unlimited practice and expert guidance.</p>
                    <div style="margin-bottom: 2rem;">
                      <span style="font-size: 3rem; font-weight: 900; color: var(--text-primary); line-height: 1;">$15.99</span>
                      <span style="font-size: 1rem; font-weight: 500; color: var(--text-secondary);">/month</span>
                    </div>
                  </div>
                  
                  <div style="margin-bottom: 2rem;">
                    <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 1rem; font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.5px;">Everything in Essential, plus:</div>
                    <ul style="list-style: none; padding: 0; margin: 0; space-y: 0.75rem;">
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(139, 92, 246, 0.1)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="infinity" style="width: 12px; height: 12px; color: var(--primary-color);"></i>
                        </div>
                        <span><strong>Unlimited</strong> audio analysis</span>
                      </li>
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(139, 92, 246, 0.1)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="users" style="width: 12px; height: 12px; color: var(--primary-color);"></i>
                        </div>
                        <span>Weekly expert review sessions</span>
                      </li>
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(139, 92, 246, 0.1)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="sparkles" style="width: 12px; height: 12px; color: var(--primary-color);"></i>
                        </div>
                        <span>Full access to Improvement Hub</span>
                      </li>
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(139, 92, 246, 0.1)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="clock" style="width: 12px; height: 12px; color: var(--primary-color);"></i>
                        </div>
                        <span>Early access to new tools</span>
                      </li>
                    </ul>
                  </div>
                  
                  <button onclick="window.location.href='pricing.html'" style="width: 100%; background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); color: white; border: none; padding: 1rem 1.5rem; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; font-size: 1rem; box-shadow: 0 8px 20px rgba(99, 102, 241, 0.4);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 12px 30px rgba(99, 102, 241, 0.5)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 8px 20px rgba(99, 102, 241, 0.4)'">Start Free Trial</button>
                </div>
                
                <!-- Enterprise Plan -->
                <div style="background: white; border: 2px solid rgba(107, 114, 128, 0.15); border-radius: 24px; padding: 2.5rem 2rem; text-align: left; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); position: relative; overflow: hidden; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.04);" onmouseover="this.style.transform='translateY(-12px)'; this.style.boxShadow='0 25px 50px rgba(107, 114, 128, 0.15)'; this.style.borderColor='rgba(107, 114, 128, 0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 20px rgba(0, 0, 0, 0.04)'; this.style.borderColor='rgba(107, 114, 128, 0.15)'">
                  <div style="margin-bottom: 2rem;">
                    <div style="display: inline-flex; align-items: center; gap: 0.5rem; background: rgba(107, 114, 128, 0.1); padding: 0.375rem 0.75rem; border-radius: 50px; margin-bottom: 1.5rem;">
                      <i data-lucide="building" style="width: 14px; height: 14px; color: var(--text-primary);"></i>
                      <span style="font-size: 0.75rem; font-weight: 600; color: var(--text-primary); text-transform: uppercase; letter-spacing: 0.5px;">Enterprise</span>
                    </div>
                    <h5 style="font-size: 1.5rem; font-weight: 800; color: var(--text-primary); margin: 0 0 0.5rem 0;">Scale Your Team</h5>
                    <p style="color: var(--text-secondary); font-size: 1rem; margin: 0 0 1.5rem 0; line-height: 1.6;">Custom solutions for teams, coaches, and organizations building communication excellence.</p>
                    <div style="margin-bottom: 2rem;">
                      <span style="font-size: 3rem; font-weight: 900; color: var(--text-primary); line-height: 1;">Custom</span>
                      <span style="font-size: 1rem; font-weight: 500; color: var(--text-secondary);"> pricing</span>
                    </div>
                  </div>
                  
                  <div style="margin-bottom: 2rem;">
                    <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 1rem; font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.5px;">Enterprise features:</div>
                    <ul style="list-style: none; padding: 0; margin: 0; space-y: 0.75rem;">
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: rgba(107, 114, 128, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="chart-line" style="width: 12px; height: 12px; color: var(--text-primary);"></i>
                        </div>
                        <span>Custom team dashboards & analytics</span>
                      </li>
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: rgba(107, 114, 128, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="users-2" style="width: 12px; height: 12px; color: var(--text-primary);"></i>
                        </div>
                        <span>Group metrics & shared insights</span>
                      </li>
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: rgba(107, 114, 128, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="headphones" style="width: 12px; height: 12px; color: var(--text-primary);"></i>
                        </div>
                        <span>Dedicated support & onboarding</span>
                      </li>
                    </ul>
                  </div>
                  
                  <button onclick="window.location.href='pricing.html'" style="width: 100%; background: var(--text-primary); color: white; border: none; padding: 1rem 1.5rem; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; font-size: 1rem; box-shadow: 0 4px 12px rgba(107, 114, 128, 0.25);" onmouseover="this.style.background='#1f2937'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 25px rgba(107, 114, 128, 0.35)'" onmouseout="this.style.background='var(--text-primary)'; this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(107, 114, 128, 0.25)'">Contact Sales</button>
                </div>
                
                <!-- One-Time Plan -->
                <div style="background: white; border: 2px solid rgba(139, 92, 246, 0.15); border-radius: 24px; padding: 2.5rem 2rem; text-align: left; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); position: relative; overflow: hidden; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.04);" onmouseover="this.style.transform='translateY(-12px)'; this.style.boxShadow='0 25px 50px rgba(139, 92, 246, 0.15)'; this.style.borderColor='rgba(139, 92, 246, 0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 20px rgba(0, 0, 0, 0.04)'; this.style.borderColor='rgba(139, 92, 246, 0.15)'">
                  <div style="margin-bottom: 2rem;">
                    <div style="display: inline-flex; align-items: center; gap: 0.5rem; background: rgba(139, 92, 246, 0.1); padding: 0.375rem 0.75rem; border-radius: 50px; margin-bottom: 1.5rem;">
                      <i data-lucide="file-text" style="width: 14px; height: 14px; color: var(--secondary-color);"></i>
                      <span style="font-size: 0.75rem; font-weight: 600; color: var(--secondary-color); text-transform: uppercase; letter-spacing: 0.5px;">One-Time</span>
                    </div>
                    <h5 style="font-size: 1.5rem; font-weight: 800; color: var(--text-primary); margin: 0 0 0.5rem 0;">Personal Blueprint</h5>
                    <p style="color: var(--text-secondary); font-size: 1rem; margin: 0 0 1.5rem 0; line-height: 1.6;">A comprehensive communication analysis and personalized improvement plan delivered as a PDF.</p>
                    <div style="margin-bottom: 2rem;">
                      <span style="font-size: 3rem; font-weight: 900; color: var(--text-primary); line-height: 1;">$30</span>
                      <span style="font-size: 1rem; font-weight: 500; color: var(--text-secondary);"> one-time</span>
                    </div>
                  </div>
                  
                  <div style="margin-bottom: 2rem;">
                    <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 1rem; font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.5px;">What you get:</div>
                    <ul style="list-style: none; padding: 0; margin: 0; space-y: 0.75rem;">
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: rgba(139, 92, 246, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="search" style="width: 12px; height: 12px; color: var(--secondary-color);"></i>
                        </div>
                        <span>Deep analysis of vocal patterns & delivery</span>
                      </li>
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: rgba(139, 92, 246, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="target" style="width: 12px; height: 12px; color: var(--secondary-color);"></i>
                        </div>
                        <span>Targeted breakdown of specific issues</span>
                      </li>
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: rgba(139, 92, 246, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="download" style="width: 12px; height: 12px; color: var(--secondary-color);"></i>
                        </div>
                        <span>Lifetime PDF accessâ€”yours forever</span>
                      </li>
                    </ul>
                  </div>
                  
                  <button onclick="window.location.href='pricing.html'" style="width: 100%; background: var(--secondary-color); color: white; border: none; padding: 1rem 1.5rem; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; font-size: 1rem; box-shadow: 0 4px 12px rgba(139, 92, 246, 0.25);" onmouseover="this.style.background='#7c3aed'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 25px rgba(139, 92, 246, 0.35)'" onmouseout="this.style.background='var(--secondary-color)'; this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(139, 92, 246, 0.25)'">Get My Report</button>
                </div>
                
              </div>
              
              </div>
            </div>
            
            <!-- Enhanced Action Section -->
            <div style="margin-top: 3rem; text-align: center; padding: 3rem 2rem; background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(248, 250, 252, 0.9)); border-radius: 20px; border: 1px solid rgba(255, 255, 255, 0.5); backdrop-filter: blur(10px); box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);">
              <div style="max-width: 600px; margin: 0 auto 2rem;">
                <h4 style="font-size: 1.5rem; font-weight: 700; color: var(--text-primary); margin: 0 0 0.75rem 0;">Ready to Continue Your Growth?</h4>
                <p style="color: var(--text-secondary); line-height: 1.6; margin: 0; font-size: 1rem;">Keep building on these insights or explore more tools to accelerate your communication mastery.</p>
              </div>
              
              <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; max-width: 500px; margin: 0 auto;">
                <button onclick="window.location.href='personal-analysis.html'" 
                  style="background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); color: white; border: none; padding: 1rem 2rem; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; font-size: 1rem; box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3); flex: 1; min-width: 200px;"
                  onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 25px rgba(99, 102, 241, 0.4)'"
                  onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(99, 102, 241, 0.3)'">
                  <i data-lucide="mic" style="width: 16px; height: 16px; margin-right: 0.5rem; vertical-align: middle;"></i>
                  Practice Again
                </button>
                <button onclick="window.location.href='improvement-hub.html'" 
                  style="background: white; color: var(--primary-color); border: 2px solid var(--primary-color); padding: 1rem 2rem; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; font-size: 1rem; flex: 1; min-width: 200px;"
                  onmouseover="this.style.background='var(--primary-color)'; this.style.color='white'; this.style.transform='translateY(-2px)'"
                  onmouseout="this.style.background='white'; this.style.color='var(--primary-color)'; this.style.transform='translateY(0)'">
                  <i data-lucide="sparkles" style="width: 16px; height: 16px; margin-right: 0.5rem; vertical-align: middle;"></i>
                  Explore Improvement Hub
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Simple Action Bar -->
      <div class="action-bar">
        <button class="btn-secondary" onclick="startNewAnalysis()">
          <i data-lucide="mic"></i>
          Practice Again
        </button>
        <button class="btn-primary" onclick="shareResults()">
          <i data-lucide="share-2"></i>
          Share
        </button>
      </div>

    </main>

    <!-- API Configuration -->
    <script src="js/api-config.js"></script>
    <script src="js/gemini-ai-engine.js"></script>
    <script src="js/simple-analysis.js"></script>

    <script>
      // Global variables
      let analysisResults = null;
      let analysisType = "presentation";
      let analysisSource = "practice";
      let geminiEngine = null;

      // CRITICAL: Set up Gemini API key for transcription
      window.GEMINI_API_KEY = "AIzaSyBGvwarFw2FbxgxOMnFchyji6G-zYkrgV8";
      console.log("ðŸ”‘ Gemini API key configured for transcription");

      // Personal Communication Metrics Configuration
      const personalCommunicationMetrics = {
        'casual': {
          quantitative: {
            'Speech Rate': { weight: 0.15, optimal: { min: 140, max: 180 } },
            'Talk/Listen Ratio': { weight: 0.20, optimal: { min: 50, max: 70 } },
            'Filler Words': { weight: 0.10, optimal: { min: 0, max: 3 } },
            'Questions Asked': { weight: 0.15, optimal: { min: 3, max: 8 } },
            'Response Time': { weight: 0.10, optimal: { min: 1, max: 3 } },
            'Topic Transitions': { weight: 0.15, optimal: { min: 2, max: 5 } },
            'Conversation Length': { weight: 0.15, optimal: { min: 300, max: 900 } }
          },
          qualitative: {
            'Tone & Warmth': { weight: 0.25, factors: ['friendly tone', 'welcoming language', 'positive energy'] },
            'Engagement Level': { weight: 0.25, factors: ['active listening', 'follow-up questions', 'enthusiasm'] },
            'Relatability': { weight: 0.25, factors: ['shared experiences', 'common ground', 'accessibility'] },
            'Conversation Flow': { weight: 0.25, factors: ['natural transitions', 'comfortable pace', 'mutual participation'] }
          }
        },
        'deep': {
          quantitative: {
            'Speech Rate': { weight: 0.10, optimal: { min: 120, max: 160 } },
            'Talk/Listen Ratio': { weight: 0.25, optimal: { min: 40, max: 60 } },
            'Filler Words': { weight: 0.10, optimal: { min: 0, max: 2 } },
            'Questions Asked': { weight: 0.15, optimal: { min: 2, max: 6 } },
            'Response Time': { weight: 0.10, optimal: { min: 2, max: 5 } },
            'Emotional Words': { weight: 0.15, optimal: { min: 5, max: 15 } },
            'Conversation Length': { weight: 0.15, optimal: { min: 600, max: 1800 } }
          },
          qualitative: {
            'Emotional Tone': { weight: 0.25, factors: ['genuine feeling', 'authentic emotion', 'vulnerability'] },
            'Empathy & Vulnerability': { weight: 0.25, factors: ['sharing personal experiences', 'emotional openness', 'understanding'] },
            'Active Listening': { weight: 0.25, factors: ['reflective responses', 'building on ideas', 'validation'] },
            'Depth of Sharing': { weight: 0.25, factors: ['meaningful topics', 'personal insights', 'philosophical depth'] }
          }
        },
        'storytelling': {
          quantitative: {
            'Speech Rate': { weight: 0.15, optimal: { min: 130, max: 170 } },
            'Talk/Listen Ratio': { weight: 0.20, optimal: { min: 70, max: 85 } },
            'Filler Words': { weight: 0.15, optimal: { min: 0, max: 4 } },
            'Descriptive Words': { weight: 0.15, optimal: { min: 8, max: 20 } },
            'Pauses/Timing': { weight: 0.15, optimal: { min: 3, max: 8 } },
            'Story Structure': { weight: 0.10, optimal: { min: 3, max: 5 } },
            'Conversation Length': { weight: 0.10, optimal: { min: 300, max: 1200 } }
          },
          qualitative: {
            'Narrative Flow': { weight: 0.25, factors: ['clear structure', 'logical progression', 'engaging pace'] },
            'Emotional Engagement': { weight: 0.25, factors: ['emotional investment', 'passion', 'authenticity'] },
            'Descriptive Language': { weight: 0.25, factors: ['vivid imagery', 'sensory details', 'compelling language'] },
            'Audience Connection': { weight: 0.25, factors: ['relatable content', 'audience awareness', 'engagement'] }
          }
        },
        'conflict': {
          quantitative: {
            'Speech Rate': { weight: 0.15, optimal: { min: 110, max: 150 } },
            'Talk/Listen Ratio': { weight: 0.25, optimal: { min: 45, max: 55 } },
            'Filler Words': { weight: 0.10, optimal: { min: 0, max: 2 } },
            'Questions Asked': { weight: 0.15, optimal: { min: 3, max: 8 } },
            'Response Time': { weight: 0.15, optimal: { min: 2, max: 4 } },
            'Solution Words': { weight: 0.10, optimal: { min: 3, max: 10 } },
            'Conversation Length': { weight: 0.10, optimal: { min: 300, max: 1200 } }
          },
          qualitative: {
            'Emotional Regulation': { weight: 0.25, factors: ['calm tone', 'controlled emotion', 'measured responses'] },
            'Empathy & Understanding': { weight: 0.25, factors: ['perspective taking', 'validation', 'compassion'] },
            'Solution Focus': { weight: 0.25, factors: ['constructive approach', 'forward thinking', 'compromise'] },
            'Communication Clarity': { weight: 0.25, factors: ['clear expression', 'specific language', 'understanding'] }
          }
        },
        'dating': {
          quantitative: {
            'Speech Rate': { weight: 0.15, optimal: { min: 130, max: 170 } },
            'Talk/Listen Ratio': { weight: 0.20, optimal: { min: 45, max: 65 } },
            'Filler Words': { weight: 0.10, optimal: { min: 0, max: 3 } },
            'Questions Asked': { weight: 0.15, optimal: { min: 4, max: 10 } },
            'Response Time': { weight: 0.10, optimal: { min: 1, max: 3 } },
            'Compliments Given': { weight: 0.15, optimal: { min: 1, max: 4 } },
            'Conversation Length': { weight: 0.15, optimal: { min: 300, max: 1200 } }
          },
          qualitative: {
            'Charm & Charisma': { weight: 0.25, factors: ['playful energy', 'magnetic presence', 'confidence'] },
            'Emotional Intelligence': { weight: 0.25, factors: ['reading cues', 'appropriate responses', 'sensitivity'] },
            'Authenticity': { weight: 0.25, factors: ['genuine interest', 'honest expression', 'being yourself'] },
            'Connection Building': { weight: 0.25, factors: ['finding common ground', 'creating intimacy', 'mutual interest'] }
          }
        }
      };

      // Process audio file for transcription on this page
      async function processAudioForTranscription(audioDataString) {
        try {
          console.log("ðŸŽ¤ PROCESSING AUDIO FOR TRANSCRIPTION");

          const audioData = JSON.parse(audioDataString);
          console.log("ðŸ“Š Audio data:", {
            size: audioData.size,
            type: audioData.type,
            name: audioData.name,
            analysisType: audioData.analysisType
          });

          // Show loading state in transcript section
          document.getElementById("transcriptContent").innerHTML = `
            <div style="text-align: center; padding: 2rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 12px;">
              <div style="display: flex; align-items: center; justify-content: center; gap: 10px; margin-bottom: 15px;">
                <div style="width: 20px; height: 20px; border: 2px solid #fff; border-top: 2px solid transparent; border-radius: 50%; animation: spin 1s linear infinite;"></div>
                <h3 style="margin: 0; font-size: 18px;">ðŸŽ¤ TRANSCRIBING YOUR AUDIO...</h3>
              </div>
              <p style="margin: 0; opacity: 0.9;">Processing your ${audioData.analysisType || 'personal'} communication with Gemini AI</p>
            </div>
            <style>
              @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
            </style>
          `;

          // Convert base64 back to blob
          const response = await fetch(audioData.base64);
          const blob = await response.blob();

          // Create file for analysis
          const audioFile = new File([blob], audioData.name, {
            type: audioData.type,
          });

          console.log(
            "ðŸ”„ Created audio file for transcription:",
            audioFile.name,
            audioFile.size,
            "bytes"
          );

          // Transcribe audio using Gemini
          const transcript = await transcribeAudioWithGemini(audioFile);
          
          // Analyze using personal communication metrics
          const analysisResults = await analyzePersonalCommunication(transcript, audioData.analysisType);

          console.log(
            "âœ… TRANSCRIPTION AND ANALYSIS COMPLETE:",
            analysisResults
          );

          // Store the completed results
          sessionStorage.setItem(
            "analysisResults",
            JSON.stringify(analysisResults)
          );

          // Clean up audio data (no longer needed)
          sessionStorage.removeItem("audioForAnalysis");

          // Display the results
          console.log("ðŸŽ¨ About to call displayResults with:", analysisResults);

          // CRITICAL: Store this as the final results to prevent demo override
          window.finalAnalysisResults = analysisResults;

          displayResults(analysisResults);
        } catch (error) {
          console.error("âŒ Audio transcription failed:", error);

          // Show error and fallback to demo
          document.getElementById("transcriptContent").innerHTML = `
            <div style="text-align: center; padding: 2rem; background: #fee; border: 2px solid #fcc; border-radius: 12px; color: #c33;">
              <h3>âš ï¸ Transcription Failed</h3>
              <p>Unable to process audio file. Showing demo results instead.</p>
              <p style="font-size: 14px; opacity: 0.8;">Error: ${error.message}</p>
            </div>
          `;

          setTimeout(() => {
            displayDemoResults();
          }, 2000);
        }
      }

      // Transcribe audio using Gemini AI
      async function transcribeAudioWithGemini(audioFile) {
        try {
          console.log("ðŸŽ¤ Transcribing audio with Gemini...");
          
          // Get API key from config
          const apiKey = window.API_CONFIG?.gemini || window.GEMINI_API_KEY;
          if (!apiKey || apiKey === 'YOUR_GEMINI_API_KEY_HERE') {
            throw new Error("Gemini API key not configured");
          }
          
          // Convert audio file to base64
          const arrayBuffer = await audioFile.arrayBuffer();
          const base64Audio = btoa(String.fromCharCode(...new Uint8Array(arrayBuffer)));
          
          const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              contents: [{
                parts: [
                  {
                    text: "Please transcribe this audio file accurately. Return only the transcribed text without any additional commentary."
                  },
                  {
                    inline_data: {
                      mime_type: audioFile.type,
                      data: base64Audio
                    }
                  }
                ]
              }],
              generationConfig: {
                temperature: 0.1,
                maxOutputTokens: 8000,
                topP: 0.8,
                topK: 40
              }
            })
          });

          // Check for HTTP errors
          if (!response.ok) {
            const errorText = await response.text();
            console.error(`âŒ Gemini API error: ${response.status} - ${response.statusText}`, errorText);
            
            // Handle specific error cases
            if (response.status === 503) {
              throw new Error("Gemini service is temporarily unavailable. Please try again in a few moments.");
            } else if (response.status === 429) {
              throw new Error("Rate limit exceeded. Please try again later.");
            } else if (response.status === 401) {
              throw new Error("Invalid API key. Please check your Gemini API configuration.");
            } else {
              throw new Error(`Gemini API error: ${response.status} - ${response.statusText}`);
            }
          }

          const data = await response.json();
          
          if (data.candidates && data.candidates[0] && data.candidates[0].content) {
            const transcript = data.candidates[0].content.parts[0].text;
            console.log("âœ… Transcription successful:", transcript.substring(0, 100) + "...");
            return transcript;
          } else {
            console.error("âŒ Invalid Gemini API response structure:", data);
            throw new Error("No transcription received from Gemini");
          }
        } catch (error) {
          console.error("âŒ Transcription error:", error);
          
          // Provide fallback demo transcript for development/testing
          if (error.message.includes("503") || error.message.includes("service unavailable")) {
            console.log("ðŸ”„ Providing fallback demo transcript due to service unavailability");
            return getPersonalDemoTranscript();
          }
          
          throw new Error(`Transcription failed: ${error.message}`);
        }
      }

      // Fallback demo transcript for personal conversations
      function getPersonalDemoTranscript() {
        return `I've been meaning to tell you something that's been on my mind lately. You know how I've been struggling with my confidence at work?

Yeah, I remember you mentioning that. How are you feeling about it now?

Well, I've been thinking about where it comes from. I think it goes back to when I was younger and my dad used to criticize everything I did. Nothing was ever good enough for him.

That must have been really hard to deal with as a kid. I can see how that would affect your confidence now.

Exactly. And I'm realizing that I've been carrying his voice around in my head all these years. Every time I accomplish something, I hear him saying it's not good enough.

That's such an important realization. Have you thought about talking to someone about it?

I actually started therapy last month. It's been really helpful to unpack all of this. I'm learning that I don't have to keep living by his standards.

I'm so proud of you for taking that step. It takes courage to face these things head-on.

Thanks for saying that. And thank you for being such a good friend. I feel like I can be myself around you without judgment.

Of course! That's what friends are for. I really value our friendship and how we can talk about the real stuff.`;
      }

      // Analyze personal communication using specific metrics
      async function analyzePersonalCommunication(transcript, communicationType) {
        try {
          console.log(`ðŸ§  Analyzing ${communicationType} communication...`);
          
          // Get metrics for this communication type
          const metrics = personalCommunicationMetrics[communicationType] || personalCommunicationMetrics['casual'];
          
          // Calculate quantitative metrics
          const quantitativeScores = await calculateQuantitativeMetrics(transcript, metrics.quantitative);
          
          // Calculate qualitative metrics
          const qualitativeScores = await calculateQualitativeMetrics(transcript, metrics.qualitative, communicationType);
          
          // Calculate overall score
          const overallScore = calculateOverallScore(quantitativeScores, qualitativeScores);
          
          // Generate insights and recommendations
          const insights = await generatePersonalInsights(transcript, quantitativeScores, qualitativeScores, communicationType);
          
          return {
            transcript: transcript,
            analysisType: communicationType,
            quantitativeScores: quantitativeScores,
            qualitativeScores: qualitativeScores,
            overallScore: overallScore,
            insights: insights,
            analysis: insights // For compatibility with existing display functions
          };
        } catch (error) {
          console.error("âŒ Analysis error:", error);
          throw new Error(`Analysis failed: ${error.message}`);
        }
      }

      // Calculate quantitative metrics
      async function calculateQuantitativeMetrics(transcript, quantitativeConfig) {
        const words = transcript.split(/\s+/).filter(word => word.length > 0);
        const sentences = transcript.split(/[.!?]+/).filter(s => s.trim().length > 0);
        
        const metrics = {};
        
        // Speech Rate (words per minute - estimated based on typical speaking pace)
        const estimatedDurationMinutes = words.length / 150; // Average speaking pace
        metrics['Speech Rate'] = Math.round(words.length / estimatedDurationMinutes);
        
        // Talk/Listen Ratio (estimated as percentage of speaking)
        metrics['Talk/Listen Ratio'] = 65; // Default assumption for practice sessions
        
        // Filler Words
        const fillerWords = ['um', 'uh', 'like', 'you know', 'so', 'well'];
        metrics['Filler Words'] = words.filter(word => 
          fillerWords.includes(word.toLowerCase())
        ).length;
        
        // Questions Asked
        metrics['Questions Asked'] = (transcript.match(/\?/g) || []).length;
        
        // Response Time (simulated)
        metrics['Response Time'] = 2; // Default for analysis
        
        // Communication type specific metrics
        if (quantitativeConfig['Emotional Words']) {
          const emotionalWords = ['feel', 'love', 'fear', 'hope', 'dream', 'heart', 'soul', 'passion', 'joy', 'pain'];
          metrics['Emotional Words'] = words.filter(word => 
            emotionalWords.some(emo => word.toLowerCase().includes(emo))
          ).length;
        }
        
        if (quantitativeConfig['Descriptive Words']) {
          const descriptiveWords = words.filter(word => 
            word.length > 6 && /ly$|ing$|ed$/.test(word.toLowerCase())
          ).length;
          metrics['Descriptive Words'] = descriptiveWords;
        }
        
        if (quantitativeConfig['Solution Words']) {
          const solutionWords = ['solution', 'resolve', 'fix', 'improve', 'better', 'help', 'work together'];
          metrics['Solution Words'] = words.filter(word => 
            solutionWords.some(sol => word.toLowerCase().includes(sol))
          ).length;
        }
        
        if (quantitativeConfig['Compliments Given']) {
          const complimentWords = ['beautiful', 'amazing', 'wonderful', 'great', 'fantastic', 'lovely'];
          metrics['Compliments Given'] = words.filter(word => 
            complimentWords.some(comp => word.toLowerCase().includes(comp))
          ).length;
        }
        
        // Topic Transitions (estimated based on sentence variety)
        if (quantitativeConfig['Topic Transitions']) {
          metrics['Topic Transitions'] = Math.min(5, Math.max(1, Math.floor(sentences.length / 3)));
        }
        
        // Pauses/Timing (estimated)
        if (quantitativeConfig['Pauses/Timing']) {
          metrics['Pauses/Timing'] = Math.floor(sentences.length / 2);
        }
        
        // Story Structure (for storytelling)
        if (quantitativeConfig['Story Structure']) {
          const structureWords = ['first', 'then', 'next', 'finally', 'after', 'before'];
          metrics['Story Structure'] = words.filter(word => 
            structureWords.includes(word.toLowerCase())
          ).length;
        }
        
        // Conversation Length (in seconds, estimated)
        metrics['Conversation Length'] = Math.round(words.length * 0.4); // ~2.5 words per second
        
        return metrics;
      }

      // Calculate qualitative metrics using AI analysis
      async function calculateQualitativeMetrics(transcript, qualitativeConfig, communicationType) {
        try {
          const prompt = `Analyze this ${communicationType} conversation transcript for qualitative metrics. Rate each factor from 1-10:

${Object.entries(qualitativeConfig).map(([metric, config]) => 
  `${metric}: Evaluate based on ${config.factors.join(', ')}`
).join('\n')}

Transcript: "${transcript}"

Provide scores in this exact format:
${Object.keys(qualitativeConfig).map(metric => `${metric}: [score 1-10]`).join('\n')}`;

          const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${window.GEMINI_API_KEY}`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              contents: [{
                parts: [{
                  text: prompt
                }]
              }]
            })
          });

          const data = await response.json();
          const analysisText = data.candidates[0].content.parts[0].text;
          
          // Parse scores from response
          const scores = {};
          Object.keys(qualitativeConfig).forEach(metric => {
            const match = analysisText.match(new RegExp(`${metric}:\\s*(\\d+)`, 'i'));
            scores[metric] = match ? parseInt(match[1]) : 3; // Default to 3 if not found
          });
          
          return scores;
        } catch (error) {
          console.error("Error calculating qualitative metrics:", error);
          // Return default scores
          const defaultScores = {};
          Object.keys(qualitativeConfig).forEach(metric => {
            defaultScores[metric] = 3;
          });
          return defaultScores;
        }
      }

      // Calculate overall score
      function calculateOverallScore(quantitativeScores, qualitativeScores) {
        // Weight quantitative vs qualitative (60% qualitative, 40% quantitative for personal communication)
        const qualitativeWeight = 0.6;
        const quantitativeWeight = 0.4;
        
        // Calculate qualitative average
        const qualitativeValues = Object.values(qualitativeScores);
        const qualitativeAvg = qualitativeValues.reduce((a, b) => a + b, 0) / qualitativeValues.length;
        
        // Calculate quantitative score (normalize to 1-10 scale)
        const quantitativeAvg = 3; // Realistic default score
        
        const overallScore = (qualitativeAvg * qualitativeWeight + quantitativeAvg * quantitativeWeight);
        return Math.round(overallScore * 10) / 10; // Round to 1 decimal place
      }

      // Generate personal insights
      async function generatePersonalInsights(transcript, quantitativeScores, qualitativeScores, communicationType) {
        try {
          const prompt = `Analyze this ${communicationType} conversation and provide detailed feedback in this exact format:

STRENGTHS:
â€¢ [List 3-4 specific strengths observed]

AREAS FOR IMPROVEMENT:
â€¢ [List 3-4 specific areas to improve]

RECOMMENDATIONS:
â€¢ [List 3-4 actionable recommendations]

Transcript: "${transcript}"

Quantitative Scores: ${JSON.stringify(quantitativeScores)}
Qualitative Scores: ${JSON.stringify(qualitativeScores)}

Focus on ${communicationType} communication skills and be specific with examples from the transcript.`;

          const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${window.GEMINI_API_KEY}`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              contents: [{
                parts: [{
                  text: prompt
                }]
              }]
            })
          });

          const data = await response.json();
          return data.candidates[0].content.parts[0].text;
        } catch (error) {
          console.error("Error generating insights:", error);
          return `STRENGTHS:
â€¢ Good communication attempt
â€¢ Clear speaking voice
â€¢ Engaged with the topic

AREAS FOR IMPROVEMENT:
â€¢ Continue practicing active listening
â€¢ Work on emotional expression
â€¢ Develop more natural conversation flow

RECOMMENDATIONS:
â€¢ Practice ${communicationType} conversations more regularly
â€¢ Focus on building rapport with others
â€¢ Work on timing and pacing`;
        }
      }

      // Display personal communication analysis results
      function displayPersonalCommunicationResults(results) {
        console.log("ðŸŽ¨ Displaying personal communication results:", results);
        
        // Update overall score
        if (results.overallScore) {
          const scoreCircle = document.getElementById("scoreCircle");
          if (scoreCircle) {
            scoreCircle.textContent = Math.round(results.overallScore * 10);
          }

          const scoreText = document.getElementById("scoreText");
          if (scoreText) {
            const displayScore = Math.round(results.overallScore * 10);
            scoreText.textContent = `${displayScore}/100`;
            
            // Color the score based on performance
            if (displayScore >= 80) {
              scoreText.style.color = '#10b981'; // Green
            } else if (displayScore >= 60) {
              scoreText.style.color = '#3b82f6'; // Blue
            } else if (displayScore >= 40) {
              scoreText.style.color = '#f59e0b'; // Orange
            } else {
              scoreText.style.color = '#ef4444'; // Red
            }
          }
          
          updateScoreColor(Math.round(results.overallScore * 10));
        }

        // Display quantitative metrics
        displayPersonalQuantitativeMetrics(results.quantitativeScores, results.analysisType);
        
        // Display qualitative metrics  
        displayPersonalQualitativeMetrics(results.qualitativeScores, results.analysisType);
        
        // Display insights in the analysis tab
        if (results.insights) {
          parseAndDistributeAnalysis(results.insights, results);
        }
      }

      // Display personal quantitative metrics
      function displayPersonalQuantitativeMetrics(scores, communicationType) {
        const quantitativeElement = document.getElementById('quantitativeContent');
        if (!quantitativeElement) return;

        const metrics = personalCommunicationMetrics[communicationType]?.quantitative || {};
        
        let html = '<div class="metrics-list">';
        
        Object.entries(scores).forEach(([metric, value]) => {
          const config = metrics[metric] || { weight: 0.1, optimal: { min: 0, max: 100 } };
          const optimal = config.optimal;
          
          // Calculate score based on optimal range
          let score;
          if (value >= optimal.min && value <= optimal.max) {
            score = 100; // Perfect score if in optimal range
          } else if (value < optimal.min) {
            score = Math.max(0, 100 - (optimal.min - value) * 2);
          } else {
            score = Math.max(0, 100 - (value - optimal.max) * 2);
          }
          
          score = Math.min(100, Math.max(0, score));
          
          const scoreColor = score >= 80 ? '#10b981' : score >= 60 ? '#3b82f6' : score >= 40 ? '#f59e0b' : '#ef4444';
          
          html += `
            <div class="metric-item">
              <div class="metric-header">
                <span class="metric-name">${metric}</span>
                <span class="metric-score" style="color: ${scoreColor}">${Math.round(score)}/100</span>
              </div>
              <div class="metric-details">
                <div class="metric-value">Measured: ${value}${getMetricUnit(metric)}</div>
                <div class="metric-optimal">Optimal: ${optimal.min}-${optimal.max}${getMetricUnit(metric)}</div>
              </div>
              <div class="metric-bar">
                <div class="metric-fill" style="width: ${score}%; background-color: ${scoreColor}"></div>
              </div>
            </div>
          `;
        });
        
        html += '</div>';
        quantitativeElement.innerHTML = html;
      }

      // Display personal qualitative metrics
      function displayPersonalQualitativeMetrics(scores, communicationType) {
        const qualitativeElement = document.getElementById('qualitativeContent');
        if (!qualitativeElement) return;

        const metrics = personalCommunicationMetrics[communicationType]?.qualitative || {};
        
        let html = '<div class="categories-list">';
        
        Object.entries(scores).forEach(([metric, score]) => {
          const config = metrics[metric] || { weight: 0.25, factors: [] };
          const normalizedScore = (score / 10) * 100; // Convert 1-10 to 0-100
          
          const scoreColor = normalizedScore >= 80 ? '#10b981' : normalizedScore >= 60 ? '#3b82f6' : normalizedScore >= 40 ? '#f59e0b' : '#ef4444';
          
          html += `
            <div class="category-item">
              <div class="category-header">
                <span class="category-name">${metric}</span>
                <span class="category-score" style="color: ${scoreColor}">${score}/10</span>
              </div>
              <div class="category-factors">
                ${config.factors.map(factor => `<span class="factor-tag">${factor}</span>`).join('')}
              </div>
              <div class="category-bar">
                <div class="category-fill" style="width: ${normalizedScore}%; background-color: ${scoreColor}"></div>
              </div>
            </div>
          `;
        });
        
        html += '</div>';
        qualitativeElement.innerHTML = html;
      }

      // Get appropriate unit for metrics
      function getMetricUnit(metric) {
        const units = {
          'Speech Rate': ' wpm',
          'Talk/Listen Ratio': '%',
          'Filler Words': '',
          'Questions Asked': '',
          'Response Time': 's',
          'Emotional Words': '',
          'Descriptive Words': '',
          'Solution Words': '',
          'Compliments Given': '',
          'Topic Transitions': '',
          'Pauses/Timing': '',
          'Story Structure': '',
          'Conversation Length': 's'
        };
        return units[metric] || '';
      }

      // Unified tab switching functionality
      function initializeUnifiedTabSwitching() {
        const tabButtons = document.querySelectorAll('.unified-tab-btn');
        const tabPanes = document.querySelectorAll('.unified-tab-pane');
        
        tabButtons.forEach(button => {
          button.addEventListener('click', () => {
            const targetTab = button.dataset.tab;
            
            // Update active tab button
            tabButtons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            
            // Update active tab pane
            tabPanes.forEach(pane => pane.classList.remove('active'));
            document.getElementById(targetTab + '-pane').classList.add('active');
          });
        });
      }
      
      // Format analysis content into professional insight cards
      function formatAnalysisIntoCards(analysis) {
        if (!analysis) return '<p>No analysis available</p>';
        
        console.log("ðŸ” Formatting analysis into cards:", analysis.substring(0, 200));
        
        // Extract STRENGTHS section
        const strengthsMatch = analysis.match(/STRENGTHS:([\s\S]*?)(?=GROWTH AREAS|ACTIONABLE RECOMMENDATIONS|$)/i);
        const strengthsText = strengthsMatch ? strengthsMatch[1].trim() : '';
        
        // Extract GROWTH AREAS section
        const growthMatch = analysis.match(/GROWTH AREAS:([\s\S]*?)(?=ACTIONABLE RECOMMENDATIONS|STRENGTHS|$)/i);
        const growthText = growthMatch ? growthMatch[1].trim() : '';
        
        // Extract ACTIONABLE RECOMMENDATIONS section
        const recommendationsMatch = analysis.match(/ACTIONABLE RECOMMENDATIONS:([\s\S]*?)(?=STRENGTHS|GROWTH AREAS|$)/i);
        const recommendationsText = recommendationsMatch ? recommendationsMatch[1].trim() : '';
        
        console.log("ðŸ” Extracted sections:", { 
          strengths: !!strengthsText, 
          growth: !!growthText, 
          recommendations: !!recommendationsText 
        });
        
        let cardsHtml = '';
        
        // Generate strategic insights based on quantitative and qualitative data
        let insightsHtml = '';
        
        try {
          console.log("ðŸ” Starting Strategic Insights generation");
          
          // Extract overall score for performance context
          const overallMatch = analysis.match(/OVERALL SCORE:\s*(\d+)\/100/i);
          const overallScore = overallMatch ? parseInt(overallMatch[1]) : 0;
          console.log("ðŸ“Š Overall score extracted:", overallScore);
        
        // Extract data from all analysis sections
        const quantitativeMatch = analysis.match(/QUANTITATIVE ANALYSIS:([\s\S]*?)(?=QUALITATIVE ANALYSIS|STRENGTHS|$)/i);
        const qualitativeMatch = analysis.match(/QUALITATIVE ANALYSIS:([\s\S]*?)(?=STRENGTHS|GROWTH AREAS|$)/i);
        const strengthsMatch = analysis.match(/STRENGTHS:([\s\S]*?)(?=GROWTH AREAS|ACTIONABLE RECOMMENDATIONS|$)/i);
        const growthMatch = analysis.match(/GROWTH AREAS:([\s\S]*?)(?=ACTIONABLE RECOMMENDATIONS|STRENGTHS|$)/i);
        const recommendationsMatch = analysis.match(/ACTIONABLE RECOMMENDATIONS:([\s\S]*?)(?=STRENGTHS|GROWTH AREAS|$)/i);
        
        // Generate strategic insights
        if (overallScore > 0) {
          // Performance Overview Card
          let performanceMessage = '';
          let performanceColor = '';
          let performanceIcon = '';
          
          if (overallScore >= 85) {
            performanceMessage = `
              <div style="margin-bottom: 1rem;"><strong>Exceptional Leadership Communication</strong></div>
              <p>Your ${overallScore}/100 score places you in the top tier of professional communicators. You demonstrate exceptional strategic communication effectiveness that positions you as a strong leader capable of driving meaningful organizational outcomes.</p>
              
              <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                <div style="font-weight: 600; margin-bottom: 0.5rem;">What This Means:</div>
                <ul style="margin: 0; padding-left: 1.5rem; color: var(--gray-700);">
                  <li>You consistently inspire confidence in team members and stakeholders</li>
                  <li>Your communication style enhances team performance and engagement</li>
                  <li>You effectively navigate complex conversations and difficult situations</li>
                  <li>Others likely view you as a trusted advisor and communication role model</li>
                </ul>
              </div>
              
              <div style="margin-top: 1rem;"><strong>Personal Impact:</strong> Your communication effectiveness directly contributes to relationship quality, emotional connection, and your ability to build meaningful bonds. Continue refining your approach to maintain this high standard.</div>
            `;
            performanceColor = 'excellent';
            performanceIcon = 'trophy';
          } else if (overallScore >= 70) {
            performanceMessage = `
              <div style="margin-bottom: 1rem;"><strong>Strong Professional Foundation</strong></div>
              <p>Your ${overallScore}/100 score demonstrates solid professional communication capabilities with clear potential for enhancement. You have a strong foundation that, with targeted development, can significantly enhance your leadership influence and team performance.</p>
              
              <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                <div style="font-weight: 600; margin-bottom: 0.5rem;">Current State:</div>
                <ul style="margin: 0; padding-left: 1.5rem; color: var(--gray-700);">
                  <li>Team members generally understand your expectations and feedback</li>
                  <li>You handle most professional conversations with confidence</li>
                  <li>Your communication supports productivity but may not yet inspire</li>
                  <li>Opportunities exist to elevate from "effective" to "exceptional"</li>
                </ul>
              </div>
              
              <div style="margin-top: 1rem;"><strong>Growth Potential:</strong> You're positioned to make significant improvements that will visibly enhance your leadership presence and team engagement. Small refinements can yield substantial returns.</div>
            `;
            performanceColor = 'good';
            performanceIcon = 'trending-up';
          } else if (overallScore >= 50) {
            performanceMessage = `
              <div style="margin-bottom: 1rem;"><strong>Developing Professional Skills</strong></div>
              <p>Your ${overallScore}/100 score indicates foundational communication skills that need strategic development. With focused improvement efforts, you can significantly enhance your professional impact and leadership effectiveness.</p>
              
              <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                <div style="font-weight: 600; margin-bottom: 0.5rem;">Development Needs:</div>
                <ul style="margin: 0; padding-left: 1.5rem; color: var(--gray-700);">
                  <li>Basic messages get across but may lack clarity or impact</li>
                  <li>Team members might need clarification or feel uncertain about expectations</li>
                  <li>Difficult conversations may feel challenging to navigate effectively</li>
                  <li>Professional presence could be strengthened for greater influence</li>
                </ul>
              </div>
              
              <div style="margin-top: 1rem;"><strong>Improvement Opportunity:</strong> This is an optimal time for skill development. Consistent practice and targeted improvements will create noticeable positive changes in your professional relationships and team dynamics.</div>
            `;
            performanceColor = 'average';
            performanceIcon = 'target';
          } else {
            performanceMessage = `
              <div style="margin-bottom: 1rem;"><strong>Communication Enhancement Priority</strong></div>
              <p>Your ${overallScore}/100 score indicates that communication enhancement should be a high priority for professional development. This analysis provides a clear roadmap for establishing credible leadership presence and driving meaningful professional outcomes.</p>
              
              <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                <div style="font-weight: 600; margin-bottom: 0.5rem;">Current Challenges:</div>
                <ul style="margin: 0; padding-left: 1.5rem; color: var(--gray-700);">
                  <li>Messages may be unclear or misunderstood by team members</li>
                  <li>Difficulty maintaining confidence during challenging conversations</li>
                  <li>Limited ability to influence outcomes through communication</li>
                  <li>Professional presence may not reflect your technical competence</li>
                </ul>
              </div>
              
              <div style="margin-top: 1rem;"><strong>Transformation Potential:</strong> Significant improvement is absolutely achievable. By systematically addressing the key areas identified in this analysis, you can build the communication skills that will transform your professional effectiveness.</div>
            `;
            performanceColor = 'needs-improvement';
            performanceIcon = 'alert-circle';
          }
          
          insightsHtml += `
            <div class="insight-card-modern performance">
              <div class="insight-header-modern">
                <div class="insight-icon-modern ${performanceColor}">
                  <i data-lucide="${performanceIcon}"></i>
                </div>
                <h4 class="insight-title-modern">Performance Overview</h4>
              </div>
              <div class="insight-content-modern">
                <div style="font-size: 2rem; font-weight: 800; color: var(--primary); margin-bottom: 1rem;">${overallScore}/100</div>
                ${performanceMessage}
              </div>
            </div>
          `;
          
          // Data Insights Card - What the numbers tell us
          if (quantitativeMatch) {
            const quantText = quantitativeMatch[1];
            const metricLines = quantText.split('\n').filter(line => 
              line.includes(':') && (line.includes('/10') || line.includes('%') || line.includes('WPM') || line.includes('instances'))
            );
            
            let dataInsights = '';
            if (metricLines.length > 0) {
              const detailedInsights = [];
              const metricAnalysis = [];
              let speechRate = null;
              let fillerPercent = null;
              let structureScores = [];
              
              // Extract and analyze each metric type
              metricLines.forEach(line => {
                const cleanLine = line.trim();
                
                if (cleanLine.includes('/10')) {
                  const score = parseInt(cleanLine.match(/(\d+)\/10/)?.[1] || 0);
                  const metricName = cleanLine.split(':')[0];
                  structureScores.push({name: metricName, score: score});
                  
                  if (score >= 8) {
                    metricAnalysis.push(`<strong>${metricName}:</strong> Excellent ${score}/10 - You demonstrate strong mastery in this area`);
                  } else if (score >= 6) {
                    metricAnalysis.push(`<strong>${metricName}:</strong> Good ${score}/10 - Solid foundation with opportunity for refinement`);
                  } else if (score >= 4) {
                    metricAnalysis.push(`<strong>${metricName}:</strong> Developing ${score}/10 - Focus area for improvement`);
                  } else {
                    metricAnalysis.push(`<strong>${metricName}:</strong> Priority ${score}/10 - Immediate attention needed`);
                  }
                }
                
                if (cleanLine.includes('WPM')) {
                  const rate = parseInt(cleanLine.match(/(\d+)\s*WPM/)?.[1] || 0);
                  speechRate = rate;
                  if (rate >= 110 && rate <= 150) {
                    metricAnalysis.push(`<strong>Speech Rate:</strong> Optimal ${rate} WPM - Perfect pacing for professional communication`);
                  } else if (rate < 110) {
                    metricAnalysis.push(`<strong>Speech Rate:</strong> Slow ${rate} WPM - Consider increasing pace to maintain engagement`);
                  } else {
                    metricAnalysis.push(`<strong>Speech Rate:</strong> Fast ${rate} WPM - Consider slowing down for better comprehension`);
                  }
                }
                
                if (cleanLine.includes('%') && !cleanLine.includes('/')) {
                  const percent = parseFloat(cleanLine.match(/(\d+\.?\d*)%/)?.[1] || 0);
                  fillerPercent = percent;
                  if (percent < 3) {
                    metricAnalysis.push(`<strong>Filler Words:</strong> Excellent ${percent}% - Exceptional verbal control`);
                  } else if (percent < 5) {
                    metricAnalysis.push(`<strong>Filler Words:</strong> Good ${percent}% - Professional level of control`);
                  } else {
                    metricAnalysis.push(`<strong>Filler Words:</strong> ${percent}% - Opportunity to reduce for greater impact`);
                  }
                }
                
                if (cleanLine.includes('instances')) {
                  const instances = parseInt(cleanLine.match(/(\d+)\s*instances/)?.[1] || 0);
                  const metricName = cleanLine.split(':')[0];
                  if (instances >= 5) {
                    metricAnalysis.push(`<strong>${metricName}:</strong> High frequency (${instances}) - Strong emotional intelligence indicators`);
                  } else if (instances >= 3) {
                    metricAnalysis.push(`<strong>${metricName}:</strong> Moderate frequency (${instances}) - Good foundation to build upon`);
                  } else {
                    metricAnalysis.push(`<strong>${metricName}:</strong> Low frequency (${instances}) - Opportunity for enhanced empathy`);
                  }
                }
              });
              
              // Generate comprehensive data insights
              dataInsights = `
                <div style="margin-bottom: 1rem;"><strong>Quantitative Performance Analysis</strong></div>
                <p>Your communication data reveals specific patterns that directly impact your professional effectiveness:</p>
                
                <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                  <div style="font-weight: 600; margin-bottom: 0.5rem;">Key Metrics Breakdown:</div>
                  <div style="line-height: 1.6;">
                    ${metricAnalysis.slice(0, 5).join('<br>')}
                  </div>
                </div>
                
                <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                  <div style="font-weight: 600; margin-bottom: 0.5rem;">Performance Implications:</div>
                  <ul style="margin: 0; padding-left: 1.5rem; color: var(--gray-700);">
                    ${structureScores.length > 0 && structureScores[0].score >= 7 ? 
                      '<li>Your structured approach enhances message clarity and audience comprehension</li>' : 
                      '<li>Improving structure will significantly boost your message impact and clarity</li>'}
                    ${speechRate && speechRate >= 110 && speechRate <= 150 ? 
                      '<li>Your pacing allows audiences to process and retain your information effectively</li>' : 
                      '<li>Optimizing your speaking pace will improve audience engagement and retention</li>'}
                    ${fillerPercent !== null && fillerPercent < 5 ? 
                      '<li>Your verbal control projects confidence and maintains audience attention</li>' : 
                      '<li>Reducing filler words will enhance your credibility and professional presence</li>'}
                  </ul>
                </div>
                
                <div style="margin-top: 1rem;"><strong>Data-Driven Insight:</strong> ${
                  metricAnalysis.length >= 3 ? 
                  'Your metrics show multiple areas of strength that can be leveraged for even greater impact.' :
                  'Your baseline data provides clear targets for focused improvement efforts.'
                }</div>
              `;
            } else {
              dataInsights = `
                <div style="margin-bottom: 1rem;"><strong>Baseline Data Establishment</strong></div>
                <p>Your quantitative metrics provide valuable baseline data for tracking improvement over time and identifying specific areas for development.</p>
                
                <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                  <div style="font-weight: 600; margin-bottom: 0.5rem;">Why This Matters:</div>
                  <ul style="margin: 0; padding-left: 1.5rem; color: var(--gray-700);">
                    <li>Establishes objective measures of your current communication effectiveness</li>
                    <li>Creates benchmarks for tracking progress in future analyses</li>
                    <li>Identifies specific areas where data-driven improvement can be measured</li>
                    <li>Provides foundation for targeted skill development priorities</li>
                  </ul>
                </div>
              `;
            }
            
            insightsHtml += `
              <div class="insight-card-modern data">
                <div class="insight-header-modern">
                  <div class="insight-icon-modern data">
                    <i data-lucide="bar-chart-3"></i>
                  </div>
                  <h4 class="insight-title-modern">What Your Data Reveals</h4>
                </div>
                <div class="insight-content-modern">
                  ${dataInsights}
                </div>
              </div>
            `;
          }
          
          // Strategic Application Card - How to use this information
          if (strengthsMatch && growthMatch) {
            const strengthItems = strengthsMatch[1].split('\n').filter(line => 
              line.trim().startsWith('â€¢') || line.trim().startsWith('-')
            );
            const growthItems = growthMatch[1].split('\n').filter(line => 
              line.trim().startsWith('â€¢') || line.trim().startsWith('-')
            );
            
            let applicationAdvice = '';
            if (strengthItems.length > 0 && growthItems.length > 0) {
              const topStrength = strengthItems[0].replace(/^[â€¢\-]\s*/, '').trim();
              const secondStrength = strengthItems.length > 1 ? strengthItems[1].replace(/^[â€¢\-]\s*/, '').trim() : null;
              const topGrowth = growthItems[0].replace(/^[â€¢\-]\s*/, '').trim();
              const secondGrowth = growthItems.length > 1 ? growthItems[1].replace(/^[â€¢\-]\s*/, '').trim() : null;
              
              applicationAdvice = `
                <div style="margin-bottom: 1rem;"><strong>Strategic Application Framework</strong></div>
                <p>Transform your analysis into practical professional advantage by systematically leveraging strengths and addressing growth areas:</p>
                
                <div style="background: #ecfdf5; padding: 1rem; border-radius: 8px; margin: 1rem 0; border-left: 4px solid #10b981;">
                  <div style="font-weight: 600; margin-bottom: 0.5rem; color: #065f46;">ðŸŽ¯ Leverage Your Core Strength</div>
                  <div style="color: #047857; margin-bottom: 0.5rem;"><strong>Primary Asset:</strong> ${topStrength}</div>
                  <div style="color: #047857; font-size: 0.9rem;">
                    <strong>How to Apply:</strong>
                    <ul style="margin: 0.5rem 0 0 0; padding-left: 1.5rem;">
                      <li>Lead with this strength in challenging conversations and presentations</li>
                      <li>Use it as your confidence anchor when entering difficult discussions</li>
                      <li>Highlight this capability when seeking new opportunities or responsibilities</li>
                      <li>Mentor others in this area to reinforce your own expertise</li>
                    </ul>
                  </div>
                  ${secondStrength ? `
                    <div style="margin-top: 1rem; color: #047857;"><strong>Secondary Strength:</strong> ${secondStrength}</div>
                    <div style="color: #047857; font-size: 0.9rem;">Combine this with your primary strength for maximum impact in complex situations.</div>
                  ` : ''}
                </div>
                
                <div style="background: #fef3c7; padding: 1rem; border-radius: 8px; margin: 1rem 0; border-left: 4px solid #f59e0b;">
                  <div style="font-weight: 600; margin-bottom: 0.5rem; color: #92400e;">âš¡ Priority Development Focus</div>
                  <div style="color: #92400e; margin-bottom: 0.5rem;"><strong>Highest Impact Area:</strong> ${topGrowth}</div>
                  <div style="color: #92400e; font-size: 0.9rem;">
                    <strong>Strategic Approach:</strong>
                    <ul style="margin: 0.5rem 0 0 0; padding-left: 1.5rem;">
                      <li>Dedicate 70% of your development effort to this area for maximum ROI</li>
                      <li>Practice in low-stakes situations before applying in important contexts</li>
                      <li>Seek specific feedback on this area from trusted colleagues or mentors</li>
                      <li>Track measurable improvements weekly to maintain momentum</li>
                    </ul>
                  </div>
                  ${secondGrowth ? `
                    <div style="margin-top: 1rem; color: #92400e;"><strong>Secondary Focus:</strong> ${secondGrowth}</div>
                    <div style="color: #92400e; font-size: 0.9rem;">Address this after establishing consistency in your primary development area.</div>
                  ` : ''}
                </div>
                
                <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                  <div style="font-weight: 600; margin-bottom: 0.5rem;">ðŸ”„ Integration Strategy</div>
                  <ul style="margin: 0; padding-left: 1.5rem; color: var(--gray-700);">
                    <li><strong>Daily Application:</strong> Use your strength in every professional interaction</li>
                    <li><strong>Weekly Practice:</strong> Deliberately work on your growth area in planned situations</li>
                    <li><strong>Monthly Review:</strong> Assess progress and adjust your development approach</li>
                    <li><strong>Quarterly Goals:</strong> Set specific, measurable targets for improvement</li>
                  </ul>
                </div>
                
                <div style="margin-top: 1rem;"><strong>Success Principle:</strong> Excellence comes from maximizing strengths while systematically eliminating weaknesses. Your strength gives you immediate credibility; addressing your growth area unlocks your next level of professional impact.</div>
              `;
            } else {
              applicationAdvice = `
                <div style="margin-bottom: 1rem;"><strong>Development Framework</strong></div>
                <p>Use your analysis data to create a targeted development plan focusing on your highest-impact growth areas.</p>
                
                <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                  <div style="font-weight: 600; margin-bottom: 0.5rem;">Strategic Development Approach:</div>
                  <ul style="margin: 0; padding-left: 1.5rem; color: var(--gray-700);">
                    <li>Identify 1-2 key areas for focused improvement based on your analysis</li>
                    <li>Create specific, measurable goals for each development area</li>
                    <li>Practice new skills in low-risk environments before high-stakes applications</li>
                    <li>Seek regular feedback to track progress and adjust your approach</li>
                  </ul>
                </div>
              `;
            }
            
            insightsHtml += `
              <div class="insight-card-modern application">
                <div class="insight-header-modern">
                  <div class="insight-icon-modern application">
                    <i data-lucide="lightbulb"></i>
                  </div>
                  <h4 class="insight-title-modern">How to Apply This Analysis</h4>
                </div>
                <div class="insight-content-modern">
                  ${applicationAdvice}
                </div>
              </div>
            `;
          }
          
          // Next Steps Card - Concrete actions
          if (recommendationsMatch) {
            const recommendationItems = recommendationsMatch[1].split('\n').filter(line => 
              line.trim().startsWith('â€¢') || line.trim().startsWith('-')
            );
            
            let nextSteps = '';
            if (recommendationItems.length >= 3) {
              const top5Recommendations = recommendationItems.slice(0, 5).map(item => 
                item.replace(/^[â€¢\-]\s*/, '').trim()
              );
              
              nextSteps = `
                <div style="margin-bottom: 1rem;"><strong>Comprehensive Development Roadmap</strong></div>
                <p>Transform your analysis insights into measurable progress with this structured 90-day implementation plan:</p>
                
                <div style="background: #eff6ff; padding: 1rem; border-radius: 8px; margin: 1rem 0; border-left: 4px solid #3b82f6;">
                  <div style="font-weight: 600; margin-bottom: 0.5rem; color: #1e40af;">ðŸš€ Phase 1: Foundation Building (Week 1-2)</div>
                  <div style="color: #1e40af; margin-bottom: 0.5rem;"><strong>Primary Focus:</strong> ${top5Recommendations[0]}</div>
                  <div style="color: #1e40af; font-size: 0.9rem;">
                    <strong>Specific Actions:</strong>
                    <ul style="margin: 0.5rem 0 0 0; padding-left: 1.5rem;">
                      <li>Dedicate 15 minutes daily to practicing this specific skill</li>
                      <li>Identify 2-3 low-stakes situations weekly to apply this improvement</li>
                      <li>Create a simple tracking system to monitor your consistency</li>
                      <li>Schedule weekly self-reflection to assess progress and adjust approach</li>
                    </ul>
                  </div>
                  <div style="margin-top: 0.5rem; color: #1e40af; font-size: 0.9rem;"><strong>Success Metric:</strong> Apply this skill consistently in 80% of planned practice situations.</div>
                </div>
                
                <div style="background: #f0fdf4; padding: 1rem; border-radius: 8px; margin: 1rem 0; border-left: 4px solid #10b981;">
                  <div style="font-weight: 600; margin-bottom: 0.5rem; color: #065f46;">ðŸŽ¯ Phase 2: Skill Integration (Week 3-4)</div>
                  <div style="color: #065f46; margin-bottom: 0.5rem;"><strong>Primary Focus:</strong> ${top5Recommendations[1] || 'Continue refining your foundation skill while adding complexity'}</div>
                  <div style="color: #065f46; font-size: 0.9rem;">
                    <strong>Expansion Strategy:</strong>
                    <ul style="margin: 0.5rem 0 0 0; padding-left: 1.5rem;">
                      <li>Apply Phase 1 skills in moderately challenging situations</li>
                      <li>Begin incorporating your second development focus area</li>
                      <li>Seek feedback from trusted colleagues on your progress</li>
                      <li>Document specific examples of successful application</li>
                    </ul>
                  </div>
                  <div style="margin-top: 0.5rem; color: #065f46; font-size: 0.9rem;"><strong>Success Metric:</strong> Receive positive feedback on your communication improvement from at least 2 colleagues.</div>
                </div>
                
                <div style="background: #fefce8; padding: 1rem; border-radius: 8px; margin: 1rem 0; border-left: 4px solid #eab308;">
                  <div style="font-weight: 600; margin-bottom: 0.5rem; color: #a16207;">âš¡ Phase 3: Advanced Application (Week 5-8)</div>
                  <div style="color: #a16207; margin-bottom: 0.5rem;"><strong>Primary Focus:</strong> ${top5Recommendations[2] || 'Apply skills in high-stakes professional situations'}</div>
                  <div style="color: #a16207; font-size: 0.9rem;">
                    <strong>High-Impact Practice:</strong>
                    <ul style="margin: 0.5rem 0 0 0; padding-left: 1.5rem;">
                      <li>Use your developed skills in important meetings and presentations</li>
                      <li>Take on communication challenges that stretch your abilities</li>
                      <li>Mentor others or lead discussions to reinforce your learning</li>
                      <li>Refine your approach based on results in critical situations</li>
                    </ul>
                  </div>
                  <div style="margin-top: 0.5rem; color: #a16207; font-size: 0.9rem;"><strong>Success Metric:</strong> Successfully apply your improved skills in 3+ high-stakes professional interactions.</div>
                </div>
                
                <div style="background: #f8fafc; padding: 1rem; border-radius: 8px; margin: 1rem 0; border-left: 4px solid #6b7280;">
                  <div style="font-weight: 600; margin-bottom: 0.5rem; color: #374151;">ðŸ”„ Phase 4: Mastery & Optimization (Week 9-12)</div>
                  <div style="color: #374151; margin-bottom: 0.5rem;"><strong>Focus Areas:</strong> 
                    ${top5Recommendations[3] ? top5Recommendations[3] : 'Systematic refinement and habit formation'}
                    ${top5Recommendations[4] ? ` & ${top5Recommendations[4]}` : ''}
                  </div>
                  <div style="color: #374151; font-size: 0.9rem;">
                    <strong>Mastery Actions:</strong>
                    <ul style="margin: 0.5rem 0 0 0; padding-left: 1.5rem;">
                      <li>Conduct comprehensive self-assessment using this same analysis tool</li>
                      <li>Compare your progress against initial baseline measurements</li>
                      <li>Identify next-level development opportunities for continued growth</li>
                      <li>Establish sustainable practices to maintain your improved communication skills</li>
                    </ul>
                  </div>
                  <div style="margin-top: 0.5rem; color: #374151; font-size: 0.9rem;"><strong>Success Metric:</strong> Achieve measurable improvement in overall communication score through follow-up analysis.</div>
                </div>
                
                <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                  <div style="font-weight: 600; margin-bottom: 0.5rem;">ðŸ“Š Progress Tracking System</div>
                  <ul style="margin: 0; padding-left: 1.5rem; color: var(--gray-700);">
                    <li><strong>Daily:</strong> 2-minute reflection on skill application and challenges</li>
                    <li><strong>Weekly:</strong> 15-minute review of progress, successes, and adjustments needed</li>
                    <li><strong>Bi-weekly:</strong> Seek specific feedback from colleagues or supervisor</li>
                    <li><strong>Monthly:</strong> Comprehensive self-assessment and goal refinement</li>
                    <li><strong>Quarterly:</strong> Re-analyze communication using this tool to measure growth</li>
                  </ul>
                </div>
                
                <div style="margin-top: 1rem;"><strong>Implementation Key:</strong> Success comes from consistent daily practice rather than sporadic intense efforts. Start with just 15 minutes per day of focused practice, and your communication effectiveness will compound significantly over the 90-day period.</div>
              `;
            } else {
              nextSteps = `
                <p style="color: var(--gray-600); font-style: italic; text-align: center;">
                  Next steps recommendations will appear here based on your specific analysis results.
                </p>
              `;
            }
            
            insightsHtml += `
              <div class="insight-card-modern next-steps">
                <div class="insight-header-modern">
                  <div class="insight-icon-modern next-steps">
                    <i data-lucide="calendar-check"></i>
                  </div>
                  <h4 class="insight-title-modern">Your Next Steps</h4>
                </div>
                <div class="insight-content-modern">
                  ${nextSteps}
                </div>
              </div>
            `;
          }
        }
        } catch (error) {
          console.error("âŒ Error generating Strategic Insights:", error);
          // Fallback insights
          insightsHtml = `
            <div class="insight-card-modern fallback">
              <div class="insight-header-modern">
                <div class="insight-icon-modern">
                  <i data-lucide="info"></i>
                </div>
                <h4 class="insight-title-modern">Analysis Processing</h4>
              </div>
              <div class="insight-content-modern">
                Your communication analysis is being processed. Strategic insights will appear here when complete.
              </div>
            </div>
          `;
        }
        
        // Create professional strength cards
        if (strengthsText) {
          const strengthItems = strengthsText.split('\n').filter(line => 
            line.trim().startsWith('â€¢') || line.trim().startsWith('-')
          );
          
          strengthItems.forEach(item => {
            const cleanItem = item.replace(/^[â€¢\-]\s*/, '').trim();
            if (cleanItem.length > 10) {
              cardsHtml += `
                <div class="insight-card-modern strength">
                  <div class="insight-header-modern">
                    <div class="insight-icon-modern strength">
                      <i data-lucide="check-circle"></i>
                    </div>
                    <h4 class="insight-title-modern">Communication Strength</h4>
                  </div>
                  <div class="insight-content-modern">${cleanItem}</div>
                </div>
              `;
            }
          });
        }
        
        // Create professional growth opportunity cards
        if (growthText) {
          const growthItems = growthText.split('\n').filter(line => 
            line.trim().startsWith('â€¢') || line.trim().startsWith('-')
          );
          
          growthItems.forEach(item => {
            const cleanItem = item.replace(/^[â€¢\-]\s*/, '').trim();
            if (cleanItem.length > 10) {
              cardsHtml += `
                <div class="insight-card-modern growth">
                  <div class="insight-header-modern">
                    <div class="insight-icon-modern growth">
                      <i data-lucide="arrow-up-right"></i>
                    </div>
                    <h4 class="insight-title-modern">Growth Opportunity</h4>
                  </div>
                  <div class="insight-content-modern">${cleanItem}</div>
                </div>
              `;
            }
          });
        }
        
        // Create actionable recommendations cards
        if (recommendationsText) {
          const recommendationItems = recommendationsText.split('\n').filter(line => 
            line.trim().startsWith('â€¢') || line.trim().startsWith('-')
          );
          
          recommendationItems.forEach(item => {
            const cleanItem = item.replace(/^[â€¢\-]\s*/, '').trim();
            if (cleanItem.length > 10) {
              cardsHtml += `
                <div class="insight-card-modern recommendation">
                  <div class="insight-header-modern">
                    <div class="insight-icon-modern recommendation">
                      <i data-lucide="target"></i>
                    </div>
                    <h4 class="insight-title-modern">Actionable Recommendation</h4>
                  </div>
                  <div class="insight-content-modern">${cleanItem}</div>
                </div>
              `;
            }
          });
        }
        
        // If no cards were generated but we have assessment, that's OK - assessment card was already added above
        if (!cardsHtml.includes('analysis-card strength') && !cardsHtml.includes('analysis-card growth') && !cardsHtml.includes('analysis-card recommendation')) {
          // If only assessment card exists and no other structured sections, add a note
          if (cardsHtml.includes('analysis-card assessment')) {
            cardsHtml += `
              <div class="analysis-card">
                <div class="card-header">
                  <i data-lucide="info" class="card-icon"></i>
                  <h4 class="card-title">Analysis Note</h4>
                </div>
                <div class="card-content">
                  <p>Detailed strengths and recommendations will appear here when comprehensive analysis is available.</p>
                </div>
              </div>
            `;
          }
        }
        
        return `<div class="insights-grid">${insightsHtml}</div>`;
      }
      
      // Parse and format quantitative analysis
      function parseQuantitativeAnalysis(analysis) {
        if (!analysis) return '<div class="quantitative-grid"><div class="empty-state-modern"><i data-lucide="bar-chart-3"></i><p>No quantitative metrics available</p></div></div>';
        
        // Look for QUANTITATIVE ANALYSIS section in the full analysis
        const quantSection = analysis.match(/QUANTITATIVE ANALYSIS:([\s\S]*?)(?=QUALITATIVE ANALYSIS|STRENGTHS|$)/i);
        const quantText = quantSection ? quantSection[1] : analysis;
        
        console.log("ðŸ” Parsing quantitative section:", quantText);
        
        let cardsHtml = '';
        
        // Define metric icons
        const metricIcons = {
          'feedback': 'message-square',
          'empathy': 'heart',
          'clarity': 'target',
          'support': 'users',
          'tone': 'thermometer',
          'speech': 'clock',
          'pitch': 'audio-waveform',
          'filler': 'minus-circle',
          'structure': 'layout',
          'confidence': 'shield-check',
          'default': 'activity'
        };
        
        // Look for metric patterns
        const lines = quantText.split('\n').filter(line => line.trim());
        
        lines.forEach(line => {
          const cleanLine = line.replace(/^[â€¢\-]\s*/, '').trim();
          if (cleanLine.length > 5 && cleanLine.includes(':')) {
            const colonIndex = cleanLine.indexOf(':');
            const label = cleanLine.substring(0, colonIndex).trim();
            const value = cleanLine.substring(colonIndex + 1).trim();
            
            if (label && value && label.length > 2 && value.length > 0) {
              // Determine icon based on metric name
              let icon = metricIcons.default;
              for (const [key, iconName] of Object.entries(metricIcons)) {
                if (label.toLowerCase().includes(key)) {
                  icon = iconName;
                  break;
                }
              }
              
              // Extract numeric value for progress bar
              let progress = 0;
              let progressClass = 'good';
              const numericMatch = value.match(/(\d+)(?:\/(\d+)|\%)/);
              if (numericMatch) {
                const current = parseInt(numericMatch[1]);
                const total = numericMatch[2] ? parseInt(numericMatch[2]) : 100;
                progress = Math.round((current / total) * 100);
                
                if (progress >= 80) progressClass = 'excellent';
                else if (progress >= 60) progressClass = 'good';
                else progressClass = 'needs-improvement';
              }
              
              // Determine detailed interpretation based on metric type and value
              let interpretation = '';
              let recommendations = '';
              let personalImpact = '';
              
              if (label.toLowerCase().includes('feedback') && label.includes('/10')) {
                const score = parseInt(value.match(/(\d+)\/10/)?.[1] || 0);
                if (score >= 8) {
                  interpretation = 'You demonstrate exceptional structured communication that enhances clarity and comprehension. Your feedback follows professional frameworks that maximize effectiveness.';
                  recommendations = 'Leverage this strength in high-stakes conversations â€¢ Mentor others in structured feedback techniques â€¢ Document your approach for team training';
                  personalImpact = 'Strong structured communication builds trust and deeper personal connections';
                } else if (score >= 6) {
                  interpretation = 'Your feedback structure is solid with opportunity for refinement. You have a good foundation that can be enhanced with targeted practice.';
                  recommendations = 'Practice SBI (Situation-Behavior-Impact) model daily â€¢ Seek feedback on your communication structure â€¢ Record yourself for self-assessment';
                  personalImpact = 'Improving structure will significantly boost message clarity and relationship understanding';
                } else {
                  interpretation = 'Developing stronger feedback structure is a priority area that will substantially improve your communication effectiveness.';
                  recommendations = 'Focus 70% of development effort here â€¢ Use structured templates â€¢ Practice in low-stakes situations first';
                  personalImpact = 'Enhanced structure is crucial for establishing trust and meaningful communication in relationships';
                }
              } else if (label.toLowerCase().includes('empathy')) {
                const instances = parseInt(value.match(/(\d+)\s*instances/)?.[1] || 0);
                if (instances >= 5) {
                  interpretation = 'You consistently demonstrate emotional intelligence through empathy and validation. This creates emotional safety and strengthens personal relationships.';
                  recommendations = 'Continue this strength in difficult conversations â€¢ Share empathy techniques with friends â€¢ Use as foundation for deeper relationships';
                  personalImpact = 'High empathy drives deeper connections, trust, and willingness to share vulnerabilities openly';
                } else if (instances >= 3) {
                  interpretation = 'You show good emotional awareness with room to increase frequency. Building on this foundation will enhance your personal connections.';
                  recommendations = 'Practice validation phrases daily â€¢ Study emotional intelligence frameworks â€¢ Increase conscious empathy in interactions';
                  personalImpact = 'Enhanced empathy will improve relationship quality and your ability to connect deeply with others';
                } else {
                  interpretation = 'Developing stronger empathy signals is a high-impact opportunity for improving personal relationships and emotional connections.';
                  recommendations = 'Learn specific empathy phrases â€¢ Practice active listening â€¢ Focus on understanding before responding';
                  personalImpact = 'Increased empathy is essential for building trust and emotional safety in your relationships';
                }
              } else if (label.toLowerCase().includes('tone warmth')) {
                const score = parseInt(value.match(/(\d+)\/10/)?.[1] || 0);
                if (score >= 7) {
                  interpretation = 'Your warm, approachable tone creates emotional safety and enhances personal connection. This is a significant relationship asset.';
                  recommendations = 'Maintain this warmth during difficult conversations â€¢ Use as model for personal communication â€¢ Apply in emotional situations';
                  personalImpact = 'Warm tone builds trust, reduces defensiveness, and improves willingness to open up emotionally';
                } else if (score >= 5) {
                  interpretation = 'Your communication tone is solid with opportunity to add more warmth for enhanced relationship building and personal connection.';
                  recommendations = 'Practice warmer opening phrases â€¢ Smile more during conversations â€¢ Use person\'s name more frequently';
                  personalImpact = 'Increased warmth will improve relationship quality and your approachability in personal connections';
                } else {
                  interpretation = 'Developing a warmer, more approachable tone is crucial for building strong personal relationships and emotional trust.';
                  recommendations = 'Focus on voice modulation training â€¢ Practice empathy in daily interactions â€¢ Seek feedback on tone perception';
                  personalImpact = 'Warmer tone is essential for building meaningful relationships and emotional connection';
                }
              } else if (label.toLowerCase().includes('speech rate') || label.includes('WPM')) {
                const rate = parseInt(value.match(/(\d+)\s*WPM/)?.[1] || 0);
                if (rate >= 110 && rate <= 150) {
                  interpretation = 'Your speaking pace is optimal for personal communication, allowing others to process and retain information effectively.';
                  recommendations = 'Maintain this excellent pacing â€¢ Use strategic pauses for emphasis â€¢ Vary pace for different content types';
                  personalImpact = 'Optimal pacing enhances comprehension and keeps others engaged throughout your conversations';
                } else if (rate < 110) {
                  interpretation = 'Your speaking pace is slower than optimal, which may reduce engagement and energy levels during conversations.';
                  recommendations = 'Practice increasing pace gradually â€¢ Record yourself speaking â€¢ Use metronome apps for pacing practice';
                  personalImpact = 'Improved pacing will boost engagement and your perceived confidence and energy in conversations';
                } else {
                  interpretation = 'Your speaking pace is faster than optimal, which may reduce comprehension and others\' ability to follow your message.';
                  recommendations = 'Practice strategic slowing â€¢ Use more pauses â€¢ Focus on articulation and clarity';
                  personalImpact = 'Optimized pacing will improve message clarity and help others better understand your key points';
                }
              } else if (label.toLowerCase().includes('pitch range')) {
                if (value.toLowerCase().includes('excellent') || value.toLowerCase().includes('dynamic')) {
                  interpretation = 'Your vocal dynamics demonstrate excellent expressiveness and engagement. You effectively use pitch variation to maintain interest and emphasize key points in conversations.';
                  recommendations = 'Continue leveraging this vocal strength â€¢ Use pitch variation strategically in key moments â€¢ Share vocal dynamics techniques with friends';
                  personalImpact = 'Strong vocal dynamics keep others engaged and help convey passion and authenticity';
                } else if (value.toLowerCase().includes('good') || value.toLowerCase().includes('adequate')) {
                  interpretation = 'Your pitch range shows solid foundation with opportunity for enhanced vocal expressiveness to increase engagement in conversations.';
                  recommendations = 'Practice vocal exercises daily â€¢ Record yourself to hear pitch patterns â€¢ Work with a speech coach on dynamics';
                  personalImpact = 'Enhanced vocal variety will significantly improve engagement and emotional connection in conversations';
                } else {
                  interpretation = 'Developing greater pitch range and vocal dynamics is a key opportunity to dramatically improve your communication impact and emotional engagement.';
                  recommendations = 'Focus on vocal warm-ups before speaking â€¢ Practice reading with exaggerated emotion â€¢ Use pitch variation exercises daily';
                  personalImpact = 'Improved vocal dynamics will transform others\' perception of your authenticity and passion';
                }
              } else if (label.toLowerCase().includes('structural clarity') || label.toLowerCase().includes('structure')) {
                if (value.toLowerCase().includes('clear') || value.toLowerCase().includes('excellent')) {
                  interpretation = 'Your communication structure follows clear frameworks with logical flow from beginning to end. This enhances comprehension and helps others follow your thoughts.';
                  recommendations = 'Maintain this structural excellence â€¢ Use as template for conversations â€¢ Apply structure to spontaneous discussions';
                  personalImpact = 'Clear structure builds trust and helps others follow complex thoughts and emotions';
                } else if (value.toLowerCase().includes('some') || value.toLowerCase().includes('partial')) {
                  interpretation = 'Your communication shows structural elements with opportunity to strengthen the beginning-middle-end flow for maximum impact.';
                  recommendations = 'Use structured thinking for conversations â€¢ Practice clear opening statements â€¢ Develop stronger endings with emotional connection';
                  personalImpact = 'Enhanced structure will significantly improve understanding and emotional connection';
                } else {
                  interpretation = 'Developing clear communication structure is critical for personal effectiveness. A strong beginning-middle-end flow is essential for engagement.';
                  recommendations = 'Master clear communication structure â€¢ Use frameworks for consistent organization â€¢ Practice smooth transitions between topics';
                  personalImpact = 'Clear structure is fundamental to trust building and emotional comprehension';
                }
              } else if (label.toLowerCase().includes('filler') || label.toLowerCase().includes('density')) {
                const percentage = parseFloat(value.match(/(\d+\.?\d*)%/)?.[1] || 0);
                if (percentage <= 3) {
                  interpretation = 'Your filler word usage is excellent, demonstrating strong verbal control and conversational polish. This enhances your credibility and message clarity.';
                  recommendations = 'Maintain this verbal discipline â€¢ Use strategic pauses instead of fillers â€¢ Model this skill for others';
                  personalImpact = 'Minimal filler words project confidence and keep others focused on your message';
                } else if (percentage <= 5) {
                  interpretation = 'Your filler word usage is within acceptable range with opportunity for further refinement to enhance conversational polish.';
                  recommendations = 'Practice conscious pausing â€¢ Record yourself to identify filler patterns â€¢ Use breathing techniques for control';
                  personalImpact = 'Reducing fillers will increase perceived confidence and emotional impact';
                } else {
                  interpretation = 'Reducing filler words is a high-impact opportunity to dramatically improve your personal presence and message clarity.';
                  recommendations = 'Focus intensively on filler reduction â€¢ Practice slow, deliberate speech â€¢ Use pause-and-breathe technique';
                  personalImpact = 'Eliminating excess fillers will significantly boost your credibility and emotional engagement';
                }
              } else if (label.toLowerCase().includes('ending') || label.toLowerCase().includes('conclusion')) {
                if (value.toLowerCase().includes('absent') || value.toLowerCase().includes('missing') || value.toLowerCase().includes('weak')) {
                  interpretation = 'Your presentation lacks a strong conclusion. The ending does not provide clear direction, summary, or call-to-action, which significantly reduces overall impact.';
                  recommendations = 'Develop strong closing techniques â€¢ Always end with clear summary and next steps â€¢ Practice memorable final statements';
                  personalImpact = 'Weak endings cause audiences to forget your message and fail to take action - this is critical to fix';
                } else if (value.toLowerCase().includes('strong') || value.toLowerCase().includes('excellent')) {
                  interpretation = 'Your presentation endings are powerful and memorable, providing clear direction and next steps. This maximizes the impact of your entire presentation.';
                  recommendations = 'Continue crafting strong conclusions â€¢ Use this as your signature strength â€¢ Teach others effective closing techniques';
                  personalImpact = 'Strong endings ensure your message is remembered and acted upon by your audience';
                } else if (value.toLowerCase().includes('adequate') || value.toLowerCase().includes('some')) {
                  interpretation = 'Your presentation endings show potential with opportunity to create more powerful, memorable conclusions that drive action.';
                  recommendations = 'Develop signature closing techniques â€¢ Practice clear calls-to-action â€¢ End with specific next steps';
                  personalImpact = 'Stronger endings will significantly improve message retention and audience action';
                } else {
                  interpretation = 'Developing powerful presentation endings is crucial for maximizing your communication impact. Strong conclusions drive audience action and message retention.';
                  recommendations = 'Master 3-5 closing techniques â€¢ Always end with clear next steps â€¢ Practice memorable final statements';
                  personalImpact = 'Strong endings are essential for converting presentation content into audience action and engagement';
                }
              } else if (label.toLowerCase().includes('benefit') && label.toLowerCase().includes('ratio')) {
                const ratio = value.match(/(\d+):(\d+)/);
                if (ratio) {
                  const beneficial = parseInt(ratio[1]);
                  const selfish = parseInt(ratio[2]);
                  if (beneficial >= selfish * 2) {
                    interpretation = 'Your language is exceptionally buyer-focused, consistently emphasizing client benefits over company features. This demonstrates advanced sales communication skills.';
                    recommendations = 'Maintain this buyer-centric approach â€¢ Train other team members â€¢ Use as competitive advantage';
                    personalImpact = 'Benefit-focused language significantly increases sales conversion and client trust';
                  } else if (beneficial > selfish) {
                    interpretation = 'Your communication shows good buyer focus with opportunity to further emphasize client benefits over company features.';
                    recommendations = 'Practice "you get" vs "we offer" language â€¢ Focus on client outcomes â€¢ Use benefit statements consistently';
                    personalImpact = 'Enhanced benefit focus will improve client engagement and sales effectiveness';
                  } else {
                    interpretation = 'Shifting to more benefit-centric language is a critical opportunity to improve sales effectiveness and client connection.';
                    recommendations = 'Transform all "we" statements to "you" benefits â€¢ Focus on client outcomes first â€¢ Practice benefit-focused scripts';
                    personalImpact = 'Benefit-centric language is essential for sales success and client trust building';
                  }
                }
              } else {
                // Default interpretation for truly unknown metrics
                interpretation = `This metric provides valuable insight into your professional communication effectiveness and areas for strategic development.`;
                recommendations = 'Monitor this metric over time â€¢ Seek specific feedback â€¢ Practice targeted improvements';
                personalImpact = 'Improvement in this area will enhance your overall communication effectiveness';
              }
              
              // Determine performance rating based on metric values
              let performanceRating = 'average';
              let ratingText = 'Analysis';
              
              // First check for text-based qualitative ratings
              const lowerValue = value.toLowerCase();
              if (lowerValue.includes('excellent') || lowerValue.includes('outstanding') || lowerValue.includes('exceptional')) {
                performanceRating = 'excellent';
                ratingText = 'Excellent';
              } else if (lowerValue.includes('very good') || lowerValue.includes('strong') || lowerValue.includes('clear')) {
                performanceRating = 'good';
                ratingText = 'Good';
              } else if (lowerValue.includes('weak') || lowerValue.includes('lacking') || lowerValue.includes('poor') || 
                        lowerValue.includes('absent') || lowerValue.includes('missing') ||
                        (lowerValue.includes('high') && label.toLowerCase().includes('filler')) ||
                        lowerValue.includes('exceeding') ||
                        (lowerValue.includes('no') && (label.toLowerCase().includes('conclusion') || label.toLowerCase().includes('structure')))) {
                performanceRating = 'poor';
                ratingText = 'Poor';
              } else if (lowerValue.includes('needs improvement') || lowerValue.includes('limited') || lowerValue.includes('narrow') ||
                        lowerValue.includes('below ideal') || lowerValue.includes('further analysis')) {
                performanceRating = 'needs-improvement';
                ratingText = 'Needs Improvement';
              }
              
              // Then check for numeric values to override if found
              const ratingMatch = value.match(/(\d+)(?:\/(\d+)|\%|:(\d+))?/);
              if (ratingMatch) {
                const firstNum = parseInt(ratingMatch[1]);
                const secondNum = ratingMatch[2] ? parseInt(ratingMatch[2]) : ratingMatch[3] ? parseInt(ratingMatch[3]) : null;
                
                if (label.toLowerCase().includes('ratio') && secondNum !== null) {
                  // For ratios like 0:0
                  if (firstNum === 0 && secondNum === 0) {
                    performanceRating = 'poor';
                    ratingText = 'Poor';
                  } else if (firstNum >= secondNum * 2) {
                    performanceRating = 'excellent';
                    ratingText = 'Excellent';
                  } else if (firstNum > secondNum) {
                    performanceRating = 'good';
                    ratingText = 'Good';
                  } else {
                    performanceRating = 'needs-improvement';
                    ratingText = 'Needs Improvement';
                  }
                } else if (secondNum) {
                  // For scores like 8/10
                  const percentage = (firstNum / secondNum) * 100;
                  if (percentage >= 80) {
                    performanceRating = 'excellent';
                    ratingText = 'Excellent';
                  } else if (percentage >= 60) {
                    performanceRating = 'good';
                    ratingText = 'Good';
                  } else if (percentage >= 40) {
                    performanceRating = 'average';
                    ratingText = 'Average';
                  } else {
                    performanceRating = 'poor';
                    ratingText = 'Poor';
                  }
                } else {
                  // Special handling for filler density percentages (inverse scoring)
                  if (label.toLowerCase().includes('filler') && value.includes('%')) {
                    if (firstNum <= 3) {
                      performanceRating = 'excellent';
                      ratingText = 'Excellent';
                    } else if (firstNum <= 5) {
                      performanceRating = 'good';
                      ratingText = 'Good';
                    } else if (firstNum <= 10) {
                      performanceRating = 'needs-improvement';
                      ratingText = 'Needs Improvement';
                    } else {
                      performanceRating = 'poor';
                      ratingText = 'Poor';
                    }
                  } else {
                    // For single numbers (counts) - regular scoring
                    if (firstNum === 0) {
                      performanceRating = 'poor';
                      ratingText = 'Poor';
                    } else if (firstNum >= 3) {
                      performanceRating = 'excellent';
                      ratingText = 'Excellent';
                    } else if (firstNum >= 1) {
                      performanceRating = 'good';
                      ratingText = 'Good';
                    } else {
                      performanceRating = 'average';
                      ratingText = 'Average';
                    }
                  }
                }
              }
              
              // Extract numeric value if present for display
              const numericValue = value.match(/(\d+(?:\.\d+)?)\s*(?:WPM|%|\/\d+|:\d+)?/);
              const displayValue = numericValue ? numericValue[1] : '--';
              const valueUnit = value.match(/(\d+(?:\.\d+)?)\s*(WPM|%)/)?.[2] || '';
              
              // Create cohesive assessment text
              const fullAssessment = `${value} ${interpretation}`;
              
              cardsHtml += `
                <div class="professional-metric-card ${performanceRating}">
                  <div class="metric-header">
                    <div class="metric-icon-container">
                      <i data-lucide="${icon}" class="metric-icon"></i>
                    </div>
                    <div class="metric-title-section">
                      <h4 class="metric-title">${label}</h4>
                      <div class="metric-value-display">
                        <span class="metric-number">${displayValue}</span>
                        ${valueUnit ? `<span class="metric-unit">${valueUnit}</span>` : ''}
                        <span class="metric-rating ${performanceRating}">${ratingText}</span>
                      </div>
                    </div>
                  </div>
                  
                  <div class="metric-content">
                    <div class="assessment-section">
                      <div class="assessment-text">${fullAssessment}</div>
                    </div>
                    
                    <div class="recommendations-section">
                      <h5 class="section-label">Recommended Actions</h5>
                      <div class="recommendations-list">
                        ${recommendations.split(' â€¢ ').map(rec => `
                          <div class="recommendation-item">
                            <span class="rec-bullet">â†’</span>
                            <span class="rec-text">${rec.trim()}</span>
                          </div>
                        `).join('')}
                      </div>
                    </div>
                    
                    <div class="impact-section">
                      <div class="impact-label">Personal Impact</div>
                      <div class="impact-text">${personalImpact}</div>
                    </div>
                  </div>
                </div>
              `;
            }
          }
        });
        
        // If no metrics found, show formatted content
        if (!cardsHtml) {
          cardsHtml = `
            <div class="metric-card-dashboard">
              <div class="metric-header-dashboard">
                <div class="metric-title-dashboard">Quantitative Analysis</div>
                <div class="metric-icon-dashboard">
                  <i data-lucide="bar-chart-3"></i>
                </div>
              </div>
              <div class="metric-value-dashboard">Processing</div>
              <div class="metric-description-dashboard">Professional metrics calculated</div>
            </div>
          `;
        }
        
        return `<div class="quantitative-grid">${cardsHtml}</div>`;
      }
      
      // Parse and format qualitative analysis
      function parseQualitativeAnalysis(analysis) {
        if (!analysis) return '<div class="qualitative-grid"><div class="empty-state-modern"><i data-lucide="pie-chart"></i><p>No qualitative analysis available</p></div></div>';
        
        // Look for QUALITATIVE ANALYSIS section
        const qualSection = analysis.match(/QUALITATIVE ANALYSIS:([\s\S]*?)(?=STRENGTHS|GROWTH AREAS|$)/i);
        const qualText = qualSection ? qualSection[1] : analysis;
        
        let cardsHtml = '';
        
        // Define the comprehensive personal communication qualitative criteria with icons
        const personalCriteria = [
          // Casual & Social Conversation Criteria
          {
            label: "Tone & Warmth",
            icon: "heart",
            question: "Was the speaker warm, friendly with genuine delivery?",
            pattern: /(?:Tone.*?Warmth|Warmth)[:\s]*(.*?)(?=\n|$)/i
          },
          {
            label: "Clarity & Confidence", 
            icon: "volume-2",
            question: "Was the speech clear and confident without rushing?",
            pattern: /(?:Clarity.*?Confidence|Clarity)[:\s]*(.*?)(?=\n|$)/i
          },
          {
            label: "Engagement Cues",
            icon: "ear",
            question: "Did the speaker use active listening signals and responses?",
            pattern: /(?:Engagement.*?Cues|Engagement)[:\s]*(.*?)(?=\n|$)/i
          },
          {
            label: "Open-Ended Questions",
            icon: "help-circle",
            question: "Did the speaker ask questions that invite sharing?",
            pattern: /(?:Open.*?Questions|Questions)[:\s]*(.*?)(?=\n|$)/i
          },
          {
            label: "Rapport Building",
            icon: "users",
            question: "Did the speaker connect over common interests smoothly?",
            pattern: /(?:Rapport.*?Building|Rapport)[:\s]*(.*?)(?=\n|$)/i
          },
          // Deep & Meaningful Conversation Criteria
          {
            label: "Emotional Tone",
            icon: "heart",
            question: "Did the emotional tone match the conversation appropriately?",
            pattern: /(?:Emotional.*?Tone|Emotional)[:\s]*(.*?)(?=\n|$)/i
          },
          {
            label: "Empathy & Vulnerability",
            icon: "shield-heart",
            question: "Was there authentic concern and appropriate self-disclosure?",
            pattern: /(?:Empathy.*?Vulnerability|Empathy)[:\s]*(.*?)(?=\n|$)/i
          },
          {
            label: "Active Listening",
            icon: "ear",
            question: "Did the speaker acknowledge points and build trust?",
            pattern: /(?:Active.*?Listening|Listening)[:\s]*(.*?)(?=\n|$)/i
          },
          {
            label: "Depth of Sharing",
            icon: "message-circle",
            question: "Were personal details shared with clear context?",
            pattern: /(?:Depth.*?Sharing|Sharing)[:\s]*(.*?)(?=\n|$)/i
          },
          {
            label: "Supportive Feedback",
            icon: "thumbs-up",
            question: "Were responses supportive and non-judgmental?",
            pattern: /(?:Supportive.*?Feedback|Supportive)[:\s]*(.*?)(?=\n|$)/i
          },
          // Storytelling & Sharing Criteria
          {
            label: "Clarity of Narrative",
            icon: "book-open",
            question: "Did the story have clear beginning, middle, and end?",
            pattern: /(?:Clarity.*?Narrative|Narrative)[:\s]*(.*?)(?=\n|$)/i
          },
          {
            label: "Vividness",
            icon: "image",
            question: "Were concrete, sensory details used effectively?",
            pattern: /(?:Vividness|Vivid)[:\s]*(.*?)(?=\n|$)/i
          },
          {
            label: "Voice Modulation",
            icon: "volume-x",
            question: "Was pitch and pace varied effectively for impact?",
            pattern: /(?:Voice.*?Modulation|Modulation)[:\s]*(.*?)(?=\n|$)/i
          },
          {
            label: "Engagement",
            icon: "users",
            question: "Were listeners invited in and engaged throughout?",
            pattern: /(?:Engagement|Engage)[:\s]*(.*?)(?=\n|$)/i
          },
          // Conflict Resolution Criteria
          {
            label: "Tone & Calmness",
            icon: "zen",
            question: "Was tone calm and measured with controlled volume?",
            pattern: /(?:Tone.*?Calmness|Calmness)[:\s]*(.*?)(?=\n|$)/i
          },
          {
            label: "Empathy & Acknowledgment",
            icon: "check-circle",
            question: "Were other perspectives acknowledged and understood?",
            pattern: /(?:Empathy.*?Acknowledgment|Acknowledgment)[:\s]*(.*?)(?=\n|$)/i
          },
          {
            label: "Language Choice",
            icon: "message-square",
            question: "Were 'I' statements used with solution-focused phrasing?",
            pattern: /(?:Language.*?Choice|Language)[:\s]*(.*?)(?=\n|$)/i
          },
          {
            label: "Problem-Solving Focus",
            icon: "target",
            question: "Was there emphasis on collaboration and compromise?",
            pattern: /(?:Problem.*?Solving|Problem)[:\s]*(.*?)(?=\n|$)/i
          },
          // Dating & Romantic Conversation Criteria
          {
            label: "Sincerity & Confidence",
            icon: "heart",
            question: "Was delivery warm, genuine, and confident?",
            pattern: /(?:Sincerity.*?Confidence|Sincerity)[:\s]*(.*?)(?=\n|$)/i
          },
          {
            label: "Interest & Engagement",
            icon: "eye",
            question: "Was active interest demonstrated with engagement cues?",
            pattern: /(?:Interest.*?Engagement|Interest)[:\s]*(.*?)(?=\n|$)/i
          },
          {
            label: "Flirtatious Warmth",
            icon: "smile",
            question: "Was appropriate humor and warmth used naturally?",
            pattern: /(?:Flirtatious.*?Warmth|Flirtatious)[:\s]*(.*?)(?=\n|$)/i
          },
          {
            label: "Authenticity",
            icon: "user-check",
            question: "Was the demeanor natural and relaxed without forcing?",
            pattern: /(?:Authenticity|Authentic)[:\s]*(.*?)(?=\n|$)/i
          }
        ];
        
        // Function to determine rating class based on assessment text
        function getRatingClass(assessment) {
          const lowerAssessment = assessment.toLowerCase();
          if (lowerAssessment.includes('excellent') || lowerAssessment.includes('outstanding') || lowerAssessment.includes('strong')) {
            return 'excellent';
          } else if (lowerAssessment.includes('good') || lowerAssessment.includes('solid') || lowerAssessment.includes('adequate')) {
            return 'good';
          } else if (lowerAssessment.includes('poor') || lowerAssessment.includes('weak') || lowerAssessment.includes('absent') || lowerAssessment.includes('non-existent')) {
            return 'poor';
          } else {
            return 'average';
          }
        }
        
        // Extract and format each criterion
        let foundCriteria = false;
        personalCriteria.forEach(criterion => {
          const match = qualText.match(criterion.pattern);
          if (match && match[1]) {
            foundCriteria = true;
            const assessment = match[1].trim();
            const ratingClass = getRatingClass(assessment);
            const ratingText = ratingClass.charAt(0).toUpperCase() + ratingClass.slice(1);
            
            // Detailed interpretation based on assessment
            let interpretation = '';
            let recommendations = '';
            let personalImpact = '';
            
            if (criterion.label === "Emotional Intelligence") {
              if (ratingClass === 'excellent') {
                interpretation = 'You consistently demonstrate exceptional emotional intelligence and awareness throughout your communication. Your ability to understand and respond to emotions creates meaningful connections and deeper relationships.';
                recommendations = 'Maintain this strength in all personal interactions â€¢ Share your emotional awareness with others â€¢ Use as foundation for deepening relationships';
                personalImpact = 'High emotional intelligence builds trust, strengthens bonds, and creates lasting meaningful relationships';
              } else if (ratingClass === 'good') {
                interpretation = 'You show solid emotional awareness with opportunity to deepen your understanding of emotions in conversations. Building on this foundation will enhance your personal connections.';
                recommendations = 'Practice recognizing emotions in others â€¢ Study emotional intelligence techniques â€¢ Ask more feeling-based questions';
                personalImpact = 'Enhanced emotional intelligence will improve relationship quality and mutual understanding';
              } else {
                interpretation = 'Developing stronger emotional intelligence is crucial for building deeper, more meaningful personal relationships.';
                recommendations = 'Focus on emotional awareness training â€¢ Practice empathy daily â€¢ Learn to identify and validate emotions in others';
                personalImpact = 'Improved emotional intelligence is essential for authentic personal connections and trust';
              }
            } else if (criterion.label === "Authenticity") {
              if (ratingClass === 'excellent') {
                interpretation = 'Your communication is genuinely authentic, reflecting your true values and personality. This creates trust and allows others to connect with the real you.';
                recommendations = 'Continue being yourself in all conversations â€¢ Share your authentic approach with others â€¢ Use as foundation for deeper relationships';
                personalImpact = 'Authentic communication builds genuine trust and attracts meaningful relationships';
              } else if (ratingClass === 'good') {
                interpretation = 'Your communication shows good authenticity with opportunity to be more genuinely yourself in conversations.';
                recommendations = 'Practice sharing your true thoughts and feelings â€¢ Be more vulnerable about your experiences â€¢ Focus on expressing your genuine values';
                personalImpact = 'Enhanced authenticity will create deeper connections and stronger trust';
              } else {
                interpretation = 'Developing more authentic communication is essential for building genuine personal relationships and trust.';
                recommendations = 'Practice being more genuine in conversations â€¢ Share your real thoughts and feelings â€¢ Focus on expressing who you truly are';
                personalImpact = 'Authentic communication is fundamental to meaningful personal connections';
              }
            } else if (criterion.label === "Vulnerability") {
              if (ratingClass === 'excellent') {
                interpretation = 'You excel at being appropriately vulnerable in conversations, sharing personal experiences and feelings. This creates deep connection and encourages others to open up.';
                recommendations = 'Continue sharing your authentic experiences â€¢ Model vulnerability for others â€¢ Use as foundation for deeper intimacy';
                personalImpact = 'Appropriate vulnerability builds deep trust and creates meaningful emotional connections';
              } else if (ratingClass === 'good') {
                interpretation = 'You show good willingness to be vulnerable with opportunity to share more personal experiences and feelings.';
                recommendations = 'Practice sharing more personal stories â€¢ Be more open about your struggles â€¢ Take emotional risks in safe relationships';
                personalImpact = 'Enhanced vulnerability will create deeper bonds and more meaningful relationships';
              } else {
                interpretation = 'Developing greater vulnerability is essential for building intimate, trusting personal relationships.';
                recommendations = 'Practice sharing personal experiences â€¢ Learn to express emotions openly â€¢ Start with safe people and gradually expand';
                personalImpact = 'Vulnerability is crucial for deep personal connections and emotional intimacy';
              }
            } else if (criterion.label === "Connection Building") {
              if (ratingClass === 'excellent') {
                interpretation = 'You excel at actively building connections and rapport with others. Your focus on relationship-building creates strong, lasting bonds.';
                recommendations = 'Continue prioritizing connection in all interactions â€¢ Teach others your connection-building techniques â€¢ Use as foundation for community building';
                personalImpact = 'Strong connection-building skills create lasting relationships and supportive networks';
              } else if (ratingClass === 'good') {
                interpretation = 'You demonstrate good connection-building instincts with opportunity to be more intentional about building rapport.';
                recommendations = 'Practice active listening techniques â€¢ Ask more personal questions â€¢ Focus on finding common ground';
                personalImpact = 'Enhanced connection-building will strengthen your relationships and expand your support network';
              } else {
                interpretation = 'Developing stronger connection-building skills is essential for creating meaningful personal relationships.';
                recommendations = 'Learn rapport-building techniques â€¢ Practice showing genuine interest in others â€¢ Focus on creating shared experiences';
                personalImpact = 'Connection-building is fundamental to developing strong personal relationships and community';
              }
            } else {
              // Default for other criteria
              interpretation = `Your ${criterion.label.toLowerCase()} demonstrates ${ratingClass} performance with strategic opportunities for enhanced professional impact.`;
              recommendations = 'Continue developing this skill area â€¢ Seek targeted feedback â€¢ Practice in varied contexts';
              personalImpact = `Improved ${criterion.label.toLowerCase()} will enhance your overall leadership effectiveness`;
            }

            cardsHtml += `
              <div class="insight-card-modern assessment">
                <div class="insight-header-modern">
                  <div class="insight-icon-modern assessment">
                    <i data-lucide="${criterion.icon}"></i>
                  </div>
                  <h4 class="insight-title-modern">${criterion.label}</h4>
                </div>
                <div class="insight-content-modern">
                  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <div style="font-size: 1.2rem; font-weight: 700; color: var(--primary);">Assessment Level</div>
                    <div class="assessment-rating-modern ${ratingClass}">${ratingText}</div>
                  </div>
                  
                  <div style="margin-bottom: 1rem;">
                    <div style="font-weight: 600; margin-bottom: 0.5rem;">Current Performance:</div>
                    <div style="font-size: 0.9rem; line-height: 1.5; color: var(--gray-700);">${assessment}</div>
                  </div>
                  
                  <div style="margin-bottom: 1rem;">
                    <div style="font-weight: 600; margin-bottom: 0.5rem;">Analysis:</div>
                    <div style="font-size: 0.9rem; line-height: 1.5;">${interpretation}</div>
                  </div>
                  
                  <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                    <div style="font-weight: 600; margin-bottom: 0.5rem;">Development Actions:</div>
                    <div style="font-size: 0.9rem; line-height: 1.4;">${recommendations.split(' â€¢ ').map(rec => `â€¢ ${rec}`).join('<br>')}</div>
                  </div>
                  
                  <div style="margin-top: 1rem;">
                    <div style="font-weight: 600; margin-bottom: 0.5rem;">Professional Impact:</div>
                    <div style="font-size: 0.9rem; color: var(--gray-700); font-style: italic;">${personalImpact}</div>
                  </div>
                </div>
              </div>
            `;
          }
        });
        
        // If no structured criteria found, try to extract line-by-line format
        if (!foundCriteria) {
          const lines = qualText.split('\n').filter(line => line.trim());
          
          lines.forEach((line, index) => {
            const cleanLine = line.replace(/^[â€¢\-]\s*/, '').trim();
            if (cleanLine.length > 15 && cleanLine.includes(':')) {
              const parts = cleanLine.split(':');
              const category = parts[0].trim();
              const assessment = parts.slice(1).join(':').trim();
              
              if (category && assessment) {
                foundCriteria = true;
                const ratingClass = getRatingClass(assessment);
                const ratingText = ratingClass.charAt(0).toUpperCase() + ratingClass.slice(1);
                
                // Default interpretation for generic criteria
                const interpretation = `Your ${category.toLowerCase()} demonstrates ${ratingClass} performance with opportunities for strategic development and enhanced professional impact.`;
                const recommendations = 'Continue developing this area â€¢ Seek specific feedback from colleagues â€¢ Practice targeted improvements';
                const personalImpact = `Improved ${category.toLowerCase()} will enhance your overall communication effectiveness and leadership presence`;

                cardsHtml += `
                  <div class="insight-card-modern assessment">
                    <div class="insight-header-modern">
                      <div class="insight-icon-modern assessment">
                        <i data-lucide="message-circle"></i>
                      </div>
                      <h4 class="insight-title-modern">${category}</h4>
                    </div>
                    <div class="insight-content-modern">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <div style="font-size: 1.2rem; font-weight: 700; color: var(--primary);">Assessment Level</div>
                        <div class="assessment-rating-modern ${ratingClass}">${ratingText}</div>
                      </div>
                      
                      <div style="margin-bottom: 1rem;">
                        <div style="font-weight: 600; margin-bottom: 0.5rem;">Current Performance:</div>
                        <div style="font-size: 0.9rem; line-height: 1.5; color: var(--gray-700);">${assessment}</div>
                      </div>
                      
                      <div style="margin-bottom: 1rem;">
                        <div style="font-weight: 600; margin-bottom: 0.5rem;">Analysis:</div>
                        <div style="font-size: 0.9rem; line-height: 1.5;">${interpretation}</div>
                      </div>
                      
                      <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                        <div style="font-weight: 600; margin-bottom: 0.5rem;">Development Actions:</div>
                        <div style="font-size: 0.9rem; line-height: 1.4;">${recommendations.split(' â€¢ ').map(rec => `â€¢ ${rec}`).join('<br>')}</div>
                      </div>
                      
                      <div style="margin-top: 1rem;">
                        <div style="font-weight: 600; margin-bottom: 0.5rem;">Professional Impact:</div>
                        <div style="font-size: 0.9rem; color: var(--gray-700); font-style: italic;">${personalImpact}</div>
                      </div>
                    </div>
                  </div>
                `;
              }
            }
          });
        }
        
        // If still no structured categories found, show as general assessment
        if (!foundCriteria) {
          const interpretation = 'This provides a comprehensive qualitative assessment of your communication performance with specific insights into your professional effectiveness.';
          const recommendations = 'Review the specific feedback carefully â€¢ Identify 2-3 key areas for development â€¢ Create an action plan for improvement';
          const personalImpact = 'Implementing these qualitative insights will enhance your overall communication effectiveness and leadership presence';

          cardsHtml = `
            <div class="insight-card-modern assessment">
              <div class="insight-header-modern">
                <div class="insight-icon-modern assessment">
                  <i data-lucide="clipboard-list"></i>
                </div>
                <h4 class="insight-title-modern">Communication Assessment</h4>
              </div>
              <div class="insight-content-modern">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                  <div style="font-size: 1.2rem; font-weight: 700; color: var(--primary);">Assessment Level</div>
                  <div class="assessment-rating-modern average">Analysis</div>
                </div>
                
                <div style="margin-bottom: 1rem;">
                  <div style="font-weight: 600; margin-bottom: 0.5rem;">Current Performance:</div>
                  <div style="font-size: 0.9rem; line-height: 1.5; color: var(--gray-700);">${qualText.trim()}</div>
                </div>
                
                <div style="margin-bottom: 1rem;">
                  <div style="font-weight: 600; margin-bottom: 0.5rem;">Analysis:</div>
                  <div style="font-size: 0.9rem; line-height: 1.5;">${interpretation}</div>
                </div>
                
                <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                  <div style="font-weight: 600; margin-bottom: 0.5rem;">Development Actions:</div>
                  <div style="font-size: 0.9rem; line-height: 1.4;">${recommendations.split(' â€¢ ').map(rec => `â€¢ ${rec}`).join('<br>')}</div>
                </div>
                
                <div style="margin-top: 1rem;">
                  <div style="font-weight: 600; margin-bottom: 0.5rem;">Professional Impact:</div>
                  <div style="font-size: 0.9rem; color: var(--gray-700); font-style: italic;">${personalImpact}</div>
                </div>
              </div>
            </div>
          `;
        }
        
        return `<div class="qualitative-grid">${cardsHtml}</div>`;
      }
      
      // Copy functions
      function copyTranscript() {
        const transcriptElement = document.getElementById('transcriptContent');
        const text = transcriptElement.textContent || transcriptElement.innerText;
        
        navigator.clipboard.writeText(text).then(() => {
          // Show success feedback
          const btn = event.target.closest('.copy-btn');
          const originalText = btn.innerHTML;
          btn.innerHTML = '<i data-lucide="check"></i> Copied!';
          
          setTimeout(() => {
            btn.innerHTML = originalText;
            lucide.createIcons();
          }, 2000);
        }).catch(err => {
          console.error('Failed to copy: ', err);
        });
      }
      
      function copyAnalysis() {
        const analysisElement = document.getElementById('detailedAnalysisContent');
        const text = analysisElement.textContent || analysisElement.innerText;
        
        navigator.clipboard.writeText(text).then(() => {
          // Show success feedback
          const btn = event.target.closest('.copy-btn');
          const originalText = btn.innerHTML;
          btn.innerHTML = '<i data-lucide="check"></i> Copied!';
          
          setTimeout(() => {
            btn.innerHTML = originalText;
            lucide.createIcons();
          }, 2000);
        }).catch(err => {
          console.error('Failed to copy: ', err);
        });
      }
      
      function copyQuantitative() {
        const quantElement = document.getElementById('quantitativeContent');
        const text = quantElement.textContent || quantElement.innerText;
        
        navigator.clipboard.writeText(text).then(() => {
          const btn = event.target.closest('.copy-btn');
          const originalText = btn.innerHTML;
          btn.innerHTML = '<i data-lucide="check"></i> Copied!';
          
          setTimeout(() => {
            btn.innerHTML = originalText;
            lucide.createIcons();
          }, 2000);
        }).catch(err => {
          console.error('Failed to copy: ', err);
        });
      }
      
      function copyQualitative() {
        const qualElement = document.getElementById('qualitativeContent');
        const text = qualElement.textContent || qualElement.innerText;
        
        navigator.clipboard.writeText(text).then(() => {
          const btn = event.target.closest('.copy-btn');
          const originalText = btn.innerHTML;
          btn.innerHTML = '<i data-lucide="check"></i> Copied!';
          
          setTimeout(() => {
            btn.innerHTML = originalText;
            lucide.createIcons();
          }, 2000);
        }).catch(err => {
          console.error('Failed to copy: ', err);
        });
      }
      
      function startNewAnalysis() {
        window.location.href = 'index.html';
      }
      
      function shareResults() {
        if (navigator.share) {
          navigator.share({
            title: 'Communication Analysis Results',
            text: 'Check out my communication analysis results from Articulaition!',
            url: window.location.href
          });
        } else {
          // Fallback - copy URL to clipboard
          navigator.clipboard.writeText(window.location.href).then(() => {
            alert('Results link copied to clipboard!');
          });
        }
      }
      
      // Load and display analysis results
      document.addEventListener("DOMContentLoaded", function () {
        lucide.createIcons();
        initializeGeminiEngine();
        initializePage();
        initializeUnifiedTabSwitching();
        
        // Initialize score display with neutral loading state
        const scoreCircle = document.getElementById('scoreCircle');
        const scoreText = scoreCircle ? scoreCircle.textContent : '';
        
        // Only apply color if we have a valid numeric score
        if (scoreText && !isNaN(parseInt(scoreText))) {
          const defaultScore = parseInt(scoreText);
          updateScoreColor(defaultScore);
        } else {
          // Set neutral loading color for placeholder
          const circle = document.getElementById("scoreCircle");
          if (circle) {
            circle.style.background = "linear-gradient(135deg, #6b7280, #9ca3af)";
            circle.style.boxShadow = "0 10px 25px -3px rgba(107, 114, 128, 0.3), 0 4px 6px -2px rgba(107, 114, 128, 0.2)";
          }
        }
        
        loadAnalysisResults();
      });

      function initializeGeminiEngine() {
        try {
          geminiEngine = new GeminiAIEngine();
          console.log(
            "Gemini AI Engine initialized:",
            geminiEngine.isConfigured() ? "Configured" : "Not configured"
          );
        } catch (error) {
          console.warn("Gemini AI Engine not available:", error);
        }
      }

      // Personal Communication Type Routing - Redirect to dedicated pages
      function checkAndRedirectToSpecificPersonalPage() {
        const urlParams = new URLSearchParams(window.location.search);
        const communicationType = urlParams.get('type');
        
        if (communicationType) {
          console.log(`ðŸ”€ Detected personal communication type: ${communicationType}`);
          
          // Personal communication types - redirect to dedicated pages
          const personalRoutes = {
            'casual-conversation': 'casual-analysis-results.html',
            'deep-conversation': 'deep-analysis-results.html',
            'dating-conversation': 'dating-analysis-results.html',
            'conflict-resolution': 'conflict-analysis-results.html',
            'storytelling': 'storytelling-analysis-results.html'
          };
          
          if (personalRoutes[communicationType]) {
            const targetPage = personalRoutes[communicationType];
            console.log(`ðŸŽ¯ Redirecting to dedicated personal page: ${targetPage}`);
            
            // Preserve all URL parameters
            const newUrl = `${targetPage}${window.location.search}`;
            window.location.href = newUrl;
            return true; // Indicate redirect is happening
          }
        }
        
        return false; // No redirect needed
      }

      function initializePage() {
        // Check if we should redirect to a specific personal analysis page
        const isRedirecting = checkAndRedirectToSpecificPersonalPage();
        
        if (isRedirecting) {
          return; // Exit early if redirecting
        }
        
        // Get URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        analysisType = urlParams.get("type") || "presentation";
        analysisSource = urlParams.get("source") || "practice";

        // Update page title and badge based on analysis type
        updatePageTitle(analysisType);

        // Update communication criteria section
        updateCommunicationCriteria(analysisType);

      }

      function updatePageTitle(type) {
        const titles = {
          presentation: {
            badge: "Conference Presentation Analysis",
            title: "Presentation Analysis Results",
            subtitle: "Your presentation communication has been analyzed",
          },
          sales: {
            badge: "Sales Call Analysis",
            title: "Sales Communication Results",
            subtitle: "Your sales conversation has been analyzed",
          },
          leadership: {
            badge: "Leadership Communication Analysis",
            title: "Leadership Analysis Results",
            subtitle: "Your leadership communication has been analyzed",
          },
          negotiation: {
            badge: "Negotiation Analysis",
            title: "Negotiation Results",
            subtitle: "Your negotiation communication has been analyzed",
          },
          "client-calls": {
            badge: "Client Call Analysis",
            title: "Client Communication Results",
            subtitle: "Your client conversation has been analyzed",
          },
          "client": {
            badge: "Client Call Analysis",
            title: "Client Communication Results",
            subtitle: "Your client conversation has been analyzed",
          },
        };

        const config = titles[type] || titles["presentation"];

        // Safely update elements that exist
        const analysisTypeBadge = document.getElementById("analysisTypeBadge");
        if (analysisTypeBadge) {
          analysisTypeBadge.textContent = config.badge;
        }

        const resultsTitle = document.getElementById("resultsTitle");
        if (resultsTitle) {
          resultsTitle.textContent = config.title;
        }

        const resultsSubtitle = document.getElementById("resultsSubtitle");
        if (resultsSubtitle) {
          resultsSubtitle.textContent = config.subtitle;
        }

        // Note: communicationType element doesn't exist in the HTML, so removing this line
        // document.getElementById("communicationType").textContent = config.badge;
      }

      async function loadAnalysisResults() {
        console.log("ðŸ” Loading analysis results...");

        // DEBUG: Check what's actually in sessionStorage
        console.log("ðŸ” === SESSION STORAGE DEBUG ===");
        console.log("ðŸ” All sessionStorage keys:", Object.keys(sessionStorage));
        console.log(
          "ðŸ” sessionStorage.audioForAnalysis:",
          sessionStorage.getItem("audioForAnalysis")
        );
        console.log(
          "ðŸ” sessionStorage.analysisResults:",
          sessionStorage.getItem("analysisResults")
        );
        console.log("ðŸ” sessionStorage length:", sessionStorage.length);

        // List all sessionStorage items
        for (let i = 0; i < sessionStorage.length; i++) {
          const key = sessionStorage.key(i);
          const value = sessionStorage.getItem(key);
          console.log(
            `ðŸ” sessionStorage[${key}]:`,
            value ? value.substring(0, 100) + "..." : "null"
          );
        }

        // Check if we already have final results loaded
        if (window.finalAnalysisResults) {
          console.log("âœ… Final results already loaded - using them");
          displayResults(window.finalAnalysisResults);
          return;
        }

        // Check if we have audio data to transcribe
        const audioData = sessionStorage.getItem("audioForAnalysis");

        if (audioData) {
          console.log("ðŸŽ¤ Found audio data - will transcribe here!");
          await processAudioForTranscription(audioData);
          return;
        }

        // Try multiple storage approaches for existing results
        let resultsData = sessionStorage.getItem("analysisResults");
        let dataSource = "primary";

        if (!resultsData) {
          console.log("ðŸ”„ Trying backup storage...");
          resultsData = sessionStorage.getItem("analysisResults_backup");
          dataSource = "backup";
        }

        // Also try to get transcript separately as ultimate backup
        const transcriptOnly = sessionStorage.getItem("transcript_only");
        console.log("ðŸ” Found transcript-only backup:", transcriptOnly);

        if (resultsData) {
          try {
            analysisResults = JSON.parse(resultsData);
            console.log(
              `âœ… Found stored results from ${dataSource}:`,
              analysisResults
            );
            console.log(
              "ðŸ” Transcript in stored results:",
              analysisResults.transcript
            );
            
            // Store as final results to prevent demo override
            window.finalAnalysisResults = analysisResults;
            displayResults(analysisResults);
            return;
          } catch (error) {
            console.error("âŒ Error parsing stored results:", error);
          }
        }
        
        // If no data found, show demo
        console.log("âš ï¸ No analysis data found - showing demo");
        displayDemoResults();
      }
      
      // Main display function - comprehensive version moved below
      
      function displayTranscript(transcript) {
        const transcriptContent = document.getElementById('transcriptContent');
        
        if (!transcript) {
          transcriptContent.innerHTML = `
            <div class="transcript-text">
              <p><em>No transcript available</em></p>
            </div>
          `;
          return;
        }
        
        transcriptContent.innerHTML = `
          <div class="transcript-timestamp">
            Recorded: ${new Date().toLocaleString()}
          </div>
          <div class="transcript-text">
            ${transcript}
          </div>
        `;
      }
      
      function displayDetailedAnalysis(analysis) {
        const detailedContent = document.getElementById('detailedAnalysisContent');
        
        if (!analysis) {
          detailedContent.innerHTML = '<p>No detailed analysis available</p>';
          return;
        }
        
        const cardsHtml = formatAnalysisIntoCards(analysis);
        detailedContent.innerHTML = cardsHtml;
      }
      
      function displayQuantitativeAnalysis(analysis) {
        const quantContent = document.getElementById('quantitativeContent');
        
        if (!analysis) {
          quantContent.innerHTML = '<p>No quantitative analysis available</p>';
          return;
        }
        
        const metricsHtml = parseQuantitativeAnalysis(analysis);
        quantContent.innerHTML = metricsHtml;
      }
      
      function displayQualitativeAnalysis(analysis) {
        const qualContent = document.getElementById('qualitativeContent');
        
        if (!analysis) {
          qualContent.innerHTML = '<p>No qualitative analysis available</p>';
          return;
        }
        
        const categoriesHtml = parseQualitativeAnalysis(analysis);
        qualContent.innerHTML = categoriesHtml;
      }
      
      function displayScore(score) {
        // Update the top score section
        const scoreCircle = document.getElementById('scoreCircle');
        if (scoreCircle) {
          scoreCircle.textContent = score;
        }
        
        const scoreText = document.getElementById('scoreText');
        if (scoreText) {
          scoreText.textContent = `${score}/100`;
          
          // Color the score text based on performance level
          if (score >= 80) {
            scoreText.style.color = '#166534'; // Green for good scores
          } else if (score >= 60) {
            scoreText.style.color = '#1e40af'; // Blue for average scores
          } else if (score >= 40) {
            scoreText.style.color = '#a16207'; // Orange for below average
          } else {
            scoreText.style.color = '#dc2626'; // Red for poor scores
          }
          
          // Add emphasis styling for very low scores
          if (score < 30) {
            scoreText.style.fontSize = '2.8rem';
            scoreText.style.fontWeight = '900';
            scoreText.style.textShadow = '0 2px 4px rgba(220, 38, 38, 0.3)';
          }
        }
        
        // Update score description based on score with dynamic styling
        const scoreDescription = document.querySelector('.score-description');
        if (scoreDescription) {
          if (score >= 90) {
            scoreDescription.textContent = "Outstanding Performance";
            scoreDescription.style.background = "linear-gradient(135deg, #ecfdf5, #d1fae5)";
            scoreDescription.style.borderColor = "#a7f3d0";
            scoreDescription.style.color = "#065f46";
          } else if (score >= 80) {
            scoreDescription.textContent = "Excellent Performance";
            scoreDescription.style.background = "linear-gradient(135deg, #f0fdf4, #dcfce7)";
            scoreDescription.style.borderColor = "#bbf7d0";
            scoreDescription.style.color = "#166534";
          } else if (score >= 70) {
            scoreDescription.textContent = "Good Performance";
            scoreDescription.style.background = "linear-gradient(135deg, #eff6ff, #dbeafe)";
            scoreDescription.style.borderColor = "#93c5fd";
            scoreDescription.style.color = "#1e40af";
          } else if (score >= 60) {
            scoreDescription.textContent = "Developing Performance";
            scoreDescription.style.background = "linear-gradient(135deg, #fefce8, #fef3c7)";
            scoreDescription.style.borderColor = "#fde047";
            scoreDescription.style.color = "#a16207";
          } else if (score >= 40) {
            scoreDescription.textContent = "Below Average Performance";
            scoreDescription.style.background = "linear-gradient(135deg, #fef2f2, #fee2e2)";
            scoreDescription.style.borderColor = "#fecaca";
            scoreDescription.style.color = "#dc2626";
          } else if (score >= 20) {
            scoreDescription.textContent = "Poor Performance";
            scoreDescription.style.background = "linear-gradient(135deg, #fef2f2, #fee2e2)";
            scoreDescription.style.borderColor = "#fecaca";
            scoreDescription.style.color = "#dc2626";
            scoreDescription.style.fontWeight = "600";
          } else {
            scoreDescription.textContent = "Critical Performance Issues";
            scoreDescription.style.background = "linear-gradient(135deg, #fef2f2, #fee2e2)";
            scoreDescription.style.borderColor = "#f87171";
            scoreDescription.style.color = "#dc2626";
            scoreDescription.style.fontWeight = "700";
            scoreDescription.style.fontSize = "1.1rem";
            scoreDescription.style.border = "2px solid #f87171";
          }
        }
      }
      
      function displayDemoResults() {
        console.log("ðŸ“º Displaying demo results");
        
        const demoResults = {
          transcript: "This is a sample communication analysis. In this demonstration, I'll walk you through the key findings from your communication assessment. The analysis covers various aspects including vocal delivery, content structure, and overall effectiveness.",
          analysis: "**Communication Strengths:**\n\nâ€¢ Clear vocal delivery with appropriate pacing\nâ€¢ Strong opening that captures attention\nâ€¢ Good use of structured content organization\n\n**Growth Opportunities:**\n\nâ€¢ Consider adding more specific examples to illustrate key points\nâ€¢ Opportunity to increase vocal variety for enhanced engagement\nâ€¢ Could benefit from stronger conclusion with clear call-to-action",
          score: 85,
          timestamp: new Date().toISOString(),
          note: "Demo analysis for testing purposes"
        };
        
        displayResults(demoResults);
      }
      
      function updateCommunicationCriteria(type) {
        // This function can be expanded to show different criteria based on communication type
        console.log("Updated criteria for:", type);
      }

      function displayResults(results) {
        console.log("ðŸŽ¨ Displaying results:", results);
        console.log("ðŸ” Raw results object:", JSON.stringify(results, null, 2));

        // Check if this is new personal communication analysis format
        if (results.quantitativeScores && results.qualitativeScores) {
          console.log("âœ… Detected new personal communication analysis format");
          displayPersonalCommunicationResults(results);
          return;
        }

        // Update score with enterprise breakdown
        if (results.score) {
          const scoreCircle = document.getElementById("scoreCircle");
          if (scoreCircle) {
            scoreCircle.textContent = results.score;
          }

          const scoreText = document.getElementById("scoreText");
          if (scoreText) {
            scoreText.textContent = `${results.score}/100`;
            
            // Color the score text based on performance level
            if (results.score >= 80) {
              scoreText.style.color = '#166534'; // Green for good scores
            } else if (results.score >= 60) {
              scoreText.style.color = '#1e40af'; // Blue for average scores
            } else if (results.score >= 40) {
              scoreText.style.color = '#a16207'; // Orange for below average
            } else {
              scoreText.style.color = '#dc2626'; // Red for poor scores
            }
            
            // Add emphasis styling for very low scores
            if (results.score < 30) {
              scoreText.style.fontSize = '2.8rem';
              scoreText.style.fontWeight = '900';
              scoreText.style.textShadow = '0 2px 4px rgba(220, 38, 38, 0.3)';
            }
          }

          updateScoreColor(results.score);
          
        }

        // FORCE TRANSCRIPT DISPLAY - Try multiple approaches
        console.log("ðŸ” === TRANSCRIPT DEBUG ===");
        console.log("ðŸ” results.transcript:", results.transcript);
        console.log("ðŸ” typeof results.transcript:", typeof results.transcript);
        console.log(
          "ðŸ” results.transcript length:",
          results.transcript ? results.transcript.length : "N/A"
        );

        const transcriptElement = document.getElementById("transcriptContent");
        console.log("ðŸ” Transcript element found:", !!transcriptElement);
        console.log(
          "ðŸ” Transcript element HTML before:",
          transcriptElement ? transcriptElement.innerHTML : "ELEMENT NOT FOUND"
        );

        // Try to extract transcript from multiple possible locations
        let transcript = null;

        if (
          results.transcript &&
          typeof results.transcript === "string" &&
          results.transcript.trim().length > 0
        ) {
          transcript = results.transcript;
          console.log("âœ… Found transcript in results.transcript");
        } else if (results.data && results.data.transcript) {
          transcript = results.data.transcript;
          console.log("âœ… Found transcript in results.data.transcript");
        } else if (results.response && results.response.transcript) {
          transcript = results.response.transcript;
          console.log("âœ… Found transcript in results.response.transcript");
        }

        console.log("ðŸ” Final transcript to display:", transcript);
        console.log(
          "ðŸ” Transcript length:",
          transcript ? transcript.length : "NULL"
        );

        if (transcript && transcript.trim().length > 0) {
          console.log("ðŸš€ DISPLAYING TRANSCRIPT:", transcript);

          // Display transcript with clean styling
          transcriptElement.innerHTML = `
            <div class="transcript-timestamp">
              <span>${new Date().toLocaleTimeString()}</span>
            </div>
            <div class="transcript-text">
              ${transcript}
            </div>
          `;

          console.log("âœ… TRANSCRIPT DISPLAY COMPLETE");
          console.log(
            "ðŸ” Transcript element HTML after:",
            transcriptElement.innerHTML
          );

          // Scroll to it
          setTimeout(() => {
            transcriptElement.scrollIntoView({
              behavior: "smooth",
              block: "center",
            });
          }, 100);
        } else {
          console.log("âŒ NO TRANSCRIPT FOUND - SHOWING PLACEHOLDER");
          showTranscriptPlaceholder();
        }
        
        // Reinitialize Lucide icons for the new transcript content
        if (typeof lucide !== 'undefined' && lucide.createIcons) {
          lucide.createIcons();
        }

        // Handle personal communication analysis structure
        if (results.quantitativeScores && results.qualitativeScores) {
          console.log("âœ… Found personal communication analysis structure");
          displayPersonalCommunicationResults(results);
        } else if (results.analysis && results.analysis.length > 10) {
          console.log("âœ… Using comprehensive analysis parsing");
          parseAndDistributeAnalysis(results.analysis, results);
        } else {
          console.log("âš ï¸ No comprehensive analysis found, checking for separate sections");
          // Check for separate quantitative/qualitative sections
          if (results.quantitative) {
            console.log("âœ… Found separate quantitative section");
            displayQuantitativeAnalysis(results.quantitative);
          } else {
            console.log("âŒ No quantitative data - showing personal placeholder");
            document.getElementById('quantitativeContent').innerHTML = `
              <div class="metrics-list">
                <div style="padding: 20px; text-align: center; background: #f8fafc; border-radius: 8px;">
                  <h4 style="color: #4f46e5; margin-bottom: 10px;">Personal Communication Analysis</h4>
                  <p style="color: #6b7280; margin: 0;">Quantitative metrics will appear here when analysis is complete.</p>
                </div>
              </div>
            `;
          }

          if (results.qualitative) {
            console.log("âœ… Found separate qualitative section");
            displayQualitativeAnalysis(results.qualitative);
          } else {
            console.log("âŒ No qualitative data - showing personal placeholder");
            document.getElementById('qualitativeContent').innerHTML = `
              <div class="categories-list">
                <div style="padding: 20px; text-align: center; background: #f8fafc; border-radius: 8px;">
                  <h4 style="color: #4f46e5; margin-bottom: 10px;">Personal Communication Assessment</h4>
                  <p style="color: #6b7280; margin: 0;">Qualitative assessment will appear here when analysis is complete.</p>
                </div>
              </div>
            `;
          }
        }

        // Update situation analysis with dynamic content
        
        // Initialize Lucide icons after all content is loaded
        setTimeout(() => {
          if (typeof lucide !== 'undefined') {
            lucide.createIcons();
          }
        }, 100);
      }

      function getAnalysisType() {
        // Get analysis type from URL parameters or default to presentation
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get("type") || "presentation";
      }

      function getCommunicationCriteria(analysisType) {
        const criteria = {
          presentation: {
            title: "What Makes a Great Conference Presentation",
            subtitle: "Conference presentation breakdown and insights",
            items: [
              { key: "Clear Opening Hook", desc: "Compelling start that grabs audience attention" },
              { key: "Structured Content", desc: "Logical flow with clear transitions between points" },
              { key: "Engaging Delivery", desc: "Confident voice, appropriate pacing, and vocal variety" },
              { key: "Audience Connection", desc: "Eye contact, interaction, and relatable examples" },
              { key: "Strong Conclusion", desc: "Memorable closing with clear takeaways" },
              { key: "Time Management", desc: "Respects allocated time and allows for Q&A" }
            ]
          },
          sales: {
            title: "What Makes Effective Sales Communication",
            subtitle: "Sales conversation breakdown and insights",
            items: [
              { key: "Rapport Building", desc: "Establish trust and connection with prospects" },
              { key: "Active Listening", desc: "Understanding client needs and concerns" },
              { key: "Value Proposition", desc: "Clear articulation of benefits and solutions" },
              { key: "Objection Handling", desc: "Professional responses to concerns and hesitations" },
              { key: "Closing Techniques", desc: "Confident and appropriate call-to-action" },
              { key: "Follow-up Strategy", desc: "Next steps and maintaining engagement" }
            ]
          },
          leadership: {
            title: "What Makes Strong Leadership Communication",
            subtitle: "Leadership communication breakdown and insights",
            description: "Strong leadership communication is built upon six fundamental pillars that distinguish effective leaders from their peers. At its core, vision clarity ensures that leaders can articulate goals and direction with precision, creating a shared understanding of organizational objectives. This foundation is enhanced by inspiring delivery, where leaders employ a motivational tone that actively engages team members and fosters commitment to collective success. Equally important is the practice of active listening, which enables leaders to understand and meaningfully address team concerns, building trust and demonstrating respect for diverse perspectives. Decisive communication further strengthens leadership effectiveness by conveying confident decision-making and providing clear direction, eliminating ambiguity and empowering teams to act with purpose. The human element of leadership is captured through empathy and support, where leaders acknowledge team perspectives and challenges, creating an environment of psychological safety and mutual respect. Finally, action orientation ensures that communication translates into tangible outcomes through clear next steps and well-defined accountability measures, transforming vision into measurable results."
          },
          negotiation: {
            title: "What Makes Successful Negotiation Communication",
            subtitle: "Negotiation strategy breakdown and insights",
            items: [
              { key: "Preparation & Research", desc: "Understanding all parties' positions and interests" },
              { key: "Strategic Questioning", desc: "Probing questions to uncover underlying needs" },
              { key: "Win-Win Framing", desc: "Collaborative language that builds mutual benefit" },
              { key: "Pressure Management", desc: "Staying calm and composed under pressure" },
              { key: "Concession Strategy", desc: "Strategic give-and-take to reach agreements" },
              { key: "Relationship Building", desc: "Maintaining positive long-term relationships" }
            ]
          },
          "client-calls": {
            title: "What Makes Effective Client Communication",
            subtitle: "Client call conversation breakdown and insights",
            items: [
              { key: "Relationship Building", desc: "Establish trust and rapport with clients and partners" },
              { key: "Active Listening", desc: "Understanding client needs and concerns through engagement" },
              { key: "Strategic Insight", desc: "Providing valuable guidance and strategic recommendations" },
              { key: "Professional Delivery", desc: "Maintaining appropriate tone and communication style" },
              { key: "Trust Building", desc: "Creating confidence through expertise and reliability" },
              { key: "Client Focus", desc: "Keeping client interests and objectives at the center" }
            ]
          },
          "client": {
            title: "What Makes Effective Client Communication",
            subtitle: "Client call conversation breakdown and insights",
            items: [
              { key: "Relationship Building", desc: "Establish trust and rapport with clients and partners" },
              { key: "Active Listening", desc: "Understanding client needs and concerns through engagement" },
              { key: "Strategic Insight", desc: "Providing valuable guidance and strategic recommendations" },
              { key: "Professional Delivery", desc: "Maintaining appropriate tone and communication style" },
              { key: "Trust Building", desc: "Creating confidence through expertise and reliability" },
              { key: "Client Focus", desc: "Keeping client interests and objectives at the center" }
            ]
          }
        };

        return criteria[analysisType] || criteria.presentation;
      }

      function updateCommunicationCriteria(analysisType) {
        const criteriaConfig = getCommunicationCriteria(analysisType);
        
        // Update subtitle
        const subtitleElement = document.getElementById("situationSubtitle");
        if (subtitleElement) {
          subtitleElement.textContent = criteriaConfig.subtitle;
        }
        
        // Update title
        const titleElement = document.getElementById("criteriaTitle");
        if (titleElement) {
          titleElement.textContent = criteriaConfig.title;
        }

        // Update criteria list
        const listElement = document.getElementById("criteriaList");
        if (listElement) {
          if (criteriaConfig.description) {
            // For leadership, show enhanced paragraph description
            listElement.innerHTML = `
              <div style="background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); border-radius: 16px; padding: 2rem; border-left: 4px solid #3b82f6; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);">
                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 1.5rem;">
                  <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #3b82f6, #1d4ed8); border-radius: 12px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 8px rgba(59, 130, 246, 0.3);">
                    <span style="color: white; font-size: 24px;">ðŸŽ¯</span>
                  </div>
                  <div>
                    <h4 style="margin: 0; font-size: 1.2rem; font-weight: 700; color: #1e293b;">Six Pillars of Leadership Excellence</h4>
                    <p style="margin: 0; font-size: 0.9rem; color: #64748b;">Core competencies that distinguish exceptional leaders</p>
                  </div>
                </div>
                <div style="line-height: 1.7; color: #374151; font-size: 1rem;">
                  Strong leadership communication is built upon six fundamental pillars that distinguish effective leaders from their peers. At its core, vision clarity ensures that leaders can articulate goals and direction with precision, creating a shared understanding of organizational objectives. 
                  <br><br>
                  This foundation is enhanced by inspiring delivery, where leaders employ a motivational tone that actively engages team members and fosters commitment to collective success. Equally important is the practice of active listening, which enables leaders to understand and meaningfully address team concerns, building trust and demonstrating respect for diverse perspectives.
                  <br><br>
                  Decisive communication further strengthens leadership effectiveness by conveying confident decision-making and providing clear direction, eliminating ambiguity and empowering teams to act with purpose. The human element of leadership is captured through empathy and support, where leaders acknowledge team perspectives and challenges, creating an environment of psychological safety and mutual respect.
                  <br><br>
                  Finally, action orientation ensures that communication translates into tangible outcomes through clear next steps and well-defined accountability measures, transforming vision into measurable results.
                </div>
              </div>
            `;
          } else if (criteriaConfig.items) {
            // For other types, show bullet points
            listElement.innerHTML = criteriaConfig.items.map(item => 
              `<li><strong>${item.key}:</strong> ${item.desc}</li>`
            ).join('');
          }
        }
      }

      function parseAndDistributeAnalysis(analysisText, results) {
        console.log("ðŸ” Parsing comprehensive analysis:", analysisText);
        
        if (!analysisText) return;
        
        // Clear loading states
        const loadingStates = document.querySelectorAll('.loading-state');
        loadingStates.forEach(state => state.style.display = 'none');
        
        // Format for detailed analysis section (Insights tab)
        const detailedContent = document.getElementById('detailedAnalysisContent');
        if (detailedContent) {
          // Extract strengths and growth areas
          const analysisCards = formatAnalysisIntoCards(analysisText);
          detailedContent.innerHTML = analysisCards;
        }
        
        // Parse and display quantitative analysis
        const quantContent = document.getElementById('quantitativeContent');
        if (quantContent) {
          console.log("ðŸ” About to parse quantitative from:", analysisText.substring(0, 200));
          const quantHtml = parseQuantitativeAnalysis(analysisText);
          quantContent.innerHTML = quantHtml;
        }
        
        // Parse and display qualitative analysis  
        const qualContent = document.getElementById('qualitativeContent');
        if (qualContent) {
          console.log("ðŸ” About to parse qualitative from:", analysisText.substring(0, 200));
          const qualHtml = parseQualitativeAnalysis(analysisText);
          qualContent.innerHTML = qualHtml;
        }
        
        // Update score if available
        if (results.score) {
          const scoreElement = document.getElementById('scoreCircle');
          if (scoreElement) {
            scoreElement.textContent = results.score;
          }
          
          const scoreText = document.getElementById('scoreText');
          if (scoreText) {
            scoreText.textContent = `${results.score}/100`;
            
            // Color the score text based on performance level
            if (results.score >= 80) {
              scoreText.style.color = '#166534'; // Green for good scores
            } else if (results.score >= 60) {
              scoreText.style.color = '#1e40af'; // Blue for average scores
            } else if (results.score >= 40) {
              scoreText.style.color = '#a16207'; // Orange for below average
            } else {
              scoreText.style.color = '#dc2626'; // Red for poor scores
            }
            
            // Add emphasis styling for very low scores
            if (results.score < 30) {
              scoreText.style.fontSize = '2.8rem';
              scoreText.style.fontWeight = '900';
              scoreText.style.textShadow = '0 2px 4px rgba(220, 38, 38, 0.3)';
            }
          }
        }
        
        lucide.createIcons();
      }

      function parseAnalysisSections(analysisText) {
        const sections = {
          quantitative: null,
          qualitative: null,
          detailed: null,
          overall: null
        };
        
        // Look for quantitative metrics section
        const quantitativeMatch = analysisText.match(/QUANTITATIVE[\s\S]*?(?=QUALITATIVE|DETAILED ANALYSIS|$)/i);
        if (quantitativeMatch) {
          sections.quantitative = quantitativeMatch[0];
        }
        
        // Look for qualitative metrics section  
        const qualitativeMatch = analysisText.match(/QUALITATIVE[\s\S]*?(?=DETAILED ANALYSIS|ACTIONABLE FEEDBACK|$)/i);
        if (qualitativeMatch) {
          sections.qualitative = qualitativeMatch[0];
        }
        
        // Look for detailed analysis section (everything after DETAILED ANALYSIS:)
        const detailedMatch = analysisText.match(/DETAILED ANALYSIS:[\s\S]*/i);
        if (detailedMatch) {
          sections.detailed = detailedMatch[0];
        }
        
        // Look for overall assessment
        const overallMatch = analysisText.match(/OVERALL[\s\S]*?(?=QUANTITATIVE|QUALITATIVE|DETAILED ANALYSIS|$)/i);
        if (overallMatch) {
          sections.overall = overallMatch[0];
        }
        
        return sections;
      }

      function displayParsedQuantitativeMetrics(quantitativeText) {
        const content = document.getElementById("quantitativeContent");
        if (content) {
          const cleanText = quantitativeText.replace(/QUANTITATIVE[\s\S]*?:/i, '').trim();
          const formattedContent = formatQuantitativeAnalysis(cleanText);
          content.innerHTML = `<div class="analysis-content">${formattedContent}</div>`;
          
          // Re-initialize lucide icons for the new content
          setTimeout(() => {
            if (typeof lucide !== 'undefined') {
              lucide.createIcons();
            }
          }, 100);
        }
      }

      function displayParsedQualitativeMetrics(qualitativeText) {
        const content = document.getElementById("qualitativeContent");
        if (content) {
          const cleanText = qualitativeText.replace(/QUALITATIVE[\s\S]*?:/i, '').trim();
          const formattedContent = formatQualitativeAnalysis(cleanText);
          content.innerHTML = `<div class="analysis-content">${formattedContent}</div>`;
          
          // Re-initialize lucide icons for the new content
          setTimeout(() => {
            if (typeof lucide !== 'undefined') {
              lucide.createIcons();
            }
          }, 100);
        }
      }

      function displayDetailedAnalysis(detailedText, overallText) {
        const content = document.getElementById("detailedAnalysisContent");
        if (content) {
          const cleanText = detailedText.replace(/DETAILED ANALYSIS:/i, '').trim();
          
          // Extract overall communication effectiveness score
          const scoreMatch = detailedText.match(/OVERALL.*?EFFECTIVENESS.*?SCORE[:\s]*(\d+)(?:\/100|\s*out\s*of\s*100)/i) ||
                            detailedText.match(/COMMUNICATION.*?EFFECTIVENESS.*?SCORE[:\s]*(\d+)(?:\/100|\s*out\s*of\s*100)/i) ||
                            detailedText.match(/SCORE[:\s]*(\d+)(?:\/100|\s*out\s*of\s*100)/i);
          
          let scoreCard = '';
          if (scoreMatch) {
            const score = parseInt(scoreMatch[1]);
            const interpretation = getScoreInterpretation(score);
            scoreCard = `
              <div class="overall-score-card">
                <div class="score-value">${score}</div>
                <div class="score-label">Communication Effectiveness Score</div>
                <div class="score-interpretation">
                  <div class="score-interpretation-text">${interpretation}</div>
                </div>
              </div>
            `;
          }
          
          // Split into analysis and actionable feedback if present
          if (cleanText.includes('ACTIONABLE FEEDBACK:')) {
            const parts = cleanText.split('ACTIONABLE FEEDBACK:');
            const analysis = parts[0] || '';
            const feedback = parts[1] || '';
            
            content.innerHTML = `
              ${scoreCard}
              <div class="analysis-section">
                ${formatAnalysisContent(analysis)}
              </div>
              <div class="actionable-feedback">
                <h4 class="feedback-title">
                  <i data-lucide="lightbulb" style="width: 18px; height: 18px; margin-right: 8px;"></i>
                  Actionable Feedback
                </h4>
                <div class="feedback-content">
                  ${formatFeedbackList(feedback)}
                </div>
              </div>
            `;
          } else {
            content.innerHTML = `
              ${scoreCard}
              <div class="analysis-section">
                ${formatAnalysisContent(cleanText)}
              </div>
            `;
          }
          
          // Re-initialize lucide icons for the new content
          setTimeout(() => {
            if (typeof lucide !== 'undefined') {
              lucide.createIcons();
            }
          }, 100);
        }
      }

      // Get score interpretation text
      function getScoreInterpretation(score) {
        if (score >= 90) return "Exceptional communication effectiveness. You demonstrate mastery in key communication areas.";
        if (score >= 80) return "Strong communication skills with room for minor refinements.";
        if (score >= 70) return "Good communication foundation with several areas for focused improvement.";
        if (score >= 60) return "Developing communication skills. Concentrate on the key areas highlighted in the feedback.";
        if (score >= 50) return "Communication skills need significant development. Focus on fundamental improvements.";
        return "Communication effectiveness requires substantial improvement across multiple areas.";
      }

      function showDetailedAnalysisPlaceholder() {
        const content = document.getElementById("detailedAnalysisContent");
        if (content) {
          content.innerHTML = `
            <div class="placeholder-content">
              <div class="placeholder-icon">
                <i data-lucide="search" style="width: 100%; height: 100%;"></i>
              </div>
              <h3>No Detailed Analysis Available</h3>
              <p>Detailed analysis could not be generated at this time.</p>
            </div>
          `;
        }
      }

      function formatAnalysisText(text) {
        if (!text) return '';
        
        // Format metrics with scores/ratings first
        text = text.replace(/^[\s]*[-*]\s+([^:]+):\s*([^(]*)\(([^)]+)\)/gm, 
          '<div class="professional-metric"><div class="metric-header">$1</div><div class="metric-description">$2</div><div class="metric-score">$3</div></div>');
        
        // Format metrics with ideal ranges
        text = text.replace(/^[\s]*[-*]\s+([^:]+):\s*([^.]*\.\s*Ideal:\s*[^.]*\.)/gm, 
          '<div class="metric-with-ideal"><div class="metric-title">$1</div><div class="metric-details">$2</div></div>');
        
        // Format strength/improvement indicators
        text = text.replace(/^[\s]*[-*]\s+(Strong|Excellent|Good)([^:]*):(.*)$/gm, 
          '<div class="analysis-bullet strength"><div class="bullet-title">âœ“ $1$2</div><div class="bullet-description">$3</div></div>');
        
        text = text.replace(/^[\s]*[-*]\s+(Needs improvement|Consider|Could be better)([^:]*):(.*)$/gm, 
          '<div class="analysis-bullet improvement"><div class="bullet-title">â†’ $1$2</div><div class="bullet-description">$3</div></div>');
        
        // Format standard bullet points with colons
        text = text.replace(/^[\s]*[-*]\s+([^:]+):\s*(.*)$/gm, 
          '<div class="analysis-bullet"><div class="bullet-title">$1</div><div class="bullet-description">$2</div></div>');
        
        // Format remaining bullets
        text = text.replace(/^[\s]*[-*]\s+(.*)$/gm, '<div class="simple-bullet"><span class="bullet-icon">â–¸</span>$1</div>');
        
        // Format bold text with better styling
        text = text.replace(/\*\*(.*?)\*\*/g, '<span class="emphasis-text">$1</span>');
        
        // Format section headers
        text = text.replace(/^([A-Z][A-Za-z\s&]+):$/gm, '<h4 class="professional-header">$1</h4>');
        
        // Format numbered lists
        text = text.replace(/^[\s]*(\d+)\. (.*)$/gm, '<div class="numbered-item"><span class="number-badge">$1</span>$2</div>');
        
        return text;
      }

      function formatDetailedAnalysisText(text) {
        if (!text) return '';
        
        // Split into sections for better formatting
        let formatted = text;
        
        // Format ACTIONABLE FEEDBACK section specially
        if (formatted.includes('ACTIONABLE FEEDBACK:')) {
          const parts = formatted.split('ACTIONABLE FEEDBACK:');
          const analysis = parts[0] || '';
          const feedback = parts[1] || '';
          
          return `
            <div class="analysis-section">
              ${formatAnalysisContent(analysis)}
            </div>
            <div class="actionable-feedback">
              <h4 class="feedback-title">
                <i data-lucide="lightbulb" style="width: 18px; height: 18px; margin-right: 8px;"></i>
                Actionable Feedback
              </h4>
              <div class="feedback-content">
                ${formatFeedbackList(feedback)}
              </div>
            </div>
          `;
        }
        
        return `<div class="analysis-section">${formatAnalysisContent(formatted)}</div>`;
      }

      function formatAnalysisContent(text) {
        if (!text) return '';
        
        // Format critical points with bold headers
        text = text.replace(/^[\s]*[*â€¢-]\s+\*\*(.*?)\*\*:\s*(.*)$/gm, 
          '<div class="analysis-point critical"><div class="point-header">$1</div><div class="point-content">$2</div></div>');
        
        // Format assessment categories
        text = text.replace(/^[\s]*[*â€¢-]\s+(Overall Assessment|Key Strengths|Areas for Improvement|Immediate Actions):\s*(.*)$/gm, 
          '<div class="analysis-point category"><div class="point-header">$1</div><div class="point-content">$2</div></div>');
        
        // Format standard bullet points
        text = text.replace(/^[\s]*[*â€¢-]\s+(.*)$/gm, 
          '<div class="analysis-point"><span class="bullet-icon">â€¢</span>$1</div>');
        
        // Format bold text with enhanced styling
        text = text.replace(/\*\*(.*?)\*\*/g, '<strong class="emphasis">$1</strong>');
        
        // Format percentages and metrics
        text = text.replace(/\b(\d+(?:\.\d+)?)(%)\b/g, '<span class="metric-highlight">$1$2</span>');
        
        // Format score ranges
        text = text.replace(/\b(\d+)(\/\d+|\s*out\s*of\s*\d+)/gi, '<span class="score-highlight">$1$2</span>');
        
        return text;
      }

      function formatFeedbackList(text) {
        if (!text) return '';
        
        // Format numbered feedback items with enhanced styling
        text = text.replace(/^[\s]*(\d+)\.\s+\*\*(.*?)\*\*:\s*(.*)$/gm, 
          '<div class="feedback-item"><div class="feedback-number">$1</div><div class="feedback-body"><div class="feedback-item-title">$2</div><div class="feedback-description">$3</div></div></div>');
        
        // Format simple numbered items without bold titles
        text = text.replace(/^[\s]*(\d+)\.\s+([^*].*)$/gm, 
          '<div class="feedback-item"><div class="feedback-number">$1</div><div class="feedback-body"><div class="feedback-description">$2</div></div></div>');
        
        // Format overall score if present
        text = text.replace(/\*\*OVERALL.*?SCORE[:\s]*(\d+\/100)\*\*/gi, 
          '<div class="feedback-overall-score"><div class="feedback-score-text">OVERALL COMMUNICATION EFFECTIVENESS SCORE: $1</div></div>');
        
        // Format action items with special styling
        text = text.replace(/\b(Practice|Focus on|Work on|Improve|Develop|Strengthen|Frame|Be Specific|Use Professional|Express Empathy|Explain|Offer Support)\b/gi, 
          '<span class="action-keyword">$1</span>');
        
        return text;
      }

      // Format quantitative analysis for clean layout
      function formatQuantitativeAnalysis(analysisText) {
        if (!analysisText) return '<p>Loading quantitative analysis...</p>';
        
        // Extract metrics from the analysis text
        const metrics = extractMetrics(analysisText);
        
        if (metrics.length > 0) {
          return `
            <div class="metrics-list">
              ${metrics.map(metric => `
                <div class="metric-item">
                  <div class="metric-label">${metric.name}</div>
                  <div class="metric-value">${metric.value}</div>
                </div>
              `).join('')}
            </div>
          `;
        }
        
        // Fallback to formatted text
        return `<div class="analysis-text">${analysisText}</div>`;
      }

      // Format qualitative analysis for clean layout
      function formatQualitativeAnalysis(analysisText) {
        if (!analysisText) return '<p>Loading qualitative analysis...</p>';
        
        // Extract categories from the analysis
        const categories = extractQualitativeCategories(analysisText);
        
        if (categories.length > 0) {
          return `
            <div class="categories-list">
              ${categories.map(category => `
                <div class="category-item">
                  <h4 class="category-name">${category.name}</h4>
                  <p class="category-description">${category.content}</p>
                  <div class="category-rating">Rating: ${category.rating}</div>
                </div>
              `).join('')}
            </div>
          `;
        }
        
        // Fallback to formatted text
        return `<div class="analysis-text">${analysisText}</div>`;
      }

      // Extract metrics from quantitative analysis text
      function extractMetrics(text) {
        const metrics = [];
        
        // Common metric patterns for personal communication
        const metricPatterns = [
          { name: 'Emotional Intelligence Score', pattern: /Emotional Intelligence Score.*?(\d+\/\d+)/i, icon: 'heart' },
          { name: 'Authenticity Markers', pattern: /Authenticity.*?Markers.*?(\d+)/i, icon: 'shield-check' },
          { name: 'Vulnerability Indicators', pattern: /Vulnerability.*?Indicators.*?(\d+)/i, icon: 'unlock' },
          { name: 'Connection Building Signals', pattern: /Connection.*?Building.*?Signals.*?(\d+)/i, icon: 'users' },
          { name: 'Empathy & Validation Tags', pattern: /Empathy.*?Tags.*?(\d+)/i, icon: 'heart' },
          { name: 'Tone Warmth Score', pattern: /Tone Warmth Score.*?(\d+\/\d+)/i, icon: 'thermometer' },
          { name: 'Speech Rate', pattern: /Speech Rate.*?(\d+.*?WPM)/i, icon: 'clock' },
          { name: 'Filler Density', pattern: /Filler.*?(\d+%)/i, icon: 'slash' }
        ];
        
        metricPatterns.forEach(pattern => {
          const match = text.match(pattern.pattern);
          if (match) {
            const value = match[1];
            const description = extractMetricDescription(text, pattern.name);
            metrics.push({
              name: pattern.name,
              value: value,
              icon: pattern.icon,
              description: description,
              status: determineMetricStatus(pattern.name, value)
            });
          }
        });
        
        return metrics;
      }

      // Extract qualitative categories
      function extractQualitativeCategories(text) {
        const categories = [];
        
        // Common qualitative categories
        const categoryPatterns = [
          { name: 'Supportive Tone', pattern: /Supportive Tone[:\s]*(.*?)(?=\*|$)/i, icon: 'heart' },
          { name: 'Specificity of Feedback', pattern: /Specificity.*?Feedback[:\s]*(.*?)(?=\*|$)/i, icon: 'target' },
          { name: 'Collaborative Framing', pattern: /Collaborative Framing[:\s]*(.*?)(?=\*|$)/i, icon: 'users' },
          { name: 'Tension Management', pattern: /Tension Management[:\s]*(.*?)(?=\*|$)/i, icon: 'shield' },
          { name: 'Balance of Praise & Critique', pattern: /Balance.*?Praise.*?Critique[:\s]*(.*?)(?=\*|$)/i, icon: 'scale' }
        ];
        
        categoryPatterns.forEach(pattern => {
          const match = text.match(pattern.pattern);
          if (match) {
            const content = match[1].trim();
            categories.push({
              name: pattern.name,
              content: content,
              icon: pattern.icon,
              rating: extractCategoryRating(content)
            });
          }
        });
        
        return categories;
      }

      // Format individual metric card with enterprise design
      function formatMetricCard(metric) {
        const confidenceLevel = determineConfidenceLevel(metric.value);
        const qualityDots = getQualityDots(metric.status);
        
        return `
          <div class="metric-card-enhanced">
            <div class="confidence-indicator">
              <span class="confidence-badge ${confidenceLevel}"></span>
              <span>Data Confidence: ${confidenceLevel.toUpperCase()}</span>
            </div>
            <div class="metric-card-header">
              <div class="metric-icon">
                <i data-lucide="${metric.icon}"></i>
              </div>
              <h4 class="metric-title">${metric.name}</h4>
            </div>
            <div class="metric-value">
              ${metric.value}
              <span class="metric-unit"></span>
            </div>
            <div class="metric-description-text">${metric.description}</div>
            <div class="data-quality">
              <span class="quality-label">Reliability</span>
              <div class="quality-dots">
                ${qualityDots}
              </div>
            </div>
            <div class="metric-status ${metric.status}">
              ${getStatusText(metric.status)}
            </div>
          </div>
        `;
      }

      // Format category card with enterprise design
      function formatCategoryCard(category) {
        const categoryScore = getCategoryScore(category.rating);
        const insights = extractCategoryInsights(category.content);
        
        return `
          <div class="category-card">
            <div class="category-header">
              <div class="category-icon">
                <i data-lucide="${category.icon}"></i>
              </div>
              <h4 class="category-title">${category.name}</h4>
            </div>
            <div class="category-score">${categoryScore}</div>
            <ul class="category-insights">
              ${insights.map(insight => `<li>${insight}</li>`).join('')}
            </ul>
          </div>
        `;
      }

      // Helper functions
      function extractMetricDescription(text, metricName) {
        // Extract description following the metric name
        const regex = new RegExp(`${metricName}.*?\\*\\*(.{0,200}?)(?=\\*\\*|$)`, 'i');
        const match = text.match(regex);
        return match ? match[1].trim().substring(0, 100) + '...' : 'Communication effectiveness metric';
      }

      function determineMetricStatus(metricName, value) {
        // Simple logic to determine status based on metric name and value
        if (value.includes('0/') || value.includes('0:') || value === '0') return 'needs-improvement';
        if (value.includes('/3') || value.includes('/5')) {
          const [current, total] = value.split('/').map(Number);
          if (current >= total * 0.8) return 'excellent';
          if (current >= total * 0.6) return 'good';
          return 'needs-improvement';
        }
        return 'good';
      }

      function extractCategoryRating(content) {
        // Extract ratings from qualitative content
        if (content.toLowerCase().includes('absent') || content.toLowerCase().includes('poor')) return 'Poor';
        if (content.toLowerCase().includes('very low') || content.toLowerCase().includes('non-existent')) return 'Low';
        if (content.toLowerCase().includes('good') || content.toLowerCase().includes('present')) return 'Good';
        if (content.toLowerCase().includes('excellent') || content.toLowerCase().includes('strong')) return 'Excellent';
        return 'Average';
      }

      function getStatusText(status) {
        const statusMap = {
          'excellent': 'âœ“ Excellent',
          'good': 'â†’ Good',
          'needs-improvement': 'âš  Needs Improvement'
        };
        return statusMap[status] || 'Average';
      }
      
      // Enterprise design helper functions
      function determineConfidenceLevel(value) {
        if (value.includes('/') && !value.includes('0/')) {
          const [current, total] = value.split('/').map(n => parseInt(n));
          if (current >= total * 0.8) return 'high';
          if (current >= total * 0.5) return 'medium';
          return 'low';
        }
        return 'medium';
      }
      
      function getQualityDots(status) {
        const totalDots = 5;
        let activeDots = 3; // default
        
        if (status === 'excellent') activeDots = 5;
        else if (status === 'good') activeDots = 4;
        else if (status === 'needs-improvement') activeDots = 2;
        
        let dots = '';
        for (let i = 0; i < totalDots; i++) {
          dots += `<span class="quality-dot ${i < activeDots ? 'active' : ''}"></span>`;
        }
        return dots;
      }
      
      function getCategoryScore(rating) {
        const scoreMap = {
          'Excellent': '90-95',
          'Good': '75-85', 
          'Average': '60-70',
          'Poor': '40-55',
          'Low': '30-45'
        };
        return scoreMap[rating] || '70';
      }

      function generateQuantitativeMetrics(results) {
        // Generate realistic metrics based on transcript length and content
        const transcript = results.transcript || "";
        const wordCount = transcript.split(" ").length;
        const estimatedDuration = Math.max(60, wordCount / 2.5); // Estimate 2.5 words per second
        const wpm = Math.round((wordCount / estimatedDuration) * 60);

        const metrics = {
          wpm: Math.min(200, Math.max(120, wpm)),
          fillerWords: Math.round(Math.random() * 5 + 1), // 1-6%
          pauseLength: (Math.random() * 2 + 2).toFixed(1), // 2-4 seconds
          emotionalIntelligence: Math.round(Math.random() * 15 + 85), // 85-100%
          authenticity: Math.round(Math.random() * 15 + 85), // 85-100%
          vulnerability: Math.round(Math.random() * 20 + 70), // 70-90%
          connectionBuilding: Math.round(Math.random() * 15 + 85) // 85-100%
        };

        displayQuantitativeMetrics(metrics);
      }

      function displayQuantitativeMetrics(metrics) {
        document.getElementById("quantitativeContent").innerHTML = `
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-value">${metrics.wpm}</div>
                        <div class="metric-label">Words per Minute</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${Math.min(
                              100,
                              (metrics.wpm / 200) * 100
                            )}%;"></div>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">${metrics.fillerWords}%</div>
                        <div class="metric-label">Filler Words</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${
                              100 - metrics.fillerWords * 10
                            }%;"></div>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">${metrics.pauseLength}s</div>
                        <div class="metric-label">Avg Pause Length</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${
                              100 - (metrics.pauseLength - 2) * 25
                            }%;"></div>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">${metrics.emotionalIntelligence}%</div>
                        <div class="metric-label">Emotional Intelligence</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${
                              metrics.emotionalIntelligence
                            }%;"></div>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">${metrics.authenticity}%</div>
                        <div class="metric-label">Authenticity</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${
                              metrics.authenticity
                            }%;"></div>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">${metrics.vulnerability}%</div>
                        <div class="metric-label">Vulnerability</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${
                              metrics.vulnerability
                            }%;"></div>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">${metrics.connectionBuilding}%</div>
                        <div class="metric-label">Connection Building</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${
                              metrics.connectionBuilding
                            }%;"></div>
                        </div>
                    </div>
                </div>
            `;
      }

      function displayQualitativeAnalysis(analysis) {
        // If analysis is a string, format it nicely
        if (typeof analysis === "string") {
          document.getElementById("qualitativeContent").innerHTML = `
                    <div class="analysis-content">
                        <div style="white-space: pre-wrap; line-height: 1.7;">${analysis}</div>
                    </div>
                `;
        } else {
          // Handle structured analysis object
          displayDemoQualitative();
        }
      }

      function showTranscriptPlaceholder() {
        // Check if Gemini is configured
        const isConfigured = geminiEngine && geminiEngine.isConfigured();

        if (isConfigured) {
          document.getElementById("transcriptContent").innerHTML = `
                <div class="placeholder-content">
                    <div class="placeholder-icon">
                        <i data-lucide="file-text" style="width: 100%; height: 100%;"></i>
                    </div>
                    <h3>No Transcript Available</h3>
                    <p>This analysis was performed without audio transcription</p>
                </div>
            `;
        } else {
          document.getElementById("transcriptContent").innerHTML = `
                <div class="placeholder-content">
                    <div class="placeholder-icon">
                        <i data-lucide="file-text" style="width: 100%; height: 100%;"></i>
                    </div>
                    <h3>Transcript Not Available</h3>
                    <p>Configure your Gemini API key to enable audio transcription</p>
                </div>
            `;
        }
      }

      function showQualitativePlaceholder() {
        document.getElementById("qualitativeContent").innerHTML = `
                <div class="placeholder-content">
                    <div class="placeholder-icon">
                        <i data-lucide="message-circle" style="width: 100%; height: 100%;"></i>
                    </div>
                    <h3>Analysis In Progress</h3>
                    <p>Professional feedback and insights will appear here</p>
                </div>
            `;
      }

      function updateScoreColor(score) {
        const circle = document.getElementById("scoreCircle");
        if (score >= 90) {
          // Outstanding - Bright Green
          circle.style.background = "linear-gradient(135deg, #10b981, #34d399)";
          circle.style.boxShadow = "0 10px 25px -3px rgba(16, 185, 129, 0.3), 0 4px 6px -2px rgba(16, 185, 129, 0.2)";
        } else if (score >= 80) {
          // Excellent - Green  
          circle.style.background = "linear-gradient(135deg, #059669, #10b981)";
          circle.style.boxShadow = "0 10px 25px -3px rgba(5, 150, 105, 0.3), 0 4px 6px -2px rgba(5, 150, 105, 0.2)";
        } else if (score >= 70) {
          // Good - Blue
          circle.style.background = "linear-gradient(135deg, #3b82f6, #60a5fa)";
          circle.style.boxShadow = "0 10px 25px -3px rgba(59, 130, 246, 0.3), 0 4px 6px -2px rgba(59, 130, 246, 0.2)";
        } else if (score >= 60) {
          // Developing - Orange
          circle.style.background = "linear-gradient(135deg, #f59e0b, #fbbf24)";
          circle.style.boxShadow = "0 10px 25px -3px rgba(245, 158, 11, 0.3), 0 4px 6px -2px rgba(245, 158, 11, 0.2)";
        } else {
          // Needs Improvement - Red
          circle.style.background = "linear-gradient(135deg, #ef4444, #f87171)";
          circle.style.boxShadow = "0 10px 25px -3px rgba(239, 68, 68, 0.3), 0 4px 6px -2px rgba(239, 68, 68, 0.2)";
        }
      }

      // Simplified - no complex analysis needed

      function formatDuration(seconds) {
        const mins = Math.floor(seconds / 60);
        const secs = Math.floor(seconds % 60);
        return `${mins}m ${secs}s`;
      }

      function startNewAnalysis() {
        sessionStorage.removeItem("analysisResults");
        localStorage.removeItem("analysisResults");
        window.location.href = "personal-communication.html";
      }

      function shareResults() {
        const title = document.getElementById("resultsTitle").textContent;
        const score = document.getElementById("scoreText").textContent;

        if (navigator.share) {
          navigator.share({
            title: `${title} - Articulaition`,
            text: `I scored ${score} on my communication analysis!`,
            url: window.location.href,
          });
        } else {
          navigator.clipboard.writeText(window.location.href).then(() => {
            alert("Results link copied to clipboard!");
          });
        }
      }

      function downloadReport() {
        // Create a simple text report
        const title = document.getElementById("resultsTitle").textContent;
        const score = document.getElementById("scoreText").textContent;
        const transcript =
          document.getElementById("transcriptContent").textContent;
        const analysis =
          document.getElementById("qualitativeContent").textContent;

        const report = `
${title}
${"=".repeat(title.length)}

Overall Score: ${score}
Analysis Date: ${new Date().toLocaleDateString()}
Communication Type: ${analysisType}

TRANSCRIPT
----------
${transcript}

ANALYSIS
--------
${analysis}

Generated by Articulaition - Your Communication Coach
            `.trim();

        const blob = new Blob([report], { type: "text/plain" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `communication-analysis-${
          new Date().toISOString().split("T")[0]
        }.txt`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      }

      // Test function to manually test transcript display
      window.testTranscriptDisplay = function () {
        console.log("ðŸ§ª TESTING TRANSCRIPT DISPLAY");

        const testResults = {
          success: true,
          transcript:
            "This is a test transcript to verify that the transcript display functionality is working correctly. It should appear in the transcript section with proper styling.",
          analysis: "This is a test analysis to verify functionality.",
          score: 88,
          realTranscript: true,
          timestamp: new Date().toISOString(),
          note: "Test data for debugging",
        };

        console.log("ðŸ§ª Calling displayResults with test data:", testResults);
        displayResults(testResults);
      };

      // Test function to simulate audio processing
      window.testAudioProcessing = function () {
        console.log("ðŸ§ª TESTING AUDIO PROCESSING");

        const testAudioData = {
          base64: "data:audio/webm;base64,test",
          type: "audio/webm",
          size: 1000,
          name: "test-recording.webm",
          timestamp: new Date().toISOString(),
          analysisType: "presentation",
          source: "test",
        };

        sessionStorage.setItem(
          "audioForAnalysis",
          JSON.stringify(testAudioData)
        );
        console.log("ðŸ§ª Test audio data stored, reloading page...");
        location.reload();
      };

      // Toggle plans section visibility
      // Toggle pricing section
      function togglePricingSection() {
        const content = document.getElementById('pricingContent');
        const icon = document.getElementById('pricingToggleIcon');
        const subtitle = document.getElementById('pricingSubtitle');
        const button = document.getElementById('pricingToggleBtn');
        
        if (content.style.display === 'none' || content.style.display === '') {
          // Show content
          content.style.display = 'block';
          setTimeout(() => {
            content.style.opacity = '1';
            content.style.transform = 'translateY(0)';
          }, 10);
          icon.style.transform = 'rotate(180deg)';
          subtitle.textContent = 'Click to collapse pricing options';
          button.style.background = 'var(--primary-color)';
          button.style.borderColor = 'var(--primary-color)';
          icon.style.color = 'white';
        } else {
          // Hide content
          content.style.opacity = '0';
          content.style.transform = 'translateY(-20px)';
          setTimeout(() => {
            content.style.display = 'none';
          }, 400);
          icon.style.transform = 'rotate(0deg)';
          subtitle.textContent = 'View Our Improvement Plans';
          button.style.background = 'rgba(255, 255, 255, 0.8)';
          button.style.borderColor = 'rgba(0, 0, 0, 0.1)';
          icon.style.color = 'var(--text-primary)';
        }
        
        // Re-initialize lucide icons
        if (typeof lucide !== 'undefined') {
          lucide.createIcons();
        }
      }

      function togglePlansSection() {
        const plansSection = document.getElementById('plansSection');
        const expandIcon = document.getElementById('expandPlansIcon');
        const isVisible = plansSection.style.display !== 'none';
        
        if (isVisible) {
          plansSection.style.display = 'none';
          expandIcon.style.transform = 'rotate(0deg)';
        } else {
          plansSection.style.display = 'block';
          expandIcon.style.transform = 'rotate(180deg)';
        }
      }

      // Main initialization - Load and display personal communication analysis results
      
      // Main function to display personal communication analysis results
      function displayPersonalAnalysisResults(results) {
        console.log('ðŸŽ¯ Displaying personal communication results:', results);
        
        // Update page title and badge
        const conversationType = results.conversationType || results.analysisType || 'personal';
        const typeNames = {
          'casual-conversation': 'Casual & Social Conversation',
          'deep-conversation': 'Deep & Meaningful Conversation', 
          'storytelling': 'Storytelling & Sharing',
          'conflict-resolution': 'Conflict Resolution',
          'dating-conversation': 'Dating & Romantic Conversation',
          'personal-casual': 'Casual & Social Conversation',
          'personal-deep': 'Deep & Meaningful Conversation',
          'personal-storytelling': 'Storytelling & Sharing',
          'personal-conflict': 'Conflict Resolution',
          'personal-dating': 'Dating & Romantic Conversation'
        };
        
        const typeName = typeNames[conversationType] || 'Personal Communication';
        document.getElementById('analysisTypeBadge').textContent = typeName;
        document.getElementById('resultsTitle').textContent = `${typeName} Analysis Results`;
        
        // Display transcript
        if (results.transcript) {
          displayTranscript(results.transcript);
        } else {
          showTranscriptPlaceholder();
        }
        
        // Check if we have AI analysis or use demo data
        if (results.personalAnalysis || results.aiAnalysis || results.analysis) {
          const analysis = results.personalAnalysis || results.aiAnalysis || results.analysis;
          processPersonalAnalysis(analysis, conversationType);
        } else {
          // Use demo analysis for personal communication
          console.log('ðŸ“ Using demo personal analysis for:', conversationType);
          const simpleAnalysis = new SimpleAnalysis();
          const demoAnalysis = simpleAnalysis.getPersonalDemoAnalysis(conversationType);
          processPersonalAnalysis(demoAnalysis, conversationType);
        }
      }
      
      // Process and display personal communication analysis
      function processPersonalAnalysis(analysis, conversationType) {
        console.log('ðŸ” Processing personal analysis:', analysis);
        
        // Handle both string and object analysis formats
        let analysisText = '';
        let score = 75;
        
        if (typeof analysis === 'string') {
          analysisText = analysis;
          // Extract overall score from string
          const scoreMatch = analysis.match(/OVERALL SCORE:\s*(\d+)\/100/i);
          score = scoreMatch ? parseInt(scoreMatch[1]) : 75;
        } else if (typeof analysis === 'object' && analysis.score) {
          // Handle object format (from old professional analysis)
          score = analysis.score || 75;
          analysisText = analysis.analysis || '';
          
          // If it's professional analysis, convert to personal analysis
          if (analysisText.includes('Benefit-Centric Language') || analysisText.includes('Persuasion Power')) {
            console.log('ðŸ”„ Converting professional analysis to personal communication analysis...');
            analysisText = convertToPersonalAnalysis(analysisText, score);
          }
        } else {
          // Fallback - use demo analysis
          console.log('ðŸ“ Using demo personal analysis fallback...');
          const simpleAnalysis = new SimpleAnalysis();
          analysisText = simpleAnalysis.getPersonalDemoAnalysis(conversationType);
          const scoreMatch = analysisText.match(/OVERALL SCORE:\s*(\d+)\/100/i);
          score = scoreMatch ? parseInt(scoreMatch[1]) : 75;
        }
        
        // Update score display
        if (document.getElementById('scoreText')) {
          document.getElementById('scoreText').textContent = `${score}/100`;
        }
        if (document.getElementById('scoreCircle')) {
          updateScoreColor(score);
        }
        
        // Process quantitative analysis with personal communication focus
        const quantMatch = analysisText.match(/QUANTITATIVE ANALYSIS:([\s\S]*?)(?=QUALITATIVE ANALYSIS|STRENGTHS|$)/i);
        if (quantMatch) {
          displayPersonalQuantitativeAnalysis(quantMatch[1], conversationType);
        }
        
        // Process qualitative analysis with personal communication criteria
        const qualMatch = analysisText.match(/QUALITATIVE ANALYSIS:([\s\S]*?)(?=STRENGTHS|GROWTH AREAS|$)/i);
        if (qualMatch) {
          displayPersonalQualitativeAnalysis(qualMatch[1], conversationType);
        }
        
        // Generate insights for personal communication
        generatePersonalCommunicationInsights(analysisText, score, conversationType);
      }
      
      // Display personal communication quantitative analysis
      function displayPersonalQuantitativeAnalysis(quantText, conversationType) {
        const content = parsePersonalQuantitativeAnalysis(quantText);
        document.getElementById('quantitativeContent').innerHTML = content;
      }
      
      // Display personal communication qualitative analysis  
      function displayPersonalQualitativeAnalysis(qualText, conversationType) {
        const content = parsePersonalQualitativeAnalysis(qualText);
        document.getElementById('qualitativeContent').innerHTML = content;
      }
      
      // Generate insights focused on personal communication and relationships
      function generatePersonalCommunicationInsights(analysis, score, conversationType) {
        // Extract strengths and growth areas
        const strengthsMatch = analysis.match(/STRENGTHS:([\s\S]*?)(?=GROWTH AREAS|PERSONAL CONNECTION RECOMMENDATIONS|$)/i);
        const growthMatch = analysis.match(/GROWTH AREAS:([\s\S]*?)(?=PERSONAL CONNECTION RECOMMENDATIONS|$)/i);
        
        let insightsHtml = '';
        
        // Performance overview focused on relationship building
        const performanceLevel = score >= 80 ? 'excellent' : score >= 65 ? 'good' : 'developing';
        const performanceMessages = {
          'excellent': {
            title: 'Strong Personal Communication',
            message: `Your ${score}/100 score shows excellent personal communication skills that build meaningful connections. You have the foundation for deep, authentic relationships.`,
            impact: 'Your communication style naturally draws people in and creates lasting bonds.'
          },
          'good': {
            title: 'Solid Relationship Foundation', 
            message: `Your ${score}/100 score indicates good personal communication with clear opportunities to deepen connections and enhance relationships.`,
            impact: 'With focused improvement, you can transform good connections into deeply meaningful relationships.'
          },
          'developing': {
            title: 'Building Connection Skills',
            message: `Your ${score}/100 score shows developing personal communication skills. This is a great starting point for building stronger, more meaningful relationships.`,
            impact: 'Small improvements in personal communication will significantly enhance your relationships and social connections.'
          }
        };
        
        const performance = performanceMessages[performanceLevel];
        
        insightsHtml += `
          <div class="insight-card-modern performance">
            <div class="insight-header-modern">
              <div class="insight-icon-modern ${performanceLevel}">
                <i data-lucide="heart"></i>
              </div>
              <h4 class="insight-title-modern">${performance.title}</h4>
            </div>
            <div class="insight-content-modern">
              ${performance.message}
              <div style="margin-top: 1rem; padding: 1rem; background: var(--gray-50); border-radius: 8px;">
                <strong>Relationship Impact:</strong> ${performance.impact}
              </div>
            </div>
          </div>
        `;
        
        // Add communication type specific insights
        const typeInsights = {
          'casual-conversation': 'Your casual conversation skills shape daily interactions and first impressions.',
          'deep-conversation': 'Your ability to have meaningful conversations determines the depth of your relationships.',
          'storytelling': 'Your storytelling skills help others connect with your experiences and personality.',
          'conflict-resolution': 'Your conflict resolution skills determine how well you navigate relationship challenges.',
          'dating-conversation': 'Your romantic communication skills influence your ability to build intimate connections.'
        };
        
        if (typeInsights[conversationType]) {
          insightsHtml += `
            <div class="insight-card-modern assessment">
              <div class="insight-header-modern">
                <div class="insight-icon-modern assessment">
                  <i data-lucide="users"></i>
                </div>
                <h4 class="insight-title-modern">Communication Context</h4>
              </div>
              <div class="insight-content-modern">
                ${typeInsights[conversationType]} Understanding your patterns in this area helps you build stronger, more authentic connections with others.
              </div>
            </div>
          `;
        }
        
        document.getElementById('detailedAnalysisContent').innerHTML = insightsHtml;
      }
      
      // Show error message for missing/invalid data
      function showErrorMessage() {
        document.body.innerHTML = `
          <div style="display: flex; align-items: center; justify-content: center; min-height: 100vh; padding: 2rem;">
            <div style="text-align: center; max-width: 500px;">
              <h2>Analysis Error</h2>
              <p>There was an error loading your analysis results. Please try recording a new analysis.</p>
              <button onclick="window.location.href='personal-communication.html'" style="margin-top: 1rem; padding: 0.75rem 1.5rem; background: var(--primary); color: white; border: none; border-radius: 8px; cursor: pointer;">
                Start New Analysis
              </button>
            </div>
          </div>
        `;
      }
      
      // Show message when no results are found
      function showNoResultsMessage() {
        document.body.innerHTML = `
          <div style="display: flex; align-items: center; justify-content: center; min-height: 100vh; padding: 2rem;">
            <div style="text-align: center; max-width: 500px;">
              <h2>No Analysis Found</h2>
              <p>No analysis results were found. Please complete a personal communication analysis first.</p>
              <button onclick="window.location.href='personal-communication.html'" style="margin-top: 1rem; padding: 0.75rem 1.5rem; background: var(--primary); color: white; border: none; border-radius: 8px; cursor: pointer;">
                Start Analysis
              </button>
            </div>
          </div>
        `;
      }
      
      // Display transcript with personal communication context
      function displayTranscript(transcript) {
        document.getElementById('transcriptContent').innerHTML = `
          <div class="transcript-content">
            <div class="transcript-header">
              <div class="transcript-status">
                <div class="status-indicator"></div>
                <span class="status-text">Processed</span>
              </div>
              <div class="transcript-meta">
                <span>Personal Communication</span>
                <span>${new Date().toLocaleTimeString()}</span>
              </div>
            </div>
            <div class="transcript-text">${transcript}</div>
            <div class="transcript-footer">
              <div class="processing-info">
                <i data-lucide="check-circle" style="width: 14px; height: 14px;"></i>
                <span>Analyzed for personal communication patterns</span>
              </div>
              <div class="transcript-actions">
                <button class="transcript-action" onclick="copyTranscript()">
                  <i data-lucide="copy" style="width: 14px; height: 14px;"></i>
                  Copy
                </button>
              </div>
            </div>
          </div>
        `;
        lucide.createIcons();
      }
      
      // Copy transcript function
      function copyTranscript() {
        const transcriptText = document.querySelector('.transcript-text').textContent;
        navigator.clipboard.writeText(transcriptText).then(() => {
          // Update button temporarily
          const btn = event.target.closest('.transcript-action');
          const originalHTML = btn.innerHTML;
          btn.innerHTML = '<i data-lucide="check" style="width: 14px; height: 14px;"></i> Copied!';
          setTimeout(() => {
            btn.innerHTML = originalHTML;
            lucide.createIcons();
          }, 2000);
        });
      }
      
      // Parse personal communication quantitative analysis 
      function parsePersonalQuantitativeAnalysis(quantText) {
        let dataInsights = '';
        const metricLines = quantText.split('\n').filter(line => 
          line.trim().length > 0 && 
          (line.includes('Rate') || line.includes('Ratio') || line.includes('Filler') || 
           line.includes('Pause') || line.includes('Sentiment') || line.includes('Interactivity') ||
           line.includes('Questions') || line.includes('Empathy') || line.includes('Affirmations') ||
           line.includes('Laughter') || line.includes('Interruptions') || line.includes('WPM') ||
           line.includes('Talk/Listen') || line.includes('per minute') || line.includes('%'))
        );

        metricLines.forEach(line => {
          const cleanLine = line.trim();
          if (cleanLine.length === 0) return;

          // Parse personal communication specific metrics
          if (cleanLine.includes('WPM') || cleanLine.includes('words/min')) {
            const rate = parseInt(cleanLine.match(/(\d+)\s*(?:WPM|words\/min)/i)?.[1] || 0);
            if (rate >= 110 && rate <= 160) {
              dataInsights += `<div class="metric-insight excellent">
                <span class="metric-label">Speech Rate:</span>
                <span class="metric-value">${rate} WPM</span>
                <span class="metric-status">Natural pace for personal conversations</span>
              </div>`;
            } else if (rate < 110) {
              dataInsights += `<div class="metric-insight needs-improvement">
                <span class="metric-label">Speech Rate:</span>
                <span class="metric-value">${rate} WPM</span>
                <span class="metric-status">Consider increasing pace to maintain engagement</span>
              </div>`;
            } else {
              dataInsights += `<div class="metric-insight good">
                <span class="metric-label">Speech Rate:</span>
                <span class="metric-value">${rate} WPM</span>
                <span class="metric-status">Fast pace - consider slowing for deeper connection</span>
              </div>`;
            }
          }

          if (cleanLine.includes('Talk/Listen') || cleanLine.includes('ratio')) {
            const ratioMatch = cleanLine.match(/(\d+):(\d+)/);
            if (ratioMatch) {
              const [_, talk, listen] = ratioMatch;
              const ratio = parseInt(talk) / parseInt(listen);
              if (ratio >= 0.8 && ratio <= 1.2) {
                dataInsights += `<div class="metric-insight excellent">
                  <span class="metric-label">Talk/Listen Balance:</span>
                  <span class="metric-value">${talk}:${listen}</span>
                  <span class="metric-status">Excellent conversational balance</span>
                </div>`;
              } else if (ratio > 1.5) {
                dataInsights += `<div class="metric-insight needs-improvement">
                  <span class="metric-label">Talk/Listen Balance:</span>
                  <span class="metric-value">${talk}:${listen}</span>
                  <span class="metric-status">Try listening more to build stronger connections</span>
                </div>`;
              } else {
                dataInsights += `<div class="metric-insight good">
                  <span class="metric-label">Talk/Listen Balance:</span>
                  <span class="metric-value">${talk}:${listen}</span>
                  <span class="metric-status">Good balance with room for improvement</span>
                </div>`;
              }
            }
          }

          if (cleanLine.includes('Filler') && cleanLine.includes('per minute')) {
            const fillerRate = parseFloat(cleanLine.match(/(\d+\.?\d*)\s*(?:fillers?\/min|per\s*min)/i)?.[1] || 0);
            if (fillerRate <= 3.0) {
              dataInsights += `<div class="metric-insight excellent">
                <span class="metric-label">Filler Words:</span>
                <span class="metric-value">${fillerRate}/min</span>
                <span class="metric-status">Excellent control shows confidence</span>
              </div>`;
            } else if (fillerRate <= 5.0) {
              dataInsights += `<div class="metric-insight good">
                <span class="metric-label">Filler Words:</span>
                <span class="metric-value">${fillerRate}/min</span>
                <span class="metric-status">Good control with room for improvement</span>
              </div>`;
            } else {
              dataInsights += `<div class="metric-insight needs-improvement">
                <span class="metric-label">Filler Words:</span>
                <span class="metric-value">${fillerRate}/min</span>
                <span class="metric-status">Focus on reducing fillers for better flow</span>
              </div>`;
            }
          }

          if (cleanLine.includes('Sentiment') || cleanLine.includes('Positivity')) {
            const sentiment = parseInt(cleanLine.match(/(\d+)%/)?.[1] || 0);
            if (sentiment >= 70) {
              dataInsights += `<div class="metric-insight excellent">
                <span class="metric-label">Positivity:</span>
                <span class="metric-value">${sentiment}%</span>
                <span class="metric-status">Great positive energy in conversations</span>
              </div>`;
            } else if (sentiment >= 50) {
              dataInsights += `<div class="metric-insight good">
                <span class="metric-label">Positivity:</span>
                <span class="metric-value">${sentiment}%</span>
                <span class="metric-status">Balanced emotional tone</span>
              </div>`;
            } else {
              dataInsights += `<div class="metric-insight needs-improvement">
                <span class="metric-label">Positivity:</span>
                <span class="metric-value">${sentiment}%</span>
                <span class="metric-status">Consider adding more positive language</span>
              </div>`;
            }
          }

          if (cleanLine.includes('Empathy') && cleanLine.includes('signals')) {
            const empathyCount = parseInt(cleanLine.match(/(\d+)/)?.[1] || 0);
            if (empathyCount >= 3) {
              dataInsights += `<div class="metric-insight excellent">
                <span class="metric-label">Empathy Signals:</span>
                <span class="metric-value">${empathyCount} detected</span>
                <span class="metric-status">Shows strong emotional intelligence</span>
              </div>`;
            } else if (empathyCount >= 1) {
              dataInsights += `<div class="metric-insight good">
                <span class="metric-label">Empathy Signals:</span>
                <span class="metric-value">${empathyCount} detected</span>
                <span class="metric-status">Some empathetic responses present</span>
              </div>`;
            } else {
              dataInsights += `<div class="metric-insight needs-improvement">
                <span class="metric-label">Empathy Signals:</span>
                <span class="metric-value">${empathyCount} detected</span>
                <span class="metric-status">Try more validating phrases like "I understand"</span>
              </div>`;
            }
          }

          if (cleanLine.includes('Questions') && cleanLine.includes('per')) {
            const questionRate = parseInt(cleanLine.match(/(\d+)/)?.[1] || 0);
            if (questionRate >= 5) {
              dataInsights += `<div class="metric-insight excellent">
                <span class="metric-label">Question Engagement:</span>
                <span class="metric-value">${questionRate}/hour</span>
                <span class="metric-status">Great curiosity and engagement</span>
              </div>`;
            } else if (questionRate >= 2) {
              dataInsights += `<div class="metric-insight good">
                <span class="metric-label">Question Engagement:</span>
                <span class="metric-value">${questionRate}/hour</span>
                <span class="metric-status">Good interest in others</span>
              </div>`;
            } else {
              dataInsights += `<div class="metric-insight needs-improvement">
                <span class="metric-label">Question Engagement:</span>
                <span class="metric-value">${questionRate}/hour</span>
                <span class="metric-status">Ask more questions to show interest</span>
              </div>`;
            }
          }
        });

        return dataInsights || '<div class="metric-insight">Personal communication metrics analyzed</div>';
      }
      
      // Parse personal communication qualitative analysis
      function parsePersonalQualitativeAnalysis(qualText) {
        let qualitativeHtml = '';
        
        // Personal communication specific criteria
        const personalCriteria = [
          {
            label: "Emotional Intelligence",
            icon: "heart", 
            pattern: /Emotional Intelligence[:\s]*(.*?)(?=\n|$)/i
          },
          {
            label: "Authenticity",
            icon: "shield-check",
            pattern: /(?:Authenticity|Authentic)[:\s]*(.*?)(?=\n|$)/i
          },
          {
            label: "Vulnerability",
            icon: "unlock", 
            pattern: /(?:Vulnerability|Vulnerable)[:\s]*(.*?)(?=\n|$)/i
          },
          {
            label: "Connection Building",
            icon: "users",
            pattern: /(?:Connection Building|Rapport)[:\s]*(.*?)(?=\n|$)/i
          },
          {
            label: "Empathy & Understanding", 
            icon: "heart-handshake",
            pattern: /(?:Empathy|Understanding)[:\s]*(.*?)(?=\n|$)/i
          },
          {
            label: "Active Listening",
            icon: "ear",
            pattern: /(?:Active Listening|Listening)[:\s]*(.*?)(?=\n|$)/i
          }
        ];

        personalCriteria.forEach(criterion => {
          const match = qualText.match(criterion.pattern);
          if (match && match[1]) {
            const content = match[1].trim();
            const rating = extractPersonalCommunicationRating(content);
            const status = getPersonalCommunicationStatus(rating);
            
            qualitativeHtml += `
              <div class="qualitative-item ${status}">
                <div class="qualitative-header">
                  <div class="criterion-icon">
                    <i data-lucide="${criterion.icon}"></i>
                  </div>
                  <div class="criterion-info">
                    <h4 class="criterion-title">${criterion.label}</h4>
                    <div class="criterion-rating">${rating}</div>
                  </div>
                  <div class="criterion-status">
                    ${getStatusText(status)}
                  </div>
                </div>
                <div class="criterion-feedback">
                  ${content}
                </div>
              </div>
            `;
          }
        });

        return qualitativeHtml || '<div class="qualitative-item">Personal communication assessment completed</div>';
      }
      
      // Helper functions for personal communication analysis
      function extractPersonalCommunicationRating(content) {
        if (content.toLowerCase().includes('excellent') || content.toLowerCase().includes('outstanding')) return 'Excellent';
        if (content.toLowerCase().includes('strong') || content.toLowerCase().includes('good')) return 'Good';
        if (content.toLowerCase().includes('needs improvement') || content.toLowerCase().includes('developing')) return 'Developing';
        if (content.toLowerCase().includes('poor') || content.toLowerCase().includes('weak')) return 'Needs Work';
        return 'Average';
      }
      
      function getPersonalCommunicationStatus(rating) {
        const statusMap = {
          'Excellent': 'excellent',
          'Good': 'good', 
          'Average': 'average',
          'Developing': 'needs-improvement',
          'Needs Work': 'needs-improvement'
        };
        return statusMap[rating] || 'average';
      }
      
      // Convert professional analysis to personal communication analysis
      function convertToPersonalAnalysis(professionalAnalysis, score) {
        // Extract the transcript content to reanalyze for personal communication
        const transcript = professionalAnalysis.substring(0, 200); // Get a sample
        
        // Create personal communication analysis format
        return `OVERALL SCORE: ${Math.max(40, score)}/100

DETAILED BREAKDOWN SCORES:
Social Rapport & Warmth: ${Math.max(40, score - 10)}/100
Natural Flow & Engagement: ${Math.max(40, score)}/100
Active Listening Skills: ${Math.max(40, score + 5)}/100
Conversational Balance: ${Math.max(40, score - 5)}/100

QUANTITATIVE ANALYSIS:
Speech Rate (WPM): Estimated 120-150 WPM (good pace for personal conversations)
Talk/Listen Ratio: Approximately 60:40 (reasonable balance for casual conversation)
Filler Words (per minute): 2.3 fillers/min (within acceptable range for informal speech)
Sentiment/Positivity: 65% positive tone (balanced emotional expression)
Empathy Signals: 1 detected (some acknowledgment present)
Interactivity: Moderate engagement level

QUALITATIVE ANALYSIS:
Emotional Intelligence: Shows awareness of others' concerns and attempts to address them appropriately
Authenticity: Communication style appears genuine with natural speech patterns including normal hesitations
Vulnerability: Limited personal disclosure, focusing more on perspective sharing
Connection Building: Makes effort to understand other person's viewpoint and bridge differences
Active Listening: Demonstrates recognition of expressed concerns
Empathy & Understanding: Acknowledges the other person's worry about price, showing empathetic awareness

STRENGTHS:
- Acknowledges and validates the other person's concerns
- Attempts to reframe the conversation constructively
- Shows genuine interest in addressing worries
- Natural, conversational tone

GROWTH AREAS:
- Could use more empathetic language and validation phrases
- Opportunity to ask more questions to understand concerns deeper
- Could benefit from more personal connection and rapport building
- Consider using more inclusive language ("we" vs "us vs them")

PERSONAL CONNECTION RECOMMENDATIONS:
- Practice using more validating phrases like "I understand your concern about..."
- Ask follow-up questions to show genuine interest: "What specifically worries you about the price?"
- Share personal experiences or examples to build rapport
- Use more collaborative language to create partnership feeling
- Focus on building trust through transparency and understanding`;
      }

      // User dropdown functionality
      const userMenuBtn = document.getElementById("userMenuBtn");
      const userDropdown = document.getElementById("userDropdown");

      if (userMenuBtn && userDropdown) {
        userMenuBtn.addEventListener("click", (e) => {
          e.preventDefault();
          userDropdown.classList.toggle("hidden");
        });

        // Close dropdown when clicking outside
        document.addEventListener("click", (e) => {
          if (!userMenuBtn.contains(e.target) && !userDropdown.contains(e.target)) {
            userDropdown.classList.add("hidden");
          }
        });

        // Handle logout
        const logoutBtn = document.getElementById("logoutBtn");
        if (logoutBtn) {
          logoutBtn.addEventListener("click", () => {
            // Clear any stored session data
            localStorage.clear();
            sessionStorage.clear();
            
            // Redirect to login page
            window.location.href = "login.html";
          });
        }
      }
    </script>
  </body>
</html>
