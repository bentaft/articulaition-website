<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="AI-Powered Presentation Analysis Results - Articulaition"
    />
    <title>Presentation Analysis Results - Articulaition</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- External Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Custom Styles -->
    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/variables.css" />
    <link rel="stylesheet" href="css/base.css" />

    <style>
      /* ==========================================================================
         SOPHISTICATED PRESENTATION DESIGN SYSTEM
         ========================================================================== */
      :root {
        /* Presentation Color Palette - Professional & Dynamic */
        --present-primary: #3b82f6;
        --present-secondary: #1d4ed8;
        --present-accent: #3b82f6;
        --present-warm: #f59e0b;
        --present-success: #10b981;
        --present-neural: #64748b;
        --present-dark: #2d3748;
        --present-light: #f7fafc;
        --present-bg-primary: #fafbfc;
        --present-bg-secondary: #f4f6f8;
        --present-glass: rgba(255, 255, 255, 0.85);
        --present-glass-border: rgba(255, 255, 255, 0.3);
        --present-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.08);
        --present-shadow-lg: 0 35px 60px -12px rgba(0, 0, 0, 0.12);
        --present-text-primary: #1a202c;
        --present-text-secondary: #4a5568;
        --present-text-muted: #718096;
        
        /* Presentation Accent Colors */
        --presentation-primary: #3b82f6;
        --presentation-secondary: #1d4ed8;
        --presentation-success: #10b981;
        --presentation-warning: #f59e0b;
        --presentation-light: rgba(59, 130, 246, 0.05);
        
        /* Typography */
        --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        
        /* Spacing */
        --space-1: 0.25rem;
        --space-2: 0.5rem;
        --space-3: 0.75rem;
        --space-4: 1rem;
        --space-5: 1.25rem;
        --space-6: 1.5rem;
        --space-8: 2rem;
        
        /* Radius */
        --radius: 0.75rem;
        --radius-sm: 0.5rem;
        --radius-lg: 1rem;
        
        /* Glass Morphism Shadows */
        --shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      }

      /* ==========================================================================
         BASE STYLES WITH SOPHISTICATED BACKGROUND
         ========================================================================== */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      body {
        font-family: var(--font-sans);
        background: linear-gradient(135deg, #fafbfc 0%, #f4f6f8 25%, #edf2f7 50%, #e2e8f0 75%, #cbd5e0 100%);
        color: var(--present-text-primary);
        line-height: 1.6;
        -webkit-font-smoothing: antialiased;
        min-height: 100vh;
        overflow-x: hidden;
        position: relative;
      }

      /* Background Effects */
      body::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: 
          radial-gradient(circle at 20% 20%, rgba(99, 102, 241, 0.03) 0%, transparent 50%),
          radial-gradient(circle at 80% 20%, rgba(139, 92, 246, 0.025) 0%, transparent 50%),
          radial-gradient(circle at 20% 80%, rgba(6, 182, 212, 0.02) 0%, transparent 50%),
          radial-gradient(circle at 80% 80%, rgba(79, 70, 229, 0.015) 0%, transparent 50%);
        pointer-events: none;
        z-index: -1;
      }

      /* Animation Classes */
      .fade-in {
        animation: fadeIn 1s ease-out forwards;
        opacity: 0;
      }

      .slide-up {
        animation: slideUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        opacity: 0;
        transform: translateY(30px);
      }

      .scale-in {
        animation: scaleIn 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        opacity: 0;
        transform: scale(0.9);
      }

      @keyframes fadeIn {
        to { opacity: 1; }
      }
      @keyframes slideUp {
        to { opacity: 1; transform: translateY(0); }
      }
      @keyframes scaleIn {
        to { opacity: 1; transform: scale(1); }
      }
      @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.05); }
      }

      .delay-100 { animation-delay: 0.1s; }
      .delay-200 { animation-delay: 0.2s; }
      .delay-300 { animation-delay: 0.3s; }
      .delay-400 { animation-delay: 0.4s; }
      .delay-500 { animation-delay: 0.5s; }

      /* ==========================================================================
         TOP NAVIGATION WITH GLASS MORPHISM
         ========================================================================== */
      .top-nav {
        padding: 1.5rem 2.5rem;
        background: var(--present-glass);
        backdrop-filter: blur(25px);
        border-bottom: 1px solid rgba(0, 0, 0, 0.06);
        display: flex;
        align-items: center;
        justify-content: space-between;
        position: sticky;
        top: 0;
        z-index: 100;
        box-shadow: var(--present-shadow);
      }

      .logo-section {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .logo-section img {
        height: 36px;
        filter: none;
        transition: transform 0.3s ease;
      }

      .logo-section:hover img {
        transform: scale(1.05);
      }

      /* Navigation Branding with Shiny Effect */
      .nav-orange {
          background: linear-gradient(
              145deg,
              #ff934d 0%,
              #ffb366 30%,
              #ff7f50 60%,
              #ff934d 100%
          );
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
          filter: drop-shadow(0 2px 4px rgba(255, 147, 77, 0.3));
      }

      .nav-blue {
          background: linear-gradient(
              145deg,
              #4a90e2 0%,
              #6bb6ff 30%,
              #4f94e8 60%,
              #4a90e2 100%
          );
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
          filter: drop-shadow(0 2px 4px rgba(74, 144, 226, 0.3));
      }

      .nav-links {
        display: flex;
        gap: 2rem;
      }

      .nav-link {
        color: var(--present-text-secondary);
        text-decoration: none;
        font-weight: 500;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.3s ease;
        position: relative;
      }

      .nav-link.active {
        color: var(--present-primary);
        background: transparent;
        border: none;
        border-bottom: 2px solid #4a90e2;
        border-radius: 0;
        padding-bottom: 0.4rem;
      }

      .nav-link:hover:not(.active) {
        color: var(--present-text-primary);
        background: rgba(0, 0, 0, 0.05);
      }

      .user-menu {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .user-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: linear-gradient(
          135deg,
          var(--presentation-primary),
          var(--presentation-secondary)
        );
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        font-size: 0.875rem;
      }

      .back-btn {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem 1.5rem;
        background: linear-gradient(135deg, var(--presentation-primary), var(--presentation-secondary));
        color: white;
        text-decoration: none;
        border-radius: 12px;
        font-weight: 500;
        transition: all 0.3s ease;
        border: none;
        cursor: pointer;
      }

      .back-btn:hover {
        background: linear-gradient(135deg, var(--presentation-secondary), var(--presentation-primary));
        transform: translateY(-2px);
        box-shadow: var(--shadow-lg);
      }

      /* ==========================================================================
         MAIN CONTENT LAYOUT
         ========================================================================== */
      .main-content {
        max-width: 1400px;
        margin: 0 auto;
        padding: 3rem 2rem;
        position: relative;
        z-index: 2;
      }

      .breadcrumb {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin-bottom: 2rem;
        color: var(--present-text-muted);
        font-size: 0.875rem;
      }

      .breadcrumb a {
        color: var(--present-text-muted);
        text-decoration: none;
      }

      .breadcrumb a:hover {
        color: var(--present-text-secondary);
      }

      .breadcrumb .current {
        color: var(--present-text-primary);
        font-weight: 500;
      }

      .page-title-section {
        text-align: center;
        margin-bottom: 3rem;
      }

      .title-with-icon {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 1rem;
        margin-bottom: 1rem;
      }

      .title-icon {
        width: 48px;
        height: 48px;
        border-radius: 12px;
        background: linear-gradient(
          135deg,
          var(--presentation-primary),
          var(--presentation-secondary)
        );
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
      }

      .page-title {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--present-text-primary);
        margin: 0;
      }

      .page-description {
        color: var(--present-text-secondary);
        font-size: 1.125rem;
        max-width: 600px;
        margin: 0 auto;
        line-height: 1.6;
      }

      .analysis-container {
        display: grid;
        grid-template-columns: 1fr 600px;
        gap: 2rem;
        margin-bottom: 2rem;
      }

      /* ==========================================================================
         UNIFIED ANALYSIS PANEL WITH GLASS MORPHISM
         ========================================================================== */
      .unified-analysis-panel {
        background: var(--present-glass);
        backdrop-filter: blur(25px);
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 24px;
        box-shadow: var(--present-shadow-lg);
        overflow: hidden;
        height: fit-content;
        min-height: 600px;
        transition: all 0.3s ease;
        position: relative;
      }

      .unified-analysis-panel::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, rgba(99, 102, 241, 0.01) 0%, transparent 100%);
        pointer-events: none;
      }

      .unified-analysis-panel:hover {
        transform: translateY(-2px);
        box-shadow: var(--present-shadow-lg), 0 8px 25px rgba(0, 0, 0, 0.08);
      }

      .unified-tab-header {
        display: flex;
        border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        background: rgba(255, 255, 255, 0.4);
        backdrop-filter: blur(15px);
        position: relative;
        z-index: 2;
      }
      
      .unified-tab-btn {
        flex: 1;
        padding: var(--space-4) var(--space-5);
        background: none;
        border: none;
        font-size: 0.875rem;
        font-weight: 600;
        color: var(--present-text-secondary);
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: var(--space-2);
        border-radius: 12px 12px 0 0;
      }
      
      .unified-tab-btn:hover:not(.active) {
        background: rgba(99, 102, 241, 0.05);
        color: var(--present-text-primary);
        transform: translateY(-1px);
      }
      
      .unified-tab-btn.active {
        background: rgba(99, 102, 241, 0.1);
        color: var(--present-primary);
        border-bottom: 3px solid var(--present-primary);
        transform: translateY(-1px);
      }

      .unified-tab-btn.active::before {
        content: '';
        position: absolute;
        bottom: -1px;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(135deg, var(--present-primary), var(--present-secondary));
        border-radius: 2px 2px 0 0;
      }

      .unified-tab-content {
        padding: var(--space-6);
        height: 450px;
        overflow-y: auto;
        overflow-x: hidden;
        position: relative;
      }

      .unified-tab-content::-webkit-scrollbar {
        width: 6px;
      }

      .unified-tab-content::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.05);
        border-radius: 3px;
      }

      .unified-tab-content::-webkit-scrollbar-thumb {
        background: rgba(0, 0, 0, 0.2);
        border-radius: 3px;
      }

      .unified-tab-content::-webkit-scrollbar-thumb:hover {
        background: rgba(0, 0, 0, 0.3);
      }

      .unified-tab-pane {
        display: none;
      }

      .unified-tab-pane.active {
        display: block;
      }

      .panel-actions {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--space-6);
      }

      .panel-actions h3 {
        margin: 0;
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--present-text-primary);
      }

      .copy-btn {
        display: flex;
        align-items: center;
        gap: var(--space-2);
        padding: var(--space-2) var(--space-3);
        background: rgba(255, 255, 255, 0.6);
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: var(--radius);
        font-size: 0.875rem;
        color: var(--present-text-secondary);
        cursor: pointer;
        transition: all 0.2s;
      }

      .copy-btn:hover {
        background: rgba(255, 255, 255, 0.8);
        color: var(--present-text-primary);
      }

      /* ==========================================================================
         MISSING UTILITY CLASSES
         ========================================================================== */
      .flex { display: flex; }
      .items-center { align-items: center; }
      .gap-3 { gap: 0.75rem; }
      .gap-4 { gap: 1rem; }
      .relative { position: relative; }
      .group:hover .group-hover\\:scale-105 { transform: scale(1.05); }
      .h-9 { height: 2.25rem; }
      .w-auto { width: auto; }
      .font-semibold { font-weight: 600; }
      .text-lg { font-size: 1.125rem; }
      .tracking-tight { letter-spacing: -0.025em; }
      .transition-transform { transition: transform 0.3s ease; }

      .analysis-info {
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        gap: 0.25rem;
      }

      .analysis-badge {
        background: linear-gradient(135deg, var(--present-primary), var(--present-secondary));
        color: white;
        padding: 0.25rem 0.75rem;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .user-menu-btn {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        padding: 0.5rem 1rem;
        border-radius: 12px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(0, 0, 0, 0.05);
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .user-menu-btn:hover {
        background: rgba(255, 255, 255, 0.15);
        transform: translateY(-1px);
      }

      .user-avatar {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        background: linear-gradient(135deg, var(--present-primary), var(--present-secondary));
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        font-size: 0.875rem;
      }

      /* ==========================================================================
         PAGE HEADER
         ========================================================================== */
      .page-header {
        background: white;
        border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        padding: var(--space-4) var(--space-8);
      }
      
      .header-content h1 {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--present-text-primary);
        margin-bottom: var(--space-2);
      }

      /* ==========================================================================
         MAIN LAYOUT
         ========================================================================== */
      .main-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: var(--space-8);
      }
      
      /* Score Section at Top with Glass Morphism */
      .score-section {
        background: var(--present-glass);
        backdrop-filter: blur(25px);
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 24px;
        box-shadow: var(--present-shadow-lg);
        padding: var(--space-6) var(--space-8);
        margin-bottom: var(--space-6);
        text-align: center;
        position: relative;
        overflow: hidden;
      }

      .score-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, rgba(79, 70, 229, 0.02) 0%, transparent 100%);
        pointer-events: none;
      }
      
      .score-header {
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--present-text-secondary);
        margin-bottom: var(--space-4);
        position: relative;
        z-index: 2;
      }
      
      .score-display {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: var(--space-6);
      }
      
      .score-circle {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        background: linear-gradient(135deg, var(--presentation-primary) 0%, var(--presentation-secondary) 100%);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2.25rem;
        font-weight: 800;
        box-shadow: 0 25px 50px -12px rgba(59, 130, 246, 0.4), 0 15px 25px -8px rgba(59, 130, 246, 0.25);
        flex-shrink: 0;
        transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        border: 4px solid rgba(255, 255, 255, 0.3);
        position: relative;
        z-index: 2;
      }

      .score-circle::before {
        content: '';
        position: absolute;
        top: -4px;
        left: -4px;
        right: -4px;
        bottom: -4px;
        border-radius: 50%;
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.2) 0%, rgba(29, 78, 216, 0.1) 100%);
        z-index: -1;
        transition: all 0.4s ease;
      }
      
      .score-circle:hover {
        transform: translateY(-4px) scale(1.05);
        box-shadow: 0 35px 70px -12px rgba(59, 130, 246, 0.5), 0 20px 35px -8px rgba(59, 130, 246, 0.35);
      }

      .score-circle:hover::before {
        transform: scale(1.1);
        opacity: 0.8;
      }
      
      .score-details {
        text-align: left;
        position: relative;
        z-index: 2;
      }
      
      .score-label {
        font-size: 1rem;
        color: var(--present-text-secondary);
        margin-bottom: var(--space-2);
        font-weight: 600;
      }
      
      .score-value {
        font-size: 2.5rem;
        font-weight: 800;
        color: var(--present-text-primary);
        margin-bottom: var(--space-3);
        line-height: 1;
      }
      
      .score-description {
        font-size: 1rem;
        color: var(--present-text-secondary);
        font-weight: 500;
        padding: var(--space-2) var(--space-4);
        background: linear-gradient(135deg, #f8fafc, #f1f5f9);
        border-radius: 8px;
        border: 1px solid #e2e8f0;
      }
      
      /* Analysis Panels Layout */
      .analysis-panels {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--space-6);
        height: calc(100vh - 320px);
      }

      /* ==========================================================================
         TRANSCRIPT PANEL WITH GLASS MORPHISM
         ========================================================================== */
      .transcript-panel {
        background: var(--present-glass);
        backdrop-filter: blur(25px);
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 24px;
        box-shadow: var(--present-shadow-lg);
        display: flex;
        flex-direction: column;
        overflow: hidden;
        transition: all 0.3s ease;
        position: relative;
      }

      .transcript-panel::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, rgba(99, 102, 241, 0.01) 0%, transparent 100%);
        pointer-events: none;
      }

      .transcript-panel:hover {
        transform: translateY(-2px);
        box-shadow: var(--present-shadow-lg), 0 8px 25px rgba(0, 0, 0, 0.08);
      }

      .transcript-header {
        padding: var(--space-5) var(--space-6);
        border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        background: rgba(255, 255, 255, 0.4);
        backdrop-filter: blur(15px);
        position: relative;
        z-index: 2;
        display: flex;
        align-items: center;
        gap: var(--space-3);
      }

      .transcript-title {
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--present-text-primary);
        margin: 0;
      }

      .transcript-content {
        flex: 1;
        padding: var(--space-6);
        overflow-y: auto;
        position: relative;
        z-index: 2;
      }

      .transcript-text {
        line-height: 1.8;
        color: var(--present-text-secondary);
        background: var(--presentation-light);
        padding: var(--space-6);
        border-radius: var(--radius);
        border-left: 4px solid var(--presentation-primary);
        font-size: 0.95rem;
      }

      /* ==========================================================================
         LOADING STATES
         ========================================================================== */
      .loading-state {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: var(--space-8);
        color: var(--present-text-muted);
      }
      
      .spinner {
        width: 24px;
        height: 24px;
        border: 2px solid rgba(99, 102, 241, 0.2);
        border-top: 2px solid var(--present-primary);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: var(--space-3);
      }
      
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }

      /* ==========================================================================
         INSIGHT CARDS
         ========================================================================== */
      .insight-card-modern {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 16px;
        margin-bottom: var(--space-5);
        overflow: hidden;
        transition: all 0.3s ease;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
      }

      .insight-card-modern:hover {
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        transform: translateY(-1px);
      }

      .insight-header-modern {
        display: flex;
        align-items: center;
        gap: var(--space-3);
        padding: var(--space-5);
        background: rgba(255, 255, 255, 0.5);
        border-bottom: 1px solid rgba(0, 0, 0, 0.06);
      }

      .insight-icon-modern {
        width: 40px;
        height: 40px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, var(--present-primary), var(--present-secondary));
        color: white;
        flex-shrink: 0;
        box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3);
      }

      .insight-icon-modern.excellent {
        background: linear-gradient(135deg, #10b981, #059669);
        box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
      }

      .insight-icon-modern.good {
        background: linear-gradient(135deg, #f59e0b, #d97706);
        box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);
      }

      .insight-icon-modern.needs-improvement {
        background: linear-gradient(135deg, #ef4444, #dc2626);
        box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);
      }

      .insight-title-modern {
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--present-text-primary);
        margin: 0;
      }

      .insight-content-modern {
        padding: var(--space-5);
        line-height: 1.7;
      }

      .insight-bullet {
        margin: 0.5rem 0;
        padding: 0.25rem 0;
        color: var(--present-text-secondary);
        line-height: 1.6;
      }

      .insight-section-header {
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--present-text-primary);
        margin: 1.5rem 0 0.75rem 0;
        padding: 0.5rem;
        background: rgba(59, 130, 246, 0.1);
        border-left: 4px solid var(--present-primary);
        border-radius: 6px;
      }

      .metric-description {
        margin-top: 0.5rem;
        padding: 0.5rem;
        background: rgba(59, 130, 246, 0.05);
        border-radius: 6px;
        font-size: 0.9rem;
        color: var(--present-text-secondary);
        line-height: 1.5;
      }

      /* Enhanced Responsive Design for Modern Pricing */
      @media (max-width: 1200px) {
        .grid { grid-template-columns: repeat(2, 1fr) !important; gap: 1.5rem !important; }
        .pricing-grid { grid-template-columns: repeat(2, 1fr) !important; gap: 1.5rem !important; }
      }
      
      @media (max-width: 768px) {
        .grid { grid-template-columns: 1fr !important; }
        .pricing-grid { grid-template-columns: 1fr !important; }
        
        /* Reset transform scaling on mobile */
        .popular-card { transform: none !important; }
        .popular-card:hover { transform: translateY(-8px) !important; }
      }
      
      @media (max-width: 640px) {
        /* Make pricing cards stack better on small screens */
        .pricing-section { padding: 2rem 1rem !important; }
        .pricing-header { margin-bottom: 2rem !important; }
        .pricing-card { padding: 2rem 1.5rem !important; }
        .hero-section { padding: 2rem 1rem !important; }
        .action-section { padding: 2rem 1rem !important; }
        
        /* Adjust button layout on mobile */
        .action-buttons { flex-direction: column !important; gap: 0.75rem !important; }
        .action-buttons button { min-width: 100% !important; }
      }

      .insight-content-modern strong {
        color: var(--present-text-primary);
        font-weight: 600;
      }

      .insight-content-modern br + br {
        margin-top: 0.5rem;
      }

      /* ==========================================================================
         METRIC CARDS
         ========================================================================== */
      .metrics-grid {
        display: grid;
        gap: var(--space-4);
      }

      .metric-card {
        background: var(--presentation-light);
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: var(--radius);
        padding: var(--space-4);
        border-left: 4px solid var(--presentation-primary);
        transition: all 0.2s ease;
      }

      .metric-card:hover {
        transform: translateY(-1px);
        box-shadow: var(--shadow);
      }

      .metric-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--space-3);
      }

      .metric-name {
        font-weight: 600;
        color: var(--present-text-primary);
        font-size: 0.9rem;
      }

      .metric-score {
        font-weight: 600;
        font-size: 0.875rem;
        padding: var(--space-1) var(--space-2);
        border-radius: var(--radius-sm);
        background: white;
      }

      .metric-details {
        margin: var(--space-2) 0;
        font-size: 0.8rem;
        color: var(--present-text-secondary);
      }

      .metric-bar {
        height: 6px;
        background: rgba(0, 0, 0, 0.1);
        border-radius: 3px;
        overflow: hidden;
        margin-top: var(--space-2);
      }

      .metric-fill {
        height: 100%;
        border-radius: 3px;
        transition: width 0.3s ease;
      }

      /* ==========================================================================
         QUALITATIVE CATEGORIES
         ========================================================================== */
      .categories-grid {
        display: grid;
        gap: var(--space-4);
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      }

      .category-card {
        background: rgba(255, 255, 255, 0.8);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(0, 0, 0, 0.06);
        border-radius: 12px;
        padding: var(--space-5);
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      .category-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 4px;
        height: 100%;
        background: linear-gradient(135deg, var(--present-primary), var(--present-secondary));
      }

      .category-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        background: rgba(255, 255, 255, 0.95);
      }

      .category-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--space-3);
      }

      .category-name {
        font-weight: 600;
        color: var(--present-text-primary);
        font-size: 0.95rem;
      }

      .category-score {
        font-weight: 700;
        font-size: 1rem;
        padding: var(--space-2) var(--space-3);
        border-radius: 8px;
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.9));
        border: 1px solid rgba(0, 0, 0, 0.08);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        position: relative;
        overflow: hidden;
      }

      .category-score::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.6), transparent);
        animation: shimmer 2s infinite;
      }

      @keyframes shimmer {
        0% { left: -100%; }
        100% { left: 100%; }
      }

      .category-factors {
        margin: var(--space-3) 0;
        display: flex;
        flex-wrap: wrap;
        gap: var(--space-2);
      }

      .factor-tag {
        background: linear-gradient(135deg, rgba(99, 102, 241, 0.08), rgba(139, 92, 246, 0.06));
        color: var(--present-primary);
        padding: 0.375rem 0.75rem;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 600;
        border: 1px solid rgba(99, 102, 241, 0.15);
        transition: all 0.2s ease;
        text-transform: capitalize;
        letter-spacing: 0.025em;
      }

      .factor-tag:hover {
        background: linear-gradient(135deg, rgba(99, 102, 241, 0.12), rgba(139, 92, 246, 0.1));
        transform: translateY(-1px);
        box-shadow: 0 2px 4px rgba(99, 102, 241, 0.2);
      }

      .category-bar {
        height: 8px;
        background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
        border-radius: 12px;
        overflow: hidden;
        margin-top: var(--space-3);
        box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
        position: relative;
      }

      .category-bar::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, 0.3) 50%, transparent 100%);
        animation: barShimmer 3s ease-in-out infinite;
      }

      @keyframes barShimmer {
        0%, 100% { transform: translateX(-100%); }
        50% { transform: translateX(100%); }
      }

      .category-fill {
        height: 100%;
        border-radius: 12px;
        transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        background: linear-gradient(135deg, var(--present-primary) 0%, var(--present-secondary) 50%, var(--present-accent) 100%);
        box-shadow: 0 2px 4px rgba(99, 102, 241, 0.3);
        position: relative;
        overflow: hidden;
      }

      .category-fill::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, 0.4) 50%, transparent 100%);
        animation: fillShimmer 2s ease-in-out infinite;
      }

      @keyframes fillShimmer {
        0%, 100% { transform: translateX(-100%); }
        50% { transform: translateX(100%); }
      }

      /* ==========================================================================
         NEXT STEPS SECTION
         ========================================================================== */
      .next-steps-section {
        grid-column: 1 / -1;
        margin-top: var(--space-8);
      }

      .next-steps {
        border-left-color: var(--present-success) !important;
      }

      .next-steps .insight-icon-modern {
        background: var(--present-success);
      }

      /* ==========================================================================
         RESPONSIVE DESIGN
         ========================================================================== */
      @media (max-width: 1024px) {
        .analysis-container {
          grid-template-columns: 1fr;
          gap: var(--space-6);
        }
        
        .transcript-panel,
        .unified-analysis-panel {
          height: auto;
          min-height: 400px;
        }
        
        .top-nav {
          padding: var(--space-4) var(--space-5);
        }
        
        .logo-text {
          font-size: 1.25rem;
        }
      }

      @media (max-width: 768px) {
        .analysis-container {
          padding: var(--space-4);
        }
        
        .unified-tab-btn {
          font-size: 0.8rem;
          padding: var(--space-3) var(--space-4);
        }
        
        .unified-tab-btn span {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <!-- Top Navigation -->
    <nav class="top-nav fade-in delay-100">
      <div class="logo-section">
        <a href="index.html" class="flex items-center gap-3 group">
          <img src="images/tree-logo.svg" alt="Tree Logo" class="h-9 w-auto group-hover:scale-105 transition-transform">
          <span class="font-semibold text-lg tracking-tight nav-brand-text">
              <span class="nav-orange">articul</span><span class="nav-blue">ai</span><span class="nav-orange">tion</span><span class="nav-orange">.com</span>
          </span>
        </a>
        <div class="nav-links">
          <a href="dashboard.html" class="nav-link">Home</a>
          <a href="professional-communication.html" class="nav-link">Professional Communication</a>
          <a href="personal-communication.html" class="nav-link">Personal Communication</a>
          <a href="improvement-hub.html" class="nav-link">Improvement Hub</a>
          <a href="pricing.html" class="nav-link">Pricing</a>
        </div>
      </div>

      <div class="flex items-center gap-4">
        <!-- Analysis Results Info -->
        <div class="analysis-info">
          <span class="analysis-badge" id="analysisTypeBadge">Presentation Analysis</span>
        </div>
        
        <!-- User Menu -->
        <div class="relative">
          <button class="user-menu-btn" id="userMenuBtn">
            <div class="user-avatar">
              <span id="userInitial">U</span>
            </div>
            <span id="headerUsername">User</span>
            <i data-lucide="chevron-down"></i>
          </button>
        </div>
      </div>
    </nav>

    <!-- Page Header -->
    <header class="page-header slide-up delay-200">
      <div class="header-content">
        <h1 id="resultsTitle">Presentation Analysis Results</h1>
      </div>
    </header>

    <main class="main-container">
      <!-- Score Section at Top -->
      <div class="score-section scale-in delay-300">
        <div class="score-header">Overall Presentation Effectiveness Score</div>
        <div class="score-display">
          <div class="score-circle" id="scoreCircle">--</div>
          <div class="score-details">
            <div class="score-label">Presentation Mastery</div>
            <div class="score-value" id="scoreText">Analyzing...</div>
            <div class="score-description" id="scoreDescription">
              Building your personalized presentation skills report...
            </div>
          </div>
        </div>
      </div>

      <!-- Analysis Panels Layout -->
      <div class="analysis-panels">
        <!-- Left Panel: Transcript -->
        <div class="transcript-panel slide-up delay-400">
        <div class="transcript-header">
          <i data-lucide="mic" style="color: var(--presentation-primary);"></i>
          <h2 class="transcript-title">Your Presentation</h2>
        </div>
        <div class="transcript-content">
          <div id="transcriptContent">
            <div class="loading-state">
              <div class="spinner"></div>
              <p>Transcribing your presentation...</p>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Right Panel: Unified Analysis with 5 Tabs -->
      <div class="unified-analysis-panel slide-up delay-500">
        <!-- Tab Navigation -->
        <div class="unified-tab-header">
          <button class="unified-tab-btn active" data-tab="insights">
            <i data-lucide="lightbulb"></i>
            <span>Insights</span>
          </button>
          <button class="unified-tab-btn" data-tab="quantitative">
            <i data-lucide="bar-chart-2"></i>
            <span>Quantitative</span>
          </button>
          <button class="unified-tab-btn" data-tab="qualitative">
            <i data-lucide="pie-chart"></i>
            <span>Qualitative</span>
          </button>
        </div>
        
        <!-- Tab Content -->
        <div class="unified-tab-content">
          <!-- Insights Tab -->
          <div class="unified-tab-pane active" id="insights-pane">
            <div class="panel-actions">
              <h3>Presentation Insights</h3>
              <button class="copy-btn" onclick="copyAnalysis()">
                <i data-lucide="copy"></i>
                Copy Feedback
              </button>
            </div>
            <div id="detailedAnalysisContent">
              <div class="loading-state">
                <div class="spinner"></div>
                <p>Analyzing your presentation skills...</p>
              </div>
            </div>
          </div>
          
          <!-- Quantitative Tab -->
          <div class="unified-tab-pane" id="quantitative-pane">
            <div class="panel-actions">
              <h3>Presentation Metrics</h3>
              <button class="copy-btn" onclick="copyQuantitative()">
                <i data-lucide="copy"></i>
                Copy Data
              </button>
            </div>
            <div id="quantitativeContent">
              <div class="loading-state">
                <div class="spinner"></div>
                <p>Measuring speech patterns and timing...</p>
              </div>
            </div>
          </div>
          
          <!-- Qualitative Tab -->
          <div class="unified-tab-pane" id="qualitative-pane">
            <div class="panel-actions">
              <h3>Presentation Skills</h3>
              <button class="copy-btn" onclick="copyQualitative()">
                <i data-lucide="copy"></i>
                Copy Analysis
              </button>
            </div>
            <div id="qualitativeContent">
              <div class="loading-state">
                <div class="spinner"></div>
                <p>Evaluating presentation effectiveness...</p>
              </div>
            </div>
          </div>


        </div>
      </div>
      
      <!-- Enhanced Next Steps Section -->
      <div class="next-steps-section">
        <div class="insight-card-modern next-steps" style="background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.9)); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.3); box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);">
          <div class="insight-header-modern">
            <div class="insight-icon-modern" style="background: linear-gradient(135deg, var(--present-primary), var(--present-secondary)); animation: pulse 2s infinite;">
              <i data-lucide="target"></i>
            </div>
            <h3 class="insight-title-modern" style="font-size: 1.5rem; color: var(--present-text-primary); font-weight: 700;">Your Next Steps</h3>
          </div>
          <div class="insight-content-modern">
            <!-- Hero Message -->
            <div style="margin-bottom: 3rem; text-align: center; padding: 2.5rem 2rem; background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.9)); border-radius: 20px; border: 1px solid rgba(255, 255, 255, 0.5); backdrop-filter: blur(10px); box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);">
              <div style="max-width: 600px; margin: 0 auto;">
                <h4 style="font-size: 2.25rem; font-weight: 800; background: linear-gradient(135deg, var(--present-primary), var(--present-secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin: 0 0 1rem 0; line-height: 1.2;">
                  Transform Your Communication
                </h4>
                <p style="color: var(--present-text-secondary); line-height: 1.8; margin: 0; font-size: 1.125rem; font-weight: 400;">
                  You've unlocked professional insights that transform how you communicate. Choose your growth path and turn these discoveries into <strong style="color: var(--present-primary);">exponential progress</strong>.
                </p>
              </div>
            </div>
            
            
            <!-- Premium Pricing Section -->
            <div style="background: linear-gradient(135deg, rgba(248, 250, 252, 0.95), rgba(241, 245, 249, 0.98)); padding: 2rem; border-radius: 20px; border: 1px solid rgba(255, 255, 255, 0.8); box-shadow: 0 20px 40px rgba(0, 0, 0, 0.06); backdrop-filter: blur(10px); margin-bottom: 2rem; position: relative; overflow: hidden;">
              
              <!-- Collapsible Header -->
              <div style="position: relative; z-index: 1; cursor: pointer;" onclick="togglePricingSection()">
                <div style="display: flex; align-items: center; justify-content: space-between;">
                  <div style="display: flex; align-items: center; gap: 1rem;">
                    <div style="display: inline-flex; align-items: center; gap: 0.5rem; background: rgba(255, 255, 255, 0.8); padding: 0.5rem 1rem; border-radius: 50px; border: 1px solid rgba(0, 0, 0, 0.1);">
                      <i data-lucide="rocket" style="width: 16px; height: 16px; color: var(--present-primary);"></i>
                      <span style="font-size: 0.875rem; font-weight: 600; color: var(--present-primary);">Choose Your Growth Path</span>
                    </div>
                    <div>
                      <h4 style="font-size: 1.5rem; font-weight: 800; color: var(--present-text-primary); margin: 0; line-height: 1.2;">Plans Built for Every Stage</h4>
                      <p style="font-size: 0.875rem; color: var(--present-text-secondary); margin: 0.25rem 0 0 0; font-weight: 400;" id="pricingSubtitle">View Our Improvement Plans</p>
                    </div>
                  </div>
                  <button style="background: rgba(255, 255, 255, 0.8); border: 1px solid rgba(0, 0, 0, 0.1); border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s ease;" id="pricingToggleBtn" onmouseover="this.style.background='rgba(255, 255, 255, 1)'; this.style.boxShadow='0 2px 8px rgba(0, 0, 0, 0.1)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.8)'; this.style.boxShadow='none'">
                    <i data-lucide="chevron-down" style="width: 20px; height: 20px; transition: transform 0.3s ease;" id="pricingToggleIcon"></i>
                  </button>
                </div>
              </div>
              
              <!-- Collapsible Content -->
              <div id="pricingContent" style="display: none; opacity: 0; transition: all 0.4s ease; margin-top: 2rem;">
                <p style="font-size: 1rem; color: var(--present-text-secondary); margin: 0.5rem auto 2rem; font-weight: 400; text-align: center; max-width: 500px;">From first insights to complete mastery—grow at your pace with tools designed for real results.</p>
              
              <!-- Premium Pricing Grid -->
              <div style="position: relative; z-index: 1; display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2rem; max-width: 1400px; margin: 0 auto;">
                
                <!-- Essential Plan -->
                <div style="background: white; border: 2px solid rgba(0, 0, 0, 0.06); border-radius: 24px; padding: 2.5rem 2rem; text-align: left; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); position: relative; overflow: hidden; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.04);" onmouseover="this.style.transform='translateY(-12px)'; this.style.boxShadow='0 25px 50px rgba(99, 102, 241, 0.15)'; this.style.borderColor='rgba(99, 102, 241, 0.2)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 20px rgba(0, 0, 0, 0.04)'; this.style.borderColor='rgba(0, 0, 0, 0.06)'">
                  <div style="margin-bottom: 2rem;">
                    <div style="display: inline-flex; align-items: center; gap: 0.5rem; background: rgba(99, 102, 241, 0.1); padding: 0.375rem 0.75rem; border-radius: 50px; margin-bottom: 1.5rem;">
                      <i data-lucide="play" style="width: 14px; height: 14px; color: var(--present-primary);"></i>
                      <span style="font-size: 0.75rem; font-weight: 600; color: var(--present-primary); text-transform: uppercase; letter-spacing: 0.5px;">Essential</span>
                    </div>
                    <h5 style="font-size: 1.5rem; font-weight: 800; color: var(--present-text-primary); margin: 0 0 0.5rem 0;">Start Your Growth</h5>
                    <p style="color: var(--present-text-secondary); font-size: 1rem; margin: 0 0 1.5rem 0; line-height: 1.6;">Perfect for building steady confidence in how you express yourself.</p>
                    <div style="margin-bottom: 2rem;">
                      <span style="font-size: 3rem; font-weight: 900; color: var(--present-text-primary); line-height: 1;">$9.99</span>
                      <span style="font-size: 1rem; font-weight: 500; color: var(--present-text-secondary);">/month</span>
                    </div>
                  </div>
                  
                  <div style="margin-bottom: 2rem;">
                    <div style="font-weight: 600; color: var(--present-text-primary); margin-bottom: 1rem; font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.5px;">What's included:</div>
                    <ul style="list-style: none; padding: 0; margin: 0; space-y: 0.75rem;">
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--present-text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: rgba(16, 185, 129, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="check" style="width: 12px; height: 12px; color: var(--present-success);"></i>
                        </div>
                        <span>10 detailed audio analyses per month</span>
                      </li>
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--present-text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: rgba(16, 185, 129, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="check" style="width: 12px; height: 12px; color: var(--present-success);"></i>
                        </div>
                        <span>Monthly improvement catalog with drills</span>
                      </li>
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--present-text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: rgba(16, 185, 129, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="check" style="width: 12px; height: 12px; color: var(--present-success);"></i>
                        </div>
                        <span>Email support</span>
                      </li>
                    </ul>
                  </div>
                  
                  <button onclick="window.location.href='pricing.html'" style="width: 100%; background: var(--present-primary); color: white; border: none; padding: 1rem 1.5rem; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; font-size: 1rem; box-shadow: 0 4px 12px rgba(99, 102, 241, 0.25);" onmouseover="this.style.background='#5145db'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 25px rgba(99, 102, 241, 0.35)'" onmouseout="this.style.background='var(--present-primary)'; this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(99, 102, 241, 0.25)'">Get Started</button>
                </div>
                
                <!-- Max Growth Plan -->
                <div style="background: linear-gradient(135deg, white, #fafbff); border: 3px solid var(--present-primary); border-radius: 24px; padding: 2.5rem 2rem; text-align: left; position: relative; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); overflow: hidden; transform: scale(1.05); box-shadow: 0 20px 40px rgba(99, 102, 241, 0.15);" onmouseover="this.style.transform='translateY(-12px) scale(1.08)'; this.style.boxShadow='0 30px 60px rgba(99, 102, 241, 0.25)'" onmouseout="this.style.transform='translateY(0) scale(1.05)'; this.style.boxShadow='0 20px 40px rgba(99, 102, 241, 0.15)'">
                  <!-- Popular Badge -->
                  <div style="position: absolute; top: -1px; left: 50%; transform: translateX(-50%); background: linear-gradient(135deg, var(--present-primary), var(--present-secondary)); color: white; padding: 0.25rem 0.75rem; border-radius: 15px; font-size: 0.625rem; font-weight: 600; box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3); text-transform: uppercase; letter-spacing: 0.5px;">
                    <i data-lucide="star" style="width: 10px; height: 10px; margin-right: 0.2rem;"></i>Popular
                  </div>
                  
                  <div style="margin-bottom: 2rem; margin-top: 1rem;">
                    <div style="display: inline-flex; align-items: center; gap: 0.5rem; background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.05)); padding: 0.375rem 0.75rem; border-radius: 50px; margin-bottom: 1.5rem;">
                      <i data-lucide="zap" style="width: 14px; height: 14px; color: var(--present-primary);"></i>
                      <span style="font-size: 0.75rem; font-weight: 600; color: var(--present-primary); text-transform: uppercase; letter-spacing: 0.5px;">Max Growth</span>
                    </div>
                    <h5 style="font-size: 1.5rem; font-weight: 800; color: var(--present-text-primary); margin: 0 0 0.5rem 0;">Complete Transformation</h5>
                    <p style="color: var(--present-text-secondary); font-size: 1rem; margin: 0 0 1.5rem 0; line-height: 1.6;">For serious communicators ready to unlock their full potential with unlimited practice and expert guidance.</p>
                    <div style="margin-bottom: 2rem;">
                      <span style="font-size: 3rem; font-weight: 900; color: var(--present-text-primary); line-height: 1;">$15.99</span>
                      <span style="font-size: 1rem; font-weight: 500; color: var(--present-text-secondary);">/month</span>
                    </div>
                  </div>
                  
                  <div style="margin-bottom: 2rem;">
                    <div style="font-weight: 600; color: var(--present-text-primary); margin-bottom: 1rem; font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.5px;">Everything in Essential, plus:</div>
                    <ul style="list-style: none; padding: 0; margin: 0; space-y: 0.75rem;">
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--present-text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(139, 92, 246, 0.1)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="infinity" style="width: 12px; height: 12px; color: var(--present-primary);"></i>
                        </div>
                        <span><strong>Unlimited</strong> audio analysis</span>
                      </li>
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--present-text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(139, 92, 246, 0.1)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="users" style="width: 12px; height: 12px; color: var(--present-primary);"></i>
                        </div>
                        <span>Weekly expert review sessions</span>
                      </li>
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--present-text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(139, 92, 246, 0.1)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="sparkles" style="width: 12px; height: 12px; color: var(--present-primary);"></i>
                        </div>
                        <span>Full access to Improvement Hub</span>
                      </li>
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--present-text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(139, 92, 246, 0.1)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="clock" style="width: 12px; height: 12px; color: var(--present-primary);"></i>
                        </div>
                        <span>Early access to new tools</span>
                      </li>
                    </ul>
                  </div>
                  
                  <button onclick="window.location.href='pricing.html'" style="width: 100%; background: linear-gradient(135deg, var(--present-primary), var(--present-secondary)); color: white; border: none; padding: 1rem 1.5rem; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; font-size: 1rem; box-shadow: 0 8px 20px rgba(99, 102, 241, 0.4);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 12px 30px rgba(99, 102, 241, 0.5)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 8px 20px rgba(99, 102, 241, 0.4)'">Start Free Trial</button>
                </div>
                
                <!-- Enterprise Plan -->
                <div style="background: white; border: 2px solid rgba(107, 114, 128, 0.15); border-radius: 24px; padding: 2.5rem 2rem; text-align: left; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); position: relative; overflow: hidden; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.04);" onmouseover="this.style.transform='translateY(-12px)'; this.style.boxShadow='0 25px 50px rgba(107, 114, 128, 0.15)'; this.style.borderColor='rgba(107, 114, 128, 0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 20px rgba(0, 0, 0, 0.04)'; this.style.borderColor='rgba(107, 114, 128, 0.15)'">
                  <div style="margin-bottom: 2rem;">
                    <div style="display: inline-flex; align-items: center; gap: 0.5rem; background: rgba(107, 114, 128, 0.1); padding: 0.375rem 0.75rem; border-radius: 50px; margin-bottom: 1.5rem;">
                      <i data-lucide="building" style="width: 14px; height: 14px; color: var(--present-text-primary);"></i>
                      <span style="font-size: 0.75rem; font-weight: 600; color: var(--present-text-primary); text-transform: uppercase; letter-spacing: 0.5px;">Enterprise</span>
                    </div>
                    <h5 style="font-size: 1.5rem; font-weight: 800; color: var(--present-text-primary); margin: 0 0 0.5rem 0;">Scale Your Team</h5>
                    <p style="color: var(--present-text-secondary); font-size: 1rem; margin: 0 0 1.5rem 0; line-height: 1.6;">Custom solutions for teams, coaches, and organizations building communication excellence.</p>
                    <div style="margin-bottom: 2rem;">
                      <span style="font-size: 3rem; font-weight: 900; color: var(--present-text-primary); line-height: 1;">Custom</span>
                      <span style="font-size: 1rem; font-weight: 500; color: var(--present-text-secondary);"> pricing</span>
                    </div>
                  </div>
                  
                  <div style="margin-bottom: 2rem;">
                    <div style="font-weight: 600; color: var(--present-text-primary); margin-bottom: 1rem; font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.5px;">Enterprise features:</div>
                    <ul style="list-style: none; padding: 0; margin: 0; space-y: 0.75rem;">
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--present-text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: rgba(107, 114, 128, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="chart-line" style="width: 12px; height: 12px; color: var(--present-text-primary);"></i>
                        </div>
                        <span>Custom team dashboards & analytics</span>
                      </li>
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--present-text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: rgba(107, 114, 128, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="users-2" style="width: 12px; height: 12px; color: var(--present-text-primary);"></i>
                        </div>
                        <span>Group metrics & shared insights</span>
                      </li>
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--present-text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: rgba(107, 114, 128, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="headphones" style="width: 12px; height: 12px; color: var(--present-text-primary);"></i>
                        </div>
                        <span>Dedicated support & onboarding</span>
                      </li>
                    </ul>
                  </div>
                  
                  <button onclick="window.location.href='pricing.html'" style="width: 100%; background: var(--present-text-primary); color: white; border: none; padding: 1rem 1.5rem; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; font-size: 1rem; box-shadow: 0 4px 12px rgba(107, 114, 128, 0.25);" onmouseover="this.style.background='#1f2937'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 25px rgba(107, 114, 128, 0.35)'" onmouseout="this.style.background='var(--present-text-primary)'; this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(107, 114, 128, 0.25)'">Contact Sales</button>
                </div>
                
                <!-- One-Time Plan -->
                <div style="background: white; border: 2px solid rgba(139, 92, 246, 0.15); border-radius: 24px; padding: 2.5rem 2rem; text-align: left; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); position: relative; overflow: hidden; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.04);" onmouseover="this.style.transform='translateY(-12px)'; this.style.boxShadow='0 25px 50px rgba(139, 92, 246, 0.15)'; this.style.borderColor='rgba(139, 92, 246, 0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 20px rgba(0, 0, 0, 0.04)'; this.style.borderColor='rgba(139, 92, 246, 0.15)'">
                  <div style="margin-bottom: 2rem;">
                    <div style="display: inline-flex; align-items: center; gap: 0.5rem; background: rgba(139, 92, 246, 0.1); padding: 0.375rem 0.75rem; border-radius: 50px; margin-bottom: 1.5rem;">
                      <i data-lucide="file-text" style="width: 14px; height: 14px; color: var(--present-secondary);"></i>
                      <span style="font-size: 0.75rem; font-weight: 600; color: var(--present-secondary); text-transform: uppercase; letter-spacing: 0.5px;">One-Time</span>
                    </div>
                    <h5 style="font-size: 1.5rem; font-weight: 800; color: var(--present-text-primary); margin: 0 0 0.5rem 0;">Personal Blueprint</h5>
                    <p style="color: var(--present-text-secondary); font-size: 1rem; margin: 0 0 1.5rem 0; line-height: 1.6;">A comprehensive communication analysis and personalized improvement plan delivered as a PDF.</p>
                    <div style="margin-bottom: 2rem;">
                      <span style="font-size: 3rem; font-weight: 900; color: var(--present-text-primary); line-height: 1;">$30</span>
                      <span style="font-size: 1rem; font-weight: 500; color: var(--present-text-secondary);"> one-time</span>
                    </div>
                  </div>
                  
                  <div style="margin-bottom: 2rem;">
                    <div style="font-weight: 600; color: var(--present-text-primary); margin-bottom: 1rem; font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.5px;">What you get:</div>
                    <ul style="list-style: none; padding: 0; margin: 0; space-y: 0.75rem;">
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--present-text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: rgba(139, 92, 246, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="search" style="width: 12px; height: 12px; color: var(--present-secondary);"></i>
                        </div>
                        <span>Deep analysis of vocal patterns & delivery</span>
                      </li>
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--present-text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: rgba(139, 92, 246, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="target" style="width: 12px; height: 12px; color: var(--present-secondary);"></i>
                        </div>
                        <span>Targeted breakdown of specific issues</span>
                      </li>
                      <li style="padding: 0.5rem 0; font-size: 0.95rem; color: var(--present-text-primary); display: flex; align-items: flex-start; gap: 0.75rem; line-height: 1.5;">
                        <div style="width: 20px; height: 20px; background: rgba(139, 92, 246, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;">
                          <i data-lucide="download" style="width: 12px; height: 12px; color: var(--present-secondary);"></i>
                        </div>
                        <span>Lifetime PDF access—yours forever</span>
                      </li>
                    </ul>
                  </div>
                  
                  <button onclick="window.location.href='pricing.html'" style="width: 100%; background: var(--present-secondary); color: white; border: none; padding: 1rem 1.5rem; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; font-size: 1rem; box-shadow: 0 4px 12px rgba(139, 92, 246, 0.25);" onmouseover="this.style.background='#7c3aed'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 25px rgba(139, 92, 246, 0.35)'" onmouseout="this.style.background='var(--present-secondary)'; this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(139, 92, 246, 0.25)'">Get My Report</button>
                </div>
                
              </div>
              
              </div>
            </div>
            
            <!-- Enhanced Action Section -->
            <div style="margin-top: 3rem; text-align: center; padding: 3rem 2rem; background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(248, 250, 252, 0.9)); border-radius: 20px; border: 1px solid rgba(255, 255, 255, 0.5); backdrop-filter: blur(10px); box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);">
              <div style="max-width: 600px; margin: 0 auto 2rem;">
                <h4 style="font-size: 1.5rem; font-weight: 700; color: var(--present-text-primary); margin: 0 0 0.75rem 0;">Ready to Continue Your Growth?</h4>
                <p style="color: var(--present-text-secondary); line-height: 1.6; margin: 0; font-size: 1rem;">Keep building on these insights or explore more tools to accelerate your communication mastery.</p>
              </div>
              
              <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; max-width: 500px; margin: 0 auto;">
                <button onclick="window.location.href='presentation-analysis.html'" 
                  style="background: linear-gradient(135deg, var(--present-primary), var(--present-secondary)); color: white; border: none; padding: 1rem 2rem; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; font-size: 1rem; box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3); flex: 1; min-width: 200px;"
                  onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 25px rgba(99, 102, 241, 0.4)'"
                  onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(99, 102, 241, 0.3)'">
                  <i data-lucide="mic" style="width: 16px; height: 16px; margin-right: 0.5rem; vertical-align: middle;"></i>
                  Practice Again
                </button>
                <button onclick="window.location.href='improvement-hub.html'" 
                  style="background: white; color: var(--present-primary); border: 2px solid var(--present-primary); padding: 1rem 2rem; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; font-size: 1rem; flex: 1; min-width: 200px;"
                  onmouseover="this.style.background='var(--present-primary)'; this.style.color='white'; this.style.transform='translateY(-2px)'"
                  onmouseout="this.style.background='white'; this.style.color='var(--present-primary)'; this.style.transform='translateY(0)'">
                  <i data-lucide="sparkles" style="width: 16px; height: 16px; margin-right: 0.5rem; vertical-align: middle;"></i>
                  Explore Improvement Hub
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <script>
      // CRITICAL: Set up Gemini API key for transcription
      window.GEMINI_API_KEY = "AIzaSyBGvwarFw2FbxgxOMnFchyji6G-zYkrgV8";
      console.log("🔑 Gemini API key configured for presentation analysis");

      // Toggle pricing section
      function togglePricingSection() {
        const content = document.getElementById('pricingContent');
        const icon = document.getElementById('pricingToggleIcon');
        const subtitle = document.getElementById('pricingSubtitle');
        const button = document.getElementById('pricingToggleBtn');
        
        if (content.style.display === 'none' || content.style.display === '') {
          // Show content
          content.style.display = 'block';
          setTimeout(() => {
            content.style.opacity = '1';
            content.style.transform = 'translateY(0)';
          }, 10);
          icon.style.transform = 'rotate(180deg)';
          subtitle.textContent = 'Click to collapse pricing options';
          button.style.background = 'var(--present-primary)';
          button.style.borderColor = 'var(--present-primary)';
          icon.style.color = 'white';
        } else {
          // Hide content
          content.style.opacity = '0';
          content.style.transform = 'translateY(-20px)';
          setTimeout(() => {
            content.style.display = 'none';
          }, 400);
          icon.style.transform = 'rotate(0deg)';
          subtitle.textContent = 'View Our Improvement Plans';
          button.style.background = 'rgba(255, 255, 255, 0.8)';
          button.style.borderColor = 'rgba(0, 0, 0, 0.1)';
          icon.style.color = 'var(--present-text-primary)';
        }
        
        // Re-initialize lucide icons
        if (typeof lucide !== 'undefined') {
          lucide.createIcons();
        }
      }

      // Presentation-Specific Metrics Configuration
      const presentationMetrics = {
        quantitative: {
          'Speech Rate (WPM)': { weight: 0.20, optimal: { min: 110, max: 150 }, unit: ' WPM' },
          'Pitch Range (Std Dev F₀)': { weight: 0.15, optimal: { min: 20, max: 80 }, unit: ' Hz' },
          'Structural Clarity Score': { weight: 0.20, optimal: { min: 7, max: 10 }, unit: '/10' },
          'Filler Density (%)': { weight: 0.15, optimal: { min: 0, max: 5 }, unit: '%' },
          'Ending Strength Indicator': { weight: 0.30, optimal: { min: 7, max: 10 }, unit: '/10' }
        },
        qualitative: {
          'Vocal Expressiveness & Energy': { weight: 0.20, factors: ['dynamic range', 'enthusiasm', 'vocal variety', 'energy level'] },
          'Message Structure & Flow': { weight: 0.25, factors: ['clear introduction', 'logical progression', 'smooth transitions', 'memorable conclusion'] },
          'Audience Awareness': { weight: 0.20, factors: ['engagement techniques', 'pacing awareness', 'audience connection', 'responsive delivery'] },
          'Confidence & Authority': { weight: 0.20, factors: ['commanding presence', 'conviction', 'expertise display', 'professional demeanor'] },
          'Authenticity & Presence': { weight: 0.15, factors: ['genuine delivery', 'personal connection', 'authentic style', 'stage presence'] }
        }
      };

      // Unified tab switching functionality
      function initializeUnifiedTabSwitching() {
        const tabButtons = document.querySelectorAll('.unified-tab-btn');
        const tabPanes = document.querySelectorAll('.unified-tab-pane');
        
        tabButtons.forEach(button => {
          button.addEventListener('click', () => {
            const targetTab = button.dataset.tab;
            
            // Update active tab button
            tabButtons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            
            // Update active tab pane
            tabPanes.forEach(pane => pane.classList.remove('active'));
            document.getElementById(targetTab + '-pane').classList.add('active');
          });
        });
      }

      // Transcribe audio using Gemini AI
      async function transcribeAudioWithGemini(audioFile) {
        try {
          console.log("🎤 Transcribing presentation audio with Gemini...");
          
          // Get API key from config
          const apiKey = window.API_CONFIG?.gemini || window.GEMINI_API_KEY;
          if (!apiKey || apiKey === 'YOUR_GEMINI_API_KEY_HERE') {
            throw new Error("Gemini API key not configured");
          }
          
          const arrayBuffer = await audioFile.arrayBuffer();
          
          // Convert array buffer to base64 more efficiently to avoid stack overflow
          const uint8Array = new Uint8Array(arrayBuffer);
          let binary = '';
          const chunkSize = 0x8000; // Process in 32KB chunks
          
          for (let i = 0; i < uint8Array.length; i += chunkSize) {
            const chunk = uint8Array.subarray(i, i + chunkSize);
            binary += String.fromCharCode.apply(null, chunk);
          }
          
          const base64Audio = btoa(binary);
          
          const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent?key=${apiKey}`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              contents: [{
                parts: [
                  {
                    text: "Please transcribe this presentation audio file accurately. Return only the transcribed text without any additional commentary."
                  },
                  {
                    inline_data: {
                      mime_type: audioFile.type,
                      data: base64Audio
                    }
                  }
                ]
              }],
              generationConfig: {
                temperature: 0.1,
                maxOutputTokens: 8000,
                topP: 0.8,
                topK: 40
              }
            })
          });

          // Check for HTTP errors
          if (!response.ok) {
            const errorText = await response.text();
            console.error(`❌ Gemini API error: ${response.status} - ${response.statusText}`, errorText);
            
            // Handle specific error cases with better messaging
            if (response.status === 503) {
              console.log("🔄 Gemini service temporarily unavailable, using fallback demo transcript");
              return getDemoTranscript();
            } else if (response.status === 429) {
              throw new Error("Rate limit exceeded. Please try again in a few minutes.");
            } else if (response.status === 401 || response.status === 403) {
              throw new Error("API authentication error. Please check your Gemini API configuration.");
            } else if (response.status === 400) {
              throw new Error("Invalid request format. Please check your audio file.");
            } else {
              console.log(`🔄 Gemini API error (${response.status}), using fallback demo transcript`);
              return getDemoTranscript();
            }
          }

          const data = await response.json();
          
          if (data.candidates && data.candidates[0] && data.candidates[0].content) {
            const transcript = data.candidates[0].content.parts[0].text;
            console.log("✅ Presentation transcription successful");
            return transcript;
          } else {
            console.error("❌ Invalid Gemini API response structure:", data);
            throw new Error("No transcription received from Gemini");
          }
        } catch (error) {
          console.error("❌ Transcription error:", error);
          
          // Provide fallback demo transcript for development/testing
          if (error.message.includes("503") || error.message.includes("service unavailable")) {
            console.log("🔄 Providing fallback demo transcript due to service unavailability");
            return getDemoTranscript();
          }
          
          throw new Error(`Transcription failed: ${error.message}`);
        }
      }

      // Fallback demo transcript for when Gemini is unavailable
      function getDemoTranscript() {
        return `Good afternoon, everyone. Thank you for being here today. I'm thrilled to share with you our vision for the future of sustainable technology and how we're revolutionizing the way businesses approach environmental responsibility.

Let me start with a powerful statistic: By 2030, the global sustainability market is projected to reach $150 billion. This isn't just about doing good – it's about building the future of business.

Our company, EcoTech Solutions, stands at the forefront of this transformation. We've developed a proprietary AI-driven platform that helps enterprises reduce their carbon footprint by up to 40% while simultaneously cutting operational costs by 25%.

Now, you might wonder, how do we achieve this? Let me walk you through our three-pillar approach.

First, real-time monitoring. Our sensors and analytics provide unprecedented visibility into energy consumption patterns, identifying waste that traditional systems miss.

Second, predictive optimization. Our AI doesn't just report – it predicts and prevents inefficiencies before they occur, learning from millions of data points across our network.

Third, seamless integration. We've designed our solution to work with existing infrastructure, eliminating the need for costly overhauls.

Let me share a success story. Global Manufacturing Corp implemented our solution last year. Within six months, they reduced energy costs by $2.3 million and prevented 15,000 tons of CO2 emissions. Their CEO called it "the smartest investment we've made this decade."

Looking ahead, we're not just solving today's problems – we're building tomorrow's solutions. Our R&D team is developing next-generation features including blockchain-verified carbon credits and quantum-computing optimization algorithms.

The opportunity before us is immense. With your partnership, we can accelerate our mission to make every business on the planet sustainable and profitable.

In closing, I want to leave you with this thought: The question isn't whether businesses will adopt sustainable technology – it's whether they'll lead or be left behind. Together, we can ensure you're among the leaders.

Thank you for your time today. I'm excited to answer any questions you may have about how EcoTech Solutions can transform your sustainability journey.`;
      }

      // Analyze presentation using specific metrics
      async function analyzePresentation(transcript) {
        try {
          console.log("🧠 Analyzing presentation...");
          
          const quantitativeScores = await calculateQuantitativeMetrics(transcript, presentationMetrics.quantitative);
          const qualitativeScores = await calculateQualitativeMetrics(transcript, presentationMetrics.qualitative);
          const overallScore = calculateOverallScore(quantitativeScores, qualitativeScores);
          const insights = await generatePresentationInsights(transcript, quantitativeScores, qualitativeScores);
          const communicationInsights = await generateCommunicationInsights(transcript);
          return {
            transcript: transcript,
            analysisType: "presentation",
            quantitativeScores: quantitativeScores,
            qualitativeScores: qualitativeScores,
            overallScore: overallScore,
            insights: insights,
            communicationInsights: communicationInsights
          };
        } catch (error) {
          console.error("❌ Presentation analysis error:", error);
          throw new Error(`Analysis failed: ${error.message}`);
        }
      }

      // Calculate quantitative metrics for presentation
      async function calculateQuantitativeMetrics(transcript, quantitativeConfig) {
        if (!transcript || typeof transcript !== 'string') {
          console.error('Invalid transcript provided to calculateQuantitativeMetrics');
          return {};
        }
        
        const words = transcript.split(/\s+/).filter(word => word.length > 0);
        const sentences = transcript.split(/[.!?]+/).filter(s => s.trim().length > 0);
        
        const metrics = {};
        
        // Speech Rate (WPM) - Presentation pace
        const estimatedDurationMinutes = words.length / 130; // Slower for presentations
        metrics['Speech Rate (WPM)'] = Math.round(words.length / estimatedDurationMinutes);
        
        // Pitch Range - Simulated (would need audio analysis in real implementation)
        metrics['Pitch Range (Std Dev F₀)'] = Math.floor(Math.random() * 40) + 30; // 30-70 Hz range
        
        // Structural Clarity Score - Based on clear sections and transitions
        const structureKeywords = ['first', 'second', 'third', 'let me', 'now', 'in conclusion', 'to summarize', 'let\'s begin', 'moving on'];
        const structureCount = structureKeywords.filter(keyword => 
          transcript.toLowerCase().includes(keyword)
        ).length;
        metrics['Structural Clarity Score'] = Math.min(10, Math.round(5 + structureCount * 0.5));
        
        // Filler Density (%)
        const fillerWords = ['um', 'uh', 'like', 'you know', 'so', 'well', 'actually', 'basically'];
        const fillerCount = words.filter(word => 
          fillerWords.includes(word.toLowerCase())
        ).length;
        metrics['Filler Density (%)'] = Math.round((fillerCount / words.length) * 100 * 10) / 10;
        
        // Ending Strength Indicator - Check last 15% for strong conclusion
        const lastPortionStart = Math.floor(words.length * 0.85);
        const lastPortion = words.slice(lastPortionStart).join(' ').toLowerCase();
        const strongEndingKeywords = ['conclusion', 'closing', 'thank you', 'questions', 'summary', 'remember', 'leave you with', 'final thought'];
        const endingStrength = strongEndingKeywords.filter(keyword => 
          lastPortion.includes(keyword)
        ).length;
        metrics['Ending Strength Indicator'] = Math.min(10, 5 + endingStrength * 2);
        
        return metrics;
      }

      // Calculate qualitative metrics using AI analysis
      async function calculateQualitativeMetrics(transcript, qualitativeConfig) {
        if (!transcript || typeof transcript !== 'string') {
          console.error('Invalid transcript provided to calculateQualitativeMetrics');
          return {};
        }
        
        if (!qualitativeConfig || typeof qualitativeConfig !== 'object') {
          console.error('Invalid qualitativeConfig provided');
          return {};
        }
        
        try {
          const prompt = `You are an expert presentation skills coach analyzing a presentation transcript. Focus on public speaking mastery, audience engagement, and professional delivery.

Analyze this presentation transcript for these specific presentation skills. Rate each factor from 1-10:

Vocal Expressiveness & Energy: Evaluate vocal dynamics, enthusiasm projection, tonal variation, energy consistency, and speaking pace that commands audience attention
Message Structure & Flow: Evaluate presentation architecture, compelling openings, logical progression, smooth transitions, impactful conclusions, and overall narrative coherence
Audience Awareness: Evaluate audience engagement techniques, room reading ability, interactive elements, Q&A handling, and adaptive delivery based on audience response
Confidence & Authority: Evaluate stage presence, subject matter expertise demonstration, professional credibility, commanding delivery, and authoritative positioning
Authenticity & Presence: Evaluate genuine connection, personal storytelling, authentic delivery style, charismatic presence, and memorable personality projection

Transcript: "${transcript}"

Consider this transcript as a professional presentation context. Evaluate against standards for effective public speaking, audience engagement, and presentation delivery excellence.

Provide scores in this exact format:
Vocal Expressiveness & Energy: [score 1-10]
Message Structure & Flow: [score 1-10]
Audience Awareness: [score 1-10]
Confidence & Authority: [score 1-10]
Authenticity & Presence: [score 1-10]`;

          const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent?key=${window.GEMINI_API_KEY}`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              contents: [{
                parts: [{
                  text: prompt
                }]
              }]
            })
          });

          const data = await response.json();
          
          if (!data.candidates || !data.candidates[0] || !data.candidates[0].content || !data.candidates[0].content.parts || !data.candidates[0].content.parts[0]) {
            console.error('Invalid response structure from Gemini API:', data);
            throw new Error('Invalid API response structure');
          }
          
          const analysisText = data.candidates[0].content.parts[0].text;
          
          const scores = {};
          Object.keys(qualitativeConfig).forEach(metric => {
            const match = analysisText.match(new RegExp(`${metric}:\\s*(\\d+)`, 'i'));
            scores[metric] = match ? parseInt(match[1]) : 6; // Default to 6/10
          });
          
          return scores;
        } catch (error) {
          console.error("Error calculating qualitative metrics:", error);
          
          // Provide presentation default scores
          const defaultScores = {
            'Vocal Expressiveness & Energy': 7,
            'Message Structure & Flow': 6,
            'Audience Awareness': 6,
            'Confidence & Authority': 7,
            'Authenticity & Presence': 6
          };
          
          console.log("🔄 Using default presentation scores due to API error");
          return defaultScores;
        }
      }

      // Calculate overall score
      function calculateOverallScore(quantitativeScores, qualitativeScores) {
        if (!quantitativeScores || !qualitativeScores) {
          console.error('Invalid scores provided to calculateOverallScore');
          return 5; // Default middle score
        }
        
        const qualitativeWeight = 0.6; // More weight on qualitative for presentations
        const quantitativeWeight = 0.4;
        
        const qualitativeValues = Object.values(qualitativeScores);
        if (qualitativeValues.length === 0) {
          console.error('No qualitative scores available');
          return 5;
        }
        
        const qualitativeAvg = qualitativeValues.reduce((a, b) => a + b, 0) / qualitativeValues.length;
        
        // Calculate quantitative average from actual metrics
        const quantitativeMetrics = Object.entries(quantitativeScores).map(([metric, value]) => {
          const config = presentationMetrics.quantitative && presentationMetrics.quantitative[metric];
          if (!config) return 5; // Default middle score
          
          const { optimal } = config;
          // Score based on how close to optimal range
          if (value >= optimal.min && value <= optimal.max) {
            return 8; // Great score
          } else if (value < optimal.min) {
            return Math.max(3, 8 - ((optimal.min - value) / optimal.min) * 5);
          } else {
            return Math.max(3, 8 - ((value - optimal.max) / optimal.max) * 5);
          }
        });
        
        const quantitativeAvg = quantitativeMetrics.length > 0 ? quantitativeMetrics.reduce((a, b) => a + b, 0) / quantitativeMetrics.length : 5;
        
        const overallScore = (qualitativeAvg * qualitativeWeight + quantitativeAvg * quantitativeWeight);
        return Math.round(overallScore * 10) / 10;
      }

      // Generate presentation insights
      async function generatePresentationInsights(transcript, quantitativeScores, qualitativeScores) {
        if (!transcript || typeof transcript !== 'string') {
          console.error('Invalid transcript provided to generatePresentationInsights');
          return 'Unable to generate insights - invalid transcript data';
        }
        
        try {
          const prompt = `You are an expert presentation coach providing detailed feedback on this presentation transcript. Focus on public speaking excellence, audience engagement, and professional delivery mastery.

Analyze this presentation and provide detailed feedback in this exact format:

STRENGTHS:
• [List 3-4 specific presentation strengths in areas like vocal delivery, stage presence, audience connection, message clarity, or structural effectiveness]

AREAS FOR IMPROVEMENT:
• [List 3-4 specific areas to improve for enhanced presentation impact, such as vocal variety, audience interaction, message structure, or delivery confidence]

RECOMMENDATIONS:
• [List 3-4 actionable recommendations for elevated presentation skills, including specific techniques for better audience engagement, improved delivery, or enhanced stage presence]

Transcript: "${transcript}"

Provide insights specifically relevant to presentation skills, public speaking mastery, and professional communication delivery in presentation contexts.

Focus on presentation delivery, audience engagement, message clarity, and overall impact. Consider stage presence, storytelling ability, and persuasive power.`;

          const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent?key=${window.GEMINI_API_KEY}`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              contents: [{
                parts: [{
                  text: prompt
                }]
              }]
            })
          });

          const data = await response.json();
          
          if (!data.candidates || !data.candidates[0] || !data.candidates[0].content || !data.candidates[0].content.parts || !data.candidates[0].content.parts[0]) {
            console.error('Invalid response structure from Gemini API:', data);
            throw new Error('Invalid API response structure');
          }
          
          return data.candidates[0].content.parts[0].text;
        } catch (error) {
          console.error("Error generating insights:", error);
          console.log("🔄 Using default presentation insights due to API error");
          return `STRENGTHS:
• Clear message structure with logical flow
• Good use of statistics and evidence
• Strong opening that captures attention
• Memorable closing with call to action

AREAS FOR IMPROVEMENT:
• Increase vocal variety and energy throughout
• Add more audience engagement techniques
• Enhance storytelling with personal anecdotes
• Strengthen transitions between sections

RECOMMENDATIONS:
• Practice with varying pitch and pace for emphasis
• Include rhetorical questions to engage audience
• Add personal stories to illustrate key points
• Use the rule of three for memorable structure`;
        }
      }

      // Generate communication insights
      async function generateCommunicationInsights(transcript) {
        try {
          const prompt = `You are an expert presentation consultant analyzing communication effectiveness in this presentation transcript. Focus on presentation-specific communication patterns and audience impact.

Analyze the communication patterns in this presentation and provide insights on:
1. Message clarity and audience comprehension
2. Persuasive storytelling and compelling narrative techniques
3. Emotional connection and audience engagement strategies
4. Professional presentation language and terminology appropriateness
5. Overall presentation communication effectiveness and audience impact
6. Visual storytelling and descriptive language use
7. Call-to-action effectiveness and audience motivation

Transcript: "${transcript}"

Provide specific insights relevant to presentation delivery, audience engagement, and public speaking effectiveness. Format as clear, actionable insights for presentation improvement.`;

          const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent?key=${window.GEMINI_API_KEY}`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              contents: [{
                parts: [{
                  text: prompt
                }]
              }]
            })
          });

          const data = await response.json();
          return data.candidates[0].content.parts[0].text;
        } catch (error) {
          console.error("Error generating communication insights:", error);
          return `Your presentation demonstrates solid communication fundamentals with clear message delivery and professional language. To enhance your impact, focus on:

• Building stronger emotional connections through personal stories
• Varying your vocal delivery for emphasis
• Using more vivid language and metaphors
• Creating memorable moments with powerful pauses
• Engaging the audience with interactive elements`;
        }
      }

      // Generate copyable feedback

      // Display results functions
      function displayResults(results) {
        console.log("🎨 Displaying presentation results:", results);
        
        if (results.transcript) {
          document.getElementById('transcriptContent').innerHTML = `
            <div class="transcript-text">
              ${results.transcript}
            </div>
          `;
        }

        displayDetailedInsights(results.insights, results.overallScore, results.communicationInsights);
        displayQuantitativeMetrics(results.quantitativeScores);
        displayQualitativeMetrics(results.qualitativeScores);
      }

      function displayDetailedInsights(insights, overallScore, communicationInsights) {
        const insightsElement = document.getElementById('detailedAnalysisContent');
        if (!insightsElement || !insights) return;

        const sections = ['STRENGTHS:', 'AREAS FOR IMPROVEMENT:', 'RECOMMENDATIONS:'];
        let insightsHtml = '';

        // Overall Performance Assessment
        let performanceHtml = '';
        let performanceColor = '';
        let performanceIcon = '';
        
        if (overallScore >= 8) {
          performanceHtml = `
            <div style="margin-bottom: 1.5rem;">
              <span style="display: inline-block; background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 0.5rem 1rem; border-radius: 8px; font-weight: 600; font-size: 0.875rem;">
                Score: ${Math.round(overallScore * 10)}/100
              </span>
            </div>
            <h4 style="font-size: 1.25rem; font-weight: 700; color: var(--present-text-primary); margin-bottom: 1rem;">
              Outstanding Presentation Skills
            </h4>
            <p style="color: var(--present-text-secondary); line-height: 1.7; margin-bottom: 1.5rem;">
              You demonstrate exceptional presentation abilities with compelling delivery, clear structure, and strong audience engagement. Your natural stage presence commands attention.
            </p>
            <div style="background: rgba(16, 185, 129, 0.1); padding: 1rem; border-radius: 12px; border: 1px solid rgba(16, 185, 129, 0.2);">
              <p style="font-weight: 600; color: var(--present-text-primary); margin-bottom: 0.5rem;">Key Strengths Observed:</p>
              <p style="color: var(--present-text-secondary); margin: 0;">
                Commanding presence • Dynamic delivery • Clear structure • Strong audience connection
              </p>
            </div>
          `;
          performanceColor = 'excellent';
          performanceIcon = 'check-circle';
        } else if (overallScore >= 6.5) {
          performanceHtml = `
            <div style="margin-bottom: 1.5rem;">
              <span style="display: inline-block; background: linear-gradient(135deg, #f59e0b, #d97706); color: white; padding: 0.5rem 1rem; border-radius: 8px; font-weight: 600; font-size: 0.875rem;">
                Score: ${Math.round(overallScore * 10)}/100
              </span>
            </div>
            <h4 style="font-size: 1.25rem; font-weight: 700; color: var(--present-text-primary); margin-bottom: 1rem;">
              Strong Presenter with Growth Potential
            </h4>
            <p style="color: var(--present-text-secondary); line-height: 1.7; margin-bottom: 1.5rem;">
              You show solid presentation fundamentals with clear opportunities for enhancement. With focused practice on delivery dynamics, you can become a truly impactful presenter.
            </p>
            <div style="background: rgba(245, 158, 11, 0.1); padding: 1rem; border-radius: 12px; border: 1px solid rgba(245, 158, 11, 0.2);">
              <p style="font-weight: 600; color: var(--present-text-primary); margin-bottom: 0.5rem;">Focus Areas:</p>
              <p style="color: var(--present-text-secondary); margin: 0;">
                Vocal variety • Energy level • Audience engagement • Storytelling techniques
              </p>
            </div>
          `;
          performanceColor = 'good';
          performanceIcon = 'trending-up';
        } else {
          performanceHtml = `
            <div style="margin-bottom: 1.5rem;">
              <span style="display: inline-block; background: linear-gradient(135deg, #ef4444, #dc2626); color: white; padding: 0.5rem 1rem; border-radius: 8px; font-weight: 600; font-size: 0.875rem;">
                Score: ${Math.round(overallScore * 10)}/100
              </span>
            </div>
            <h4 style="font-size: 1.25rem; font-weight: 700; color: var(--present-text-primary); margin-bottom: 1rem;">
              Building Your Presentation Foundation
            </h4>
            <p style="color: var(--present-text-secondary); line-height: 1.7; margin-bottom: 1.5rem;">
              Every great presenter started where you are now. With practice and the right techniques, you can develop the skills to deliver powerful, engaging presentations.
            </p>
            <div style="background: rgba(239, 68, 68, 0.1); padding: 1rem; border-radius: 12px; border: 1px solid rgba(239, 68, 68, 0.2);">
              <p style="font-weight: 600; color: var(--present-text-primary); margin-bottom: 0.5rem;">Building Blocks:</p>
              <p style="color: var(--present-text-secondary); margin: 0;">
                Structure basics • Confidence building • Vocal techniques • Audience awareness
              </p>
            </div>
          `;
          performanceColor = 'needs-improvement';
          performanceIcon = 'alert-circle';
        }

        insightsHtml += `
          <div class="insight-card-modern performance">
            <div class="insight-header-modern">
              <div class="insight-icon-modern ${performanceColor}">
                <i data-lucide="${performanceIcon}"></i>
              </div>
              <h4 class="insight-title-modern">Overall Assessment</h4>
            </div>
            <div class="insight-content-modern">
              ${performanceHtml}
            </div>
          </div>
        `;

        sections.forEach(section => {
          const match = insights.match(new RegExp(`${section}([\\s\\S]*?)(?=${sections.find(s => s !== section) || '$'})`, 'i'));
          if (match) {
            const content = match[1].trim();
            const title = section.replace(':', '');
            let color = 'var(--present-primary)';
            let icon = 'lightbulb';
            
            if (section.includes('STRENGTHS')) {
              color = 'var(--present-success)';
              icon = 'check-circle';
            } else if (section.includes('IMPROVEMENT')) {
              color = 'var(--present-warm)';
              icon = 'alert-triangle';
            } else if (section.includes('RECOMMENDATIONS')) {
              color = 'var(--present-primary)';
              icon = 'compass';
            }
            
            insightsHtml += `
              <div class="insight-card-modern">
                <div class="insight-header-modern">
                  <div class="insight-icon-modern" style="background: ${color};">
                    <i data-lucide="${icon}"></i>
                  </div>
                  <h4 class="insight-title-modern">${title}</h4>
                </div>
                <div class="insight-content-modern">
                  ${content.replace(/•/g, '&bull;').replace(/^\*\s+(.+)/gm, '• $1').replace(/\n/g, '<br>').replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')}
                </div>
              </div>
            `;
          }
        });

        // Add Communication Insights section
        if (communicationInsights) {
          // Process the insights to create better formatting
          const processedInsights = communicationInsights
            .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>') // Convert markdown bold to HTML
            .replace(/^\*\s+(.+)/gm, '<div class="insight-bullet">• $1</div>') // Convert asterisk bullet points
            .replace(/(\d+\.\s*[^\n]+)/g, '<h5 class="insight-section-header">$1</h5>') // Style numbered headings
            .replace(/^•\s+(.+)/gm, '<div class="insight-bullet">• $1</div>') // Style bullet points
            .replace(/\n\n/g, '<br><br>') // Convert double line breaks
            .replace(/\n/g, '<br>'); // Convert single line breaks

          insightsHtml += `
            <div class="insight-card-modern">
              <div class="insight-header-modern">
                <div class="insight-icon-modern" style="background: var(--present-accent);">
                  <i data-lucide="message-circle"></i>
                </div>
                <h4 class="insight-title-modern">Communication Insights</h4>
              </div>
              <div class="insight-content-modern" style="line-height: 1.7;">
                ${processedInsights}
              </div>
            </div>
          `;
        }

        insightsElement.innerHTML = insightsHtml;

        // Update score display
        document.getElementById('scoreCircle').textContent = Math.round(overallScore * 10);
        document.getElementById('scoreText').textContent = `${Math.round(overallScore * 10)}/100`;
        
        if (overallScore >= 8) {
          document.getElementById('scoreDescription').textContent = "Exceptional presentation skills with compelling delivery";
        } else if (overallScore >= 6.5) {
          document.getElementById('scoreDescription').textContent = "Solid presentation foundation with clear growth opportunities";
        } else {
          document.getElementById('scoreDescription').textContent = "Building blocks in place for presentation excellence";
        }
      }

      function displayQuantitativeMetrics(scores) {
        const quantitativeElement = document.getElementById('quantitativeContent');
        if (!quantitativeElement || !scores) return;

        let html = '<div class="metrics-grid">';
        
        Object.entries(scores).forEach(([metric, value]) => {
          const config = presentationMetrics.quantitative[metric] || { optimal: { min: 0, max: 100 } };
          const optimal = config.optimal;
          
          let score;
          if (value >= optimal.min && value <= optimal.max) {
            score = 100;
          } else if (value < optimal.min) {
            score = Math.max(0, 100 - (optimal.min - value) * 10);
          } else {
            score = Math.max(0, 100 - (value - optimal.max) * 10);
          }
          
          score = Math.min(100, Math.max(0, score));
          const scoreColor = score >= 80 ? '#10b981' : score >= 60 ? '#f59e0b' : score >= 40 ? '#ef4444' : '#dc2626';
          
          // Generate performance description
          let description = '';
          if (score >= 90) {
            description = getExcellentDescription(metric, value, optimal);
          } else if (score >= 70) {
            description = getGoodDescription(metric, value, optimal);
          } else {
            description = getNeedsImprovementDescription(metric, value, optimal);
          }
          
          html += `
            <div class="metric-card">
              <div class="metric-header">
                <span class="metric-name">${metric}</span>
                <span class="metric-score" style="color: ${scoreColor};">${Math.round(score)}/100</span>
              </div>
              <div class="metric-details">
                <div style="font-weight: 500;">Measured: ${value}${config.unit || ''}</div>
                <div style="color: var(--present-text-muted);">Ideal: ${optimal.min}-${optimal.max}${config.unit || ''}</div>
                <div class="metric-description">${description}</div>
              </div>
              <div class="metric-bar">
                <div class="metric-fill" style="width: ${score}%; background-color: ${scoreColor};"></div>
              </div>
            </div>
          `;
        });
        
        html += '</div>';
        quantitativeElement.innerHTML = html;
      }

      function getExcellentDescription(metric, value, optimal) {
        const descriptions = {
          'Speech Rate (WPM)': `Excellent pacing at ${value} WPM. Your speech rate is perfectly balanced for audience comprehension and engagement.`,
          'Pitch Range (Std Dev F₀)': `Great vocal variety with ${value} Hz range. Your pitch variation keeps listeners engaged and conveys confidence.`,
          'Structural Clarity Score': `Strong organization with ${value}/10 structure. Your presentation flows logically with clear transitions.`,
          'Filler Density (%)': `Exceptional fluency with only ${value}% filler words. Your speech is polished and professional.`,
          'Ending Strength Indicator': `Powerful conclusion with ${value}/10 strength. Your ending leaves a lasting impression on the audience.`
        };
        return descriptions[metric] || `Excellent performance at ${value}. Well within the optimal range.`;
      }

      function getGoodDescription(metric, value, optimal) {
        const descriptions = {
          'Speech Rate (WPM)': `Good pacing at ${value} WPM. ${value < optimal.min ? 'Consider speaking slightly faster to maintain energy.' : value > optimal.max ? 'Consider slowing down slightly for better comprehension.' : 'Maintain this comfortable pace.'}`,
          'Pitch Range (Std Dev F₀)': `Adequate vocal variety with ${value} Hz range. ${value < optimal.min ? 'Try incorporating more vocal inflection to enhance engagement.' : 'Good range that supports your message.'}`,
          'Structural Clarity Score': `Clear organization with ${value}/10 structure. ${value < optimal.min ? 'Add more transitional phrases and signposting to improve flow.' : 'Good logical progression.'}`,
          'Filler Density (%)': `Acceptable fluency with ${value}% filler words. Practice reducing "um," "uh," and other fillers for more polished delivery.`,
          'Ending Strength Indicator': `Solid conclusion with ${value}/10 strength. ${value < optimal.min ? 'Strengthen your closing with clearer call-to-action or memorable final thought.' : 'Good ending that reinforces your message.'}`
        };
        return descriptions[metric] || `Good performance at ${value}. Room for improvement to reach optimal range.`;
      }

      function getNeedsImprovementDescription(metric, value, optimal) {
        const descriptions = {
          'Speech Rate (WPM)': `${value < optimal.min ? 'Too slow' : 'Too fast'} at ${value} WPM. ${value < optimal.min ? 'Increase pace to maintain audience engagement and energy.' : 'Slow down to ensure audience comprehension and retention.'}`,
          'Pitch Range (Std Dev F₀)': `Limited vocal variety with ${value} Hz range. Practice varying your pitch to convey emotion and maintain audience interest.`,
          'Structural Clarity Score': `Needs clearer organization with ${value}/10 structure. Use more signposting, transitions, and logical flow to guide your audience.`,
          'Filler Density (%)': `High filler usage at ${value}%. Practice reducing filler words through preparation and conscious speaking habits.`,
          'Ending Strength Indicator': `Weak conclusion with ${value}/10 strength. Develop a stronger closing with clear takeaways and compelling call-to-action.`
        };
        return descriptions[metric] || `Needs improvement at ${value}. Focus on reaching the optimal range of ${optimal.min}-${optimal.max}.`;
      }

      function displayQualitativeMetrics(scores) {
        const qualitativeElement = document.getElementById('qualitativeContent');
        if (!qualitativeElement || !scores) return;

        let html = '<div class="categories-grid">';
        
        Object.entries(scores).forEach(([metric, score]) => {
          const config = presentationMetrics.qualitative[metric] || { factors: [] };
          const normalizedScore = (score / 10) * 100;
          const scoreColor = normalizedScore >= 80 ? '#10b981' : normalizedScore >= 60 ? '#f59e0b' : normalizedScore >= 40 ? '#ef4444' : '#dc2626';
          
          html += `
            <div class="category-card">
              <div class="category-header">
                <span class="category-name">${metric}</span>
                <span class="category-score" style="color: ${scoreColor};">${score}/10</span>
              </div>
              <div class="category-factors">
                ${config.factors.map(factor => `<span class="factor-tag">${factor}</span>`).join('')}
              </div>
              <div class="category-bar">
                <div class="category-fill" style="width: ${normalizedScore}%; background-color: ${scoreColor};"></div>
              </div>
            </div>
          `;
        });
        
        html += '</div>';
        qualitativeElement.innerHTML = html;
      }


      // Copy functions
      function copyAnalysis() {
        const analysisContent = document.getElementById('detailedAnalysisContent');
        if (analysisContent) {
          const textContent = analysisContent.innerText;
          navigator.clipboard.writeText(textContent);
          
          // Show feedback
          const btn = event.target.closest('.copy-btn');
          const originalText = btn.innerHTML;
          btn.innerHTML = '<i data-lucide="check"></i> Copied!';
          btn.style.background = 'var(--present-success)';
          btn.style.color = 'white';
          
          setTimeout(() => {
            btn.innerHTML = originalText;
            btn.style.background = 'rgba(255, 255, 255, 0.6)';
            btn.style.color = 'var(--present-text-secondary)';
            lucide.createIcons();
          }, 2000);
        }
      }

      function copyQuantitative() {
        const quantContent = document.getElementById('quantitativeContent');
        if (quantContent) {
          const textContent = quantContent.innerText;
          navigator.clipboard.writeText(textContent);
          
          // Show feedback
          const btn = event.target.closest('.copy-btn');
          const originalText = btn.innerHTML;
          btn.innerHTML = '<i data-lucide="check"></i> Copied!';
          btn.style.background = 'var(--present-success)';
          btn.style.color = 'white';
          
          setTimeout(() => {
            btn.innerHTML = originalText;
            btn.style.background = 'rgba(255, 255, 255, 0.6)';
            btn.style.color = 'var(--present-text-secondary)';
            lucide.createIcons();
          }, 2000);
        }
      }

      function copyQualitative() {
        const qualContent = document.getElementById('qualitativeContent');
        if (qualContent) {
          const textContent = qualContent.innerText;
          navigator.clipboard.writeText(textContent);
          
          // Show feedback
          const btn = event.target.closest('.copy-btn');
          const originalText = btn.innerHTML;
          btn.innerHTML = '<i data-lucide="check"></i> Copied!';
          btn.style.background = 'var(--present-success)';
          btn.style.color = 'white';
          
          setTimeout(() => {
            btn.innerHTML = originalText;
            btn.style.background = 'rgba(255, 255, 255, 0.6)';
            btn.style.color = 'var(--present-text-secondary)';
            lucide.createIcons();
          }, 2000);
        }
      }


      // Process audio for transcription
      async function processAudioForTranscription(audioDataString) {
        try {
          console.log("🎤 Processing presentation audio for transcription");

          const audioData = JSON.parse(audioDataString);
          console.log("📊 Audio data:", audioData);

          const response = await fetch(audioData.base64);
          const blob = await response.blob();
          const audioFile = new File([blob], audioData.name, { type: audioData.type });

          const transcript = await transcribeAudioWithGemini(audioFile);
          const analysisResults = await analyzePresentation(transcript);

          console.log("✅ Presentation analysis complete:", analysisResults);
          displayResults(analysisResults);

        } catch (error) {
          console.error("❌ Audio processing failed:", error);
          document.getElementById("transcriptContent").innerHTML = `
            <div style="text-align: center; padding: 2rem; background: #fef2f2; border: 2px solid #fca5a5; border-radius: 12px; color: #dc2626;">
              <h3>⚠️ Analysis Failed</h3>
              <p>Unable to process your presentation. Please try again.</p>
              <p style="font-size: 14px; opacity: 0.8;">Error: ${error.message}</p>
            </div>
          `;
        }
      }

      // Initialize page
      document.addEventListener("DOMContentLoaded", function () {
        lucide.createIcons();
        initializeUnifiedTabSwitching();

        const audioData = sessionStorage.getItem("audioForAnalysis");
        if (audioData) {
          console.log("🎤 Found audio data for presentation analysis");
          processAudioForTranscription(audioData);
          sessionStorage.removeItem("audioForAnalysis");
        } else {
          console.log("❌ No audio data found");
          document.getElementById("transcriptContent").innerHTML = `
            <div style="text-align: center; padding: 2rem;">
              <h3>No Audio Data</h3>
              <p>Please record a presentation first.</p>
              <a href="dashboard.html" class="back-btn" style="margin-top: 1rem;">
                Go to Dashboard
              </a>
            </div>
          `;
        }
      });
    </script>
  </body>
</html>